<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Wolfeyes Bioinformatics beta]]></title>
  <link href="http://yagays.github.com/atom.xml" rel="self"/>
  <link href="http://yagays.github.com/"/>
  <updated>2012-12-11T20:06:21+09:00</updated>
  <id>http://yagays.github.com/</id>
  <author>
    <name><![CDATA[yag_ays]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[「Rによるモンテカルロ法入門」読書ノート：6章 メトロポリス・ヘイスティング・アルゴリズムを用いたモデル選択]]></title>
    <link href="http://yagays.github.com/blog/2012/12/11/imcmr-6-6/"/>
    <updated>2012-12-11T15:34:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/11/imcmr-6-6</id>
    <content type="html"><![CDATA[<ul>
<li>読書ノート アーカイブ：<a href="http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/">http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/</a></li>
</ul>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4621065270" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<h3>例 6.8 モデル選択</h3>

<h4>この問題の目的とデータセットの説明</h4>

<p>線形回帰のモデル選択について考える．data(swiss)はスイスの47地域における出生率と社会経済指標のデータである．社会経済指標には，農業従事率や教育の度合い，特定の宗教の割合，幼児の死亡率など，合計で5つの標準化された観測値が含まれている．今回は，線形回帰によって出生率と社会経済指標の関係を調べることを目標としている．つまり，社会経済指標の中で何が出生率に効いているかを知りたいということだ．そのような線形回帰において一番重要なのが，5つある説明変数をどうやって組み合わせてモデルを作るかという問題である．5つの説明変数から作ることの出来るモデルは2<sup>5</sup> 個なので，今回の場合のモデルの総数はたかだか32個程度だが，たとえば説明変数が20個になると，モデルの総数は2<sup>20</sup> = 1048576個となり，全部のモデルをそれぞれ計算するのは現実的ではなくなってしまう．そこで，モデルの全パターンを試すことなく，もっとも出生率に効いてる社会経済指標だけを選んでモデルを作りたい．そのために，今回は周辺分布の最大化によるモデル選択をランダム・ウォーク・メトロポリス・ヘイスティング・アルゴリズムを使って算出してみる．</p>

<h4>数式の説明</h4>

<p>通常の線形回帰を考えるということで，出生率yと社会経済指標xは以下の式で表される．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbold%7By%7D+%3D+%5Cbeta+X+%2B+%5Cvarepsilon+" alt="\bold{y} = \beta X + \varepsilon " />，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cvarepsilon+%5Csim+%5Cmathcal%7BN%7D_n%280%2C%5Csigma%5E2+I_n%29+" alt="\varepsilon \sim \mathcal{N}_n(0,\sigma^2 I_n) " /></p>

<p>このときの<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbold%7By%7D%7C%5Cbeta%2C%5Csigma%5E2%2CX+" alt="\bold{y}|\beta,\sigma^2,X " />は
<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbold%7By%7D%7C%5Cbeta%2C%5Csigma%5E2%2CX+%5Csim+%5Cmathcal%7BN%7D_n%28X%5Cbeta%2C%5Csigma%5E2I_n%29+" alt="\bold{y}|\beta,\sigma^2,X \sim \mathcal{N}_n(X\beta,\sigma^2I_n) " />となる．</p>

<p>ここで，出生率yは47の地域でそれぞれ観測されているため，観測数n=47のベクトルy={y_1..yn}として表される．</p>

<p>そして，このときの尤度関数は</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l%28%5Cbeta%2C%5Csigma%5E2%7C%5Cbold%7By%7D%2CX%29%3D%5Cbig%28%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D%7D%5Cbig%29%5En+%5Cexp%5Cbig%5B-%5Cfrac%7B1%7D%7B2%5Csigma%5E2%7D%28%5Cbold%7By%7D-X%5Cbeta%29%5E%7B%5Cmathrm%7BT%7D%7D%28%5Cbold%7By%7D-X%5Cbeta%29%5Cbig%5D+" alt="l(\beta,\sigma^2|\bold{y},X)=\big(\frac{1}{\sqrt{2\pi\sigma^2}}\big)^n \exp\big[-\frac{1}{2\sigma^2}(\bold{y}-X\beta)^{\mathrm{T}}(\bold{y}-X\beta)\big] " /></p>

<p>である．</p>

<p>このあたりの式変形は練習問題6.5を参照．</p>

<h3>データセットの準備</h3>

<p>swissデータセットを読み込んだあと，応答変数yとして出生率の対数，説明変数Xとして5つの社会経済指標を代入している．説明変数には</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>data<span class="p">(</span>swiss<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>y <span class="o">&lt;-</span> log<span class="p">(</span>as.vector<span class="p">(</span>swiss<span class="p">[,</span><span class="m">1</span><span class="p">]))</span>
</span><span class='line'>X <span class="o">&lt;-</span> as.matrix<span class="p">(</span>swiss<span class="p">[,</span><span class="m">2</span>:<span class="m">6</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>説明変数である社会経済指標の詳細は以下の通りである．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="o">&gt;</span> names<span class="p">(</span>swiss<span class="p">)</span>
</span><span class='line'><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;Fertility&quot;</span>        <span class="s">&quot;Agriculture&quot;</span>      <span class="s">&quot;Examination&quot;</span>      <span class="s">&quot;Education&quot;</span>        <span class="s">&quot;Catholic&quot;</span>         <span class="s">&quot;Infant.Mortality&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>関数の定義</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>inv <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>X<span class="p">){</span>
</span><span class='line'>  EV <span class="o">&lt;-</span> eigen<span class="p">(</span>X<span class="p">)</span>
</span><span class='line'>  EV<span class="p">$</span>vector <span class="o">%*%</span> diag<span class="p">(</span><span class="m">1</span><span class="o">/</span>EV<span class="p">$</span>values<span class="p">)</span> <span class="o">%*%</span> t<span class="p">(</span>EV<span class="p">$</span>vector<span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>lpostw <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>gam<span class="p">,</span> y<span class="p">,</span> X<span class="p">,</span> beta<span class="p">){</span>
</span><span class='line'>  n <span class="o">&lt;-</span> length<span class="p">(</span>y<span class="p">)</span>
</span><span class='line'>  qgam <span class="o">&lt;-</span> sum<span class="p">(</span>gam<span class="p">)</span>
</span><span class='line'>  Xt1 <span class="o">&lt;-</span> cbind<span class="p">(</span>rep<span class="p">(</span><span class="m">1</span><span class="p">,</span>n<span class="p">),</span> X<span class="p">[,</span>which<span class="p">(</span>gam<span class="o">==</span><span class="m">1</span><span class="p">)])</span>
</span><span class='line'>  <span class="kr">if</span><span class="p">(</span>qgam <span class="o">!=</span> <span class="m">0</span><span class="p">){</span>
</span><span class='line'>    P1 <span class="o">&lt;-</span> Xt1 <span class="o">%*%</span> inv<span class="p">(</span>t<span class="p">(</span>Xt1<span class="p">)</span> <span class="o">%*%</span> Xt1<span class="p">)</span> <span class="o">%*%</span> t<span class="p">(</span>Xt1<span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>else<span class="p">{</span>
</span><span class='line'>    P1 <span class="o">&lt;-</span> matrix<span class="p">(</span><span class="m">0</span><span class="p">,</span> n<span class="p">,</span> n<span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="o">-</span><span class="p">(</span>qgam<span class="o">+</span><span class="m">1</span><span class="p">)</span><span class="o">/</span><span class="m">2</span> <span class="o">*</span> log<span class="p">(</span>n<span class="o">+</span><span class="m">1</span><span class="p">)</span> <span class="o">-</span> n<span class="o">/</span><span class="m">2</span> <span class="o">*</span>
</span><span class='line'>    log<span class="p">(</span>t<span class="p">(</span>y<span class="p">)</span> <span class="o">%*%</span> y
</span><span class='line'>        <span class="o">-</span> n<span class="o">/</span><span class="p">(</span>n<span class="o">+</span><span class="m">1</span><span class="p">)</span>
</span><span class='line'>        <span class="o">*</span> t<span class="p">(</span>y<span class="p">)</span> <span class="o">%*%</span> P1 <span class="o">%*%</span> y<span class="o">-</span><span class="m">1</span><span class="o">/</span><span class="p">(</span>n<span class="o">+</span><span class="m">1</span><span class="p">)</span> <span class="o">*</span> t<span class="p">(</span>beta<span class="p">)</span>
</span><span class='line'>        <span class="o">%*%</span> t<span class="p">(</span>cbind<span class="p">(</span>rep<span class="p">(</span><span class="m">1</span><span class="p">,</span>n<span class="p">),</span> X<span class="p">))</span> <span class="o">%*%</span> P1
</span><span class='line'>        <span class="o">%*%</span> cbind<span class="p">(</span>rep<span class="p">(</span><span class="m">1</span><span class="p">,</span>n<span class="p">),</span> X<span class="p">)</span> <span class="o">%*%</span> beta
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>gocho <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>niter<span class="p">,</span> y<span class="p">,</span> X<span class="p">){</span>
</span><span class='line'>  lga <span class="o">&lt;-</span> dim<span class="p">(</span>X<span class="p">)[</span><span class="m">2</span><span class="p">]</span>
</span><span class='line'>  beta <span class="o">&lt;-</span> lm<span class="p">(</span>y ~ X<span class="p">)$</span>coeff
</span><span class='line'>  gamma <span class="o">&lt;-</span> matrix<span class="p">(</span><span class="m">0</span><span class="p">,</span> nrow<span class="o">=</span>niter<span class="p">,</span> ncol<span class="o">=</span>lga<span class="p">)</span>
</span><span class='line'>  gamma<span class="p">[</span><span class="m">1</span><span class="p">,]</span> <span class="o">&lt;-</span> sample<span class="p">(</span>c<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> lga<span class="p">,</span> rep<span class="o">=</span><span class="k-Variable">T</span><span class="p">)</span>
</span><span class='line'>  <span class="kr">for</span><span class="p">(</span>t in <span class="m">1</span>:<span class="p">(</span>niter<span class="o">-</span><span class="m">1</span><span class="p">)){</span>
</span><span class='line'>    j <span class="o">&lt;-</span> sample<span class="p">(</span><span class="m">1</span>:lga<span class="p">,</span><span class="m">1</span><span class="p">)</span>
</span><span class='line'>    gam0 <span class="o">&lt;-</span> gamma<span class="p">[</span>t<span class="p">,]</span>
</span><span class='line'>    gam1 <span class="o">&lt;-</span> gamma<span class="p">[</span>t<span class="p">,]</span>
</span><span class='line'>    gam1<span class="p">[</span>j<span class="p">]</span> <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">-</span> gam0<span class="p">[</span>j<span class="p">]</span>
</span><span class='line'>    pr <span class="o">&lt;-</span> lpostw<span class="p">(</span>gam0<span class="p">,</span> y<span class="p">,</span> X<span class="p">,</span> beta<span class="p">)</span>
</span><span class='line'>    pr <span class="o">&lt;-</span> c<span class="p">(</span>pr<span class="p">,</span> lpostw<span class="p">(</span>gam1<span class="p">,</span> y<span class="p">,</span> X<span class="p">,</span> beta<span class="p">))</span>
</span><span class='line'>    pr <span class="o">&lt;-</span> exp<span class="p">(</span>pr <span class="o">-</span> max<span class="p">(</span>pr<span class="p">))</span>
</span><span class='line'>    gamma<span class="p">[</span>t<span class="o">+</span><span class="m">1</span><span class="p">,]</span> <span class="o">&lt;-</span> gam0
</span><span class='line'>    <span class="kr">if</span><span class="p">(</span>sample<span class="p">(</span>c<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> <span class="m">1</span><span class="p">,</span> prob<span class="o">=</span>pr<span class="p">)){</span>
</span><span class='line'>      gamma<span class="p">[</span>t<span class="o">+</span><span class="m">1</span><span class="p">,]</span> <span class="o">&lt;-</span> gam1
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  gamma
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>練習問題 6.5</h3>

<h4>a. <img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbeta%7C%5Csigma%5E2%2CX+" alt="\beta|\sigma^2,X " />から<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X%5Cbeta%7C%5Csigma%5E2%2CX+" alt="X\beta|\sigma^2,X " />と<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbold%7By%7D%7C%5Csigma%5E2%2CX+" alt="\bold{y}|\sigma^2,X " />を導出する</h4>

<p>1つ目は，正規分布の線形変換を使う．これは，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X+%5Csim+%5Cmathcal%7BN%7D%28%5Cmu%2C%5Csigma%5E2%29+" alt="X \sim \mathcal{N}(\mu,\sigma^2) " />のとき<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=Y+%3D+AX+%2B+b+" alt="Y = AX + b " />とすると<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=Y+%5Csim+%5Cmathcal%7BN%7D%28A%5Cmu%2Bb%2CA%5Csigma%5E2+A%5E%5Cmathrm%7BT%7D%29+" alt="Y \sim \mathcal{N}(A\mu+b,A\sigma^2 A^\mathrm{T}) " />となる．
この性質により，</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X%5Cbeta%7C%5Csigma%5E2%2CX%5Csim%5Cmathcal%7BN%7D_n%28X%5Ctilde%7B%5Cbeta%7D%2Cn%5Csigma%5E2X%28X%5E%5Cmathrm%7BT%7DX%29%5E%7B-1%7DX%5E%5Cmathrm%7BT%7D%29+" alt="X\beta|\sigma^2,X\sim\mathcal{N}_n(X\tilde{\beta},n\sigma^2X(X^\mathrm{T}X)^{-1}X^\mathrm{T}) " /></p>

<p>となる．</p>

<p>2つ目は，正規分布の再生性を使う．これは，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X+%5Csim+%5Cmathcal%7BN%7D%28%5Cmu_X%2C%5Csigma_X%5E2%29+" alt="X \sim \mathcal{N}(\mu_X,\sigma_X^2) " />と<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=Y+%5Csim+%5Cmathcal%7BN%7D%28%5Cmu_Y%2C%5Csigma_Y%5E2%29+" alt="Y \sim \mathcal{N}(\mu_Y,\sigma_Y^2) " />が独立ならば<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X%2BY+%5Csim+%5Cmathcal%7BN%7D%28%5Cmu_X%2B%5Cmu_Y%2C%5Csigma_X%5E2%2B%5Csigma_Y%5E2%29+" alt="X+Y \sim \mathcal{N}(\mu_X+\mu_Y,\sigma_X^2+\sigma_Y^2) " />が成り立つというものである．いま，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbold%7By%7D%3D%5Cbeta+X%2B%5Cvarepsilon+" alt="\bold{y}=\beta X+\varepsilon " />における<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbeta+X+" alt="\beta X " />と<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cvarepsilon+" alt="\varepsilon " />はともに独立の正規分布なので，1つ目で求めた式と合わせて</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbold%7By%7D%7C%5Csigma%5E2%2CX+%5Csim+%5Cmathcal%7BN%7D_n%28X%5Ctilde%7B%5Cbeta%7D%2C%5Csigma%5E2%28I_n%2Bn%5Csigma%5E2X%28X%5E%5Cmathrm%7BT%7DX%29%5E%7B-1%7DX%5E%5Cmathrm%7BT%7D%29%29+" alt="\bold{y}|\sigma^2,X \sim \mathcal{N}_n(X\tilde{\beta},\sigma^2(I_n+n\sigma^2X(X^\mathrm{T}X)^{-1}X^\mathrm{T})) " /></p>

<p>となる．</p>

<h4>b. &amp; c.</h4>

<p>まだよく分かっていないので後回し．設問b.に関しては，どうやら「<a href="http://www.amazon.co.jp/gp/product/0387389792/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=0387389792&linkCode=as2&tag=yagays-22">Bayesian Core: A Practical Approach to Computational Bayesian Statistics (Springer Texts in Statistics)</a><img src="http://www.assoc-amazon.jp/e/ir?t=yagays-22&l=as2&o=9&a=0387389792" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />」に詳しく書いてある(らしい)．該当部分をざっと読んでみたけど，よく分からなかった…．</p>

<h3>参考</h3>

<ul>
<li><a href="http://www.is.titech.ac.jp/~mase/mase/html.jp/temp/swiss.jp.170.html">R: スイスの出生率と社会経済指標データ (1888)</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「アナタはなぜチェックリストを使わないのか？」読了]]></title>
    <link href="http://yagays.github.com/blog/2012/12/10/review-checklist-manifesto/"/>
    <updated>2012-12-10T08:29:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/10/review-checklist-manifesto</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4863912803" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>本書は，世界中の病院における手術の安全性を向上させるためのWHO主導のプログラムに参加し，チェックリストを導入するというただそれだけのことでプログラムを大成功に導いた一人の医師による著作である．ここで言うチェックリストとは，箇条書きにしたメモにチェック欄がついているような至って普通のものである．それがなぜ手術における安全性を劇的に改善することができたのか，チェックリストによって何がどう変わったのか，そもそもなぜチェックリストなのか．そういった自然と湧き上がる疑問に対して本書は科学的に検証された実験結果として，建築業界や航空機産業における具体例とともに，チェックリストの有効性を示すものである．</p>

<p>以下では，本書で挙げられたチェックリストの性質について個人的にまとめてみた．</p>

<ul>
<li><strong>チェックリストは複雑な状況において有効な手段である</strong>

<ul>
<li>複雑な状況とは，「一個人で知るのは不可能な量の知識を必要とし，不確定要素が多い状況 (P.92)」を指す</li>
<li>複雑な状況は，一人のエキスパートによる一極集中の指令システムでは対処できない</li>
</ul>
</li>
</ul>


<br/>


<ul>
<li><strong>チェックリストは規律である</strong>

<ul>
<li>規律を忠実に守ることにより，複雑な状況における個人の判断ミスを防ぐことができる</li>
<li>チェックリストは万能なマニュアルではなく，人間の優れた技能と組み合わせた運用を必要とする</li>
<li>チェックリストの使用は複雑な問題の中にある個々の単純な問題を解消し，問題をシンプルにする</li>
</ul>
</li>
</ul>


<br/>


<ul>
<li><strong>チェックリストの有用性はWHOのプロジェクトにおいて示された</strong>

<ul>
<li>問題を洗い出しチェックリストの効果を証明するには，実験前・実験後のデータ収集が必要である</li>
<li>現場に合わせた適切なチェックリスト作成と継続的な改良が必要である</li>
<li>チェックリストの導入は無理に押し付けるのではなく，科学的根拠を示すとともに自発的な参加を促さなければならない</li>
</ul>
</li>
</ul>


<p>本書では，これらの事柄が豊富な具体例を織り交ぜて丁寧に解説される．本書を読み終わる頃には，チェックリストのあらゆる側面を見ることができる．それは私たちの生活がより複雑さを増していく状況において，非常に明快かつシンプルで革新的な手段となりうるだろう．</p>

<p>当初は，私自身たかがチェックリストにこれほどまでに説得されるとは思っても見なかった．本書が素晴らしいのは，日頃から見逃されがちな失敗を表に引きずり出し，その対策をチェックリストを使うことで実現し，さらに普及させるといった段階にまで踏み込んでいる点にある．著者自身も，航空機産業における徹底した問題の改善の手腕に感動し，自身の医療の現場における小さなミスの繰り返しがいかに見逃されて改善の手段が広まらないかを懸念するところからスタートしている．そういった教訓から手術現場におけるチェックリストという発想に著者は至ったわけだが，読者としては本書を読めば自然とチェックリストを使いたくなるだろう．恐らくこれからもっと多分野でチェックリストが使われるようになると思われるのだが，まずは自分が問題を発見しそして実践してみないことには始まらない．とりあえず個人で色々試行錯誤してみようと思う．幸い本書の最後には「チェックリスト作成のためのチェックリスト」というものも載っており，<a href="http://www.projectcheck.org/">ウェブページ</a>もあるようだ．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「服従の心理」読了]]></title>
    <link href="http://yagays.github.com/blog/2012/12/09/review-obedience-to-authority/"/>
    <updated>2012-12-09T15:04:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/09/review-obedience-to-authority</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=430946369X" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>これほどまでに背筋が凍るほどの恐ろしさを感じながらも同時に文章から目を離さずにはいられないくらい引き込まれるような本を，いまだかつて私は読んだことがない．本書はある心理学の実験についての報告と結果の考察を淡々と述べたものでありがながら，そこから導かれる結論は私たち人間の隠れた性質を暴くものである．それは20世紀のある歴史上の事件と対になって初めて本質をあらわにする．ナチスドイツにおけるユダヤ人虐殺である．</p>

<p>本書は，「アイヒマン実験」または「ミルグラム実験」と呼ばれる心理学実験に基づく実験報告である．この通称は，アドルフ・アイヒマンというナチスドイツによるユダヤ人虐殺に深く関与した人間の名前，またはスタンレー・ミルグラムという本実験を行った心理学者に由来する．アイヒマンとこの実験を深く関連付ける要素は「服従」である．人というものは，何らかの社会構造における上下関係の中で社会的な役割を果たすことにより，その地位であったり家族の生活やアイデンティティを維持する．そのなかで，権威があって立場が上の人間によって命令された倫理を逸脱する非道な指示に対して，それを受け入れ服従するか異を唱えて反発するかといった個人の葛藤が，この実験の中心的な問題である．アイヒマンという人物は，このような命令に服従し実行してしまった張本人として歴史に名を残し，この議論の中核的な存在となった．そのアイヒマンに対して当初は誰もが，通常では考えられないほどの非人道的な行為を行う人間は，常識的な社会生活を行う自分たちとは全く異質のかけ離れた存在であるかのように思っていた．しかし，本書の著者であるスタンレー・ミルグラムは，アイヒマンは特殊な人間ではなく普通の一般人と何ら変わらない人間であり，逆に言えば一般人と認識している人間もまたアイヒマンと同じ境遇に置かれると同じ行為を犯してしまう可能性があることを心理学実験によって示した．</p>

<p>本書はスタンレー・ミルグラムの衝撃的な実験結果を示すものでありがなら，同時に本実験に対する異論や反論を訳者である山形浩生が訳者後書きとして巧みに指摘している．その批判的検討を含め，本書が描き出す権威の服従という問題は状況や立場によって複雑な挙動を示し，一個人の責任や従属関係について改めて提起するものである．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「スパコンとは何か」読了]]></title>
    <link href="http://yagays.github.com/blog/2012/12/08/review-what-is-a-supercomputer/"/>
    <updated>2012-12-08T13:29:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/08/review-what-is-a-supercomputer</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4863100981" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>スパコン事業仕分けに参加された東京大学情報基盤センター教授の金田先生によるスパコンの総括的な解説書．仕分けの焦点となった処理能力のランキングの問題から，スパコンの基本的な仕組み，スパコンがどのような分野に活用されているのかといった実用面，そして日本の企業が独立して開発を行なってきた歴史とこれからの行く末について書かれている．</p>

<p>本書の主張は一貫して，スパコン開発というものは事業仕分けで論点となった世界一位かどうかが問題なのではなく，国や企業のプロジェクトとして明確な方向性を持たなければ意味がないというものだ．本書の中では，日本のスパコン開発の歴史に触れ，黎明期のアメリカとの開発競争であったり，地球シミュレーターという一世代前のスパコンがどのような目標を持って開発が行われ実際に稼働したかといった経緯が紹介される．そして，現在開発が完了し実際に稼働している京コンピューターが，いかに処理能力のランキング云々よりも重要な課題を孕んだまま進行したプロジェクトであるかといった問題点が指摘される．その中で繰り返し述べられるのが，「目標」と「ハード・ソフト」について長期的な視点が欠如しているということであり，実際にスパコンを使って解くべき問題が明確ではなく，その目標のために必要なハードウェアとソフトウェア両者の環境開発整備であったり人材育成体制が一番の問題であると，著者の金田氏は主張する．</p>

<p>金田氏はあくまで事業仕分けに参加した有識者として，そしてスパコンの一研究者として，日本のスパコンの現状に対する見解を述べている．その中にはもちろん外部からはあまり知ることのできない政治的な部分も多く含まれてはいるものの，NECや日立製作所の脱落などの中核の部分に関してはあまり触れられていない．個人的にはその辺りに関して興味があったものの，あまり直接的な表現をされていなかったので少し残念ではあった．一方で，スパコンを取り囲む大規模なプロジェクト全体に関して，何が重要でどういったところを役人や有識者が見ているのかといったポイントは非常に参考になった．計画を立てるというただそれだけのことが，いかにして不確実な未来を予測し確実な案へと落としこみ，それを様々な立場の人間に納得させるかという難しさを持っているということが，本書からはひしひしと伝わってきた．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「リーダーを目指す人の心得」読了]]></title>
    <link href="http://yagays.github.com/blog/2012/12/07/review-colin-powell/"/>
    <updated>2012-12-07T17:45:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/07/review-colin-powell</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4864101930" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>「私は逸話が大好きだ」という言葉から始まる本書は，著者であるコリン・パウエルが国務長官などの数々の職歴のなかで経験してきた逸話を通して，リーダーシップや人生の教訓について語った著作である．タイトルからは自己啓発系のハウツー本のような印象を受けるが，実際に読んでみると，登場する逸話はどれも彼の豊かな人間性を表すようなものばかりで，まるで自伝の一部を読んでるかのような感覚に陥る．文章の端々に見られる責任感の強さや謙虚さ，そしていかに細かなことも見逃さず上司や部下に注意を払うかといった繊細さと思慮深さは，まさに指導者の鑑といって過言ではないだろう．</p>

<p>登場する逸話は，陸軍の軍人であったり国務長官などの役人としての体験が多い．軍部や政府に関する話は普通の人からはかなり縁遠い存在でありながらも，その中で語られる会話や出来事は，そういった特殊な環境であることを忘れさせるほどに人間味あふれている．また，コリン・パウエル自身のリーダーとしての指導経験も数多く紹介され，自分がどのように考えどのように組織を動かすのかといったテクニックも興味深い．特に，彼が新しいスタッフの元で働くときに配るという「べからず集」は，部下に何を期待して成果を挙げるべくチームを動かすかといったエッセンスが含まれている．そこで色々と列挙されるやってはいけない事というのは，ほとんどがコミュニケーションに関することだ．口頭での会話から公式文書まで，いかに効率よく個人が能力を発揮するかについて考えられている．とにかく彼自身，組織が円滑に回ることは車を修理して動かすことと似ていて非常に喜びを覚えるとも書いていることからも，彼の性格を考慮しても，組織のまとめ方に並々ならぬ努力を割いていたことがわかる．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「ニンジャスレイヤー ネオサイタマ炎上1」読了]]></title>
    <link href="http://yagays.github.com/blog/2012/12/06/review-ninja-slayer/"/>
    <updated>2012-12-06T21:07:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/06/review-ninja-slayer</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4047283312" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>前々から小説自体も断片的に読んでいたし，流れてくるネット評もちらほら流れてきて，特徴的な言い回しがネットスラングとしても着実に勢力を伸ばしていることも感じていた．今回はそれらの確認という意味でも，書籍化され複数の物語がひとつにまとめられた本書を読んだのだが，何と表現していいのか…ただ，とにかく色んな意味で凄い，そして面白い．これを単純なプロットで構成された似非日本語のSFと言うなかれ，これは文化の融合なのだ．</p>

<p>世の中には，日本というローカルな視点から抜けだせずに，やれ外国でもてはやされているのは間違った日本文化だとか，ちゃんとした日本文化を伝えないといけないだとかいった貧しい考えの人がある程度存在する．そういう人たちは自身の日本の見方に何の疑問も抱かずに外部を批判するわけだけれども，その自分たちの日本文化をそっくりそのまま異文化の人間に理解し受け入れてもらう難しさというのを，全くもって理解していない．異文化は自分たちとは違うからこそ異文化なのだ．インド料理屋にいけばインド人がインド料理食べてるし，トルコ料理屋にいけばトルコ人がトルコ料理食べているわけで，そういった異文化の認識から一歩踏み込んで，自分たちの文化の一つとしてカレーなりケバブなりの食文化であったり，宗教などを含む独自の文化が認識されるには，非常に繊細な文化のすり合わせが必要になる．外国人だって日本料理が食べたければ日本料理屋に行くだろう．じゃあそれで日本文化が認知されて，よく分からない生魚とライスを食べる文化として理解されたら，それで満足だろうか．本当に知ってもらいたいことはそんな事実の羅列ではないだろう．自分たちの様式を変えてまでも，相手の文化の懐に潜り込んで，日本文化の本質を相手に理解してもらいと思わないだろうか．そして相手に自分たちの文化のエッセンスを取り込んでもらい，より新しい文化というものを作って欲しくはないだろうか．</p>

<p>とまあ気が付けば変な講釈を垂れ流してしまったが，結論としてはニンジャスレイヤーは日本人が読んでもエンターテイメント性に優れていて面白いということで．というか，逆に日本人の英語への理解が必要な部分がある．あまり馴染みのない英語のカタカナ表記があって，lesserやgreaterみたいな何となく分かりそうなものから，shrineやcoffinみたいな意味を知らないと理解できない単語もちらほら見られるので，そのあたりはどっちかというと日本人の理解が試されている感がある．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「データ解析のための統計モデリング入門」読書ノート 10章 階層ベイズモデルの生成過程とグラフィカルモデル]]></title>
    <link href="http://yagays.github.com/blog/2012/12/05/glm-mcmc-chp10/"/>
    <updated>2012-12-05T13:31:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/05/glm-mcmc-chp10</id>
    <content type="html"><![CDATA[<ul>
<li>まとめ：<a href="http://yagays.github.com/blog/2012/10/14/review-glm-mcmc/">「データ解析のための統計モデリング入門」読書ノート</a></li>
</ul>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=400006973X" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>今回は特に図を再現するわけでもなくコードを動かすわけでもないのだが，自学のために10章の階層ベイズモデルの生成過程を丁寧に追ってみて，グラフィカルモデルを描いてみた．</p>

<h3>10章の階層ベイズモデルで用いる実験条件 </h3>

<p>まずは実験条件の確認．今回は，植物から得られる種子数と施肥処理の有無の関係を調べる．対象となる植物100個体はそれぞれ10個体ずつ植木鉢に植えられており，その植木鉢のうち半分は施肥処理がされている．つまり，植物50個体は無処理で，もう半分の50個体は施肥処理がされた個体である．その植物個体からそれぞれ種子を採取し，施肥処理の有無による種子数の変化をみる．</p>

<p>これだけ見ると無処理と施肥処理の植物個体の種子数の平均を見れば何となく分かりそうだが，今回はしっかりとモデルを組んで，どの要因がどれだけ影響するのかといったことまでも含めて解析を行なう．今回の話の筋としては，単純に平均で考えたりGLMで調べると施肥処理の効果はありそうという結果が出るけれども，場所差・個体差などの擬似反復の要素を取り入れたモデルを組めば施肥処理の効果は無いという結論を導くといった流れになっている．</p>

<h3>潜在変数モデルと生成過程，グラフィカルモデル</h3>

<p>ここからは，本書の内容に自分の知識や人から教わった内容を組み合わせて解釈した内容となっている．そのため，本書に書いていない内容を扱ったり著者の意向に沿わない書き方をしているかもしれないので，その辺りはご注意を．</p>

<p>今回考慮する個体差<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=r_i+" alt="r_i " />や場所差<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=r_j+" alt="r_j " />という要素は，本書7章でも定義しているように「人間が測定出来無い・測定できなかった」数量や因子である．こういった要素というのは一般に「潜在変数」と言い，これを組み込んだモデルは「潜在変数モデル」と呼ばれる．ベイズモデルにおいてはパラメータはある真の値を持つ数学的な変数ではなく，何らかの分布をもつ確率変数として扱う．そのため，非ベイズで考えていたパラメータ自体を，潜在変数とハイパーパラメータのような組み合わせで表現することができる．</p>

<p>また，観測データがどのような確率モデルによって生成されたかをモデルとして表現することを，生成モデルまたは生成過程と呼ぶ．そして，モデルを図式的に記述するために用いるのがグラフィカルモデルである．特に今回の場合では確率分布を表すので，確率的グラフィカルモデルとも呼ばれる．</p>

<h3>10章の階層ベイズモデルを生成過程やグラフィカルモデルで記述してみる</h3>

<p>それでは実際に，上で説明した実験条件を生成過程やグラフィカルモデルで表してみる．といっても本書とかけ離れた難しいことをやりたいわけではなくて，下で示す生成過程はBUGS言語を数式に直しただけだし，グラフィカルモデルは基本的に本書P.238の図10.8とほぼ同じような内容となっている．</p>

<h3>生成過程</h3>

<p><img src="http://dl.dropbox.com/u/142306/b/glm_chp10_2.png" alt="" /></p>

<h3>グラフィカルモデル</h3>

<p><img src="http://dl.dropbox.com/u/142306/b/glm_chp10_1.png" alt="" /></p>

<h3>グラフィカルモデルの表記について</h3>

<p>四角で囲っている部分はプレートと呼ばれ，複数のノードをひとつにまとめたものである．今回は例で言えば，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=r_i+%3D+%5C%7Br_1%2Cr_2%2C%5Cdots%2Cr_%7B100%7D%5C%7D+" alt="r_i = {r_1,r_2,\dots,r_{100}} " />の100個のノードを横一列に並べて全て描き表すかわりに，プレートを使って一つのノードを代表させている．また，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=y_i+" alt="y_i " />を<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=y_%7Bji%7D+" alt="y_{ji} " />と書いているのは，生成過程での2つのイテレーションの内側にあるということを強調するためである．その割には場所差を<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=r_%7Bj%28i%29%7D+" alt="r_{j(i)} " />と表記しているが，こちらは本書に準拠した書き方をしている．なお，ここでは施肥処理の有無である<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=f_i+" alt="f_i " />は観測値なので一応入れていない</p>

<p>あと，変数やパラメータの書き方に色々と流儀はあるようだが，今回はあまり気にしていない．PRML風に書くならば，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbeta_1%2C%5Cbeta_2%2Cs%2Cs_p+" alt="\beta_1,\beta_2,s,s_p " />を塗りつぶされた小さな点で表現して，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=y_%7Bji%7D+" alt="y_{ji} " />のノードを影付けする感じだろうか．</p>

<h3>グラフィカルモデルから数式への変換</h3>

<p>グラフィカルモデルの何が嬉しいかといえば条件付き独立性が云々という話など色々とあるようだが，個人的な感覚としては，グラフィカルモデルをぱっと見るだけでモデルで考慮すべき事前分布が<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=y_%7Bji%7D+" alt="y_{ji} " />にかかるすべての確率変数の積<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=p%28%5Cbeta_1%29p%28%5Cbeta_2%29p%28s%29p%28s_p%29%5Cprod_i%5Cprod_j+p%28r_i%7Cs%29p%28r_j%7Cs_p%29+" alt="p(\beta_1)p(\beta_2)p(s)p(s_p)\prod_i\prod_j p(r_i|s)p(r_j|s_p) " />で書けるということがわかるというのは結構大きい気がする．ちなみに，グラフィカルモデルのプレートで表している部分が<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cprod+" alt="\prod " />と対応している．</p>

<h3>イテレーションの階層構造について</h3>

<p>本書では個体番号<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=i+" alt="i " />により植木鉢<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=j+" alt="j " />が決まるとしているため，個体番号<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=i+" alt="i " />のイテレーションの中に<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=j+" alt="j " />が入る形となっている．個人的には「個体番号1の植木鉢Aの個体」よりかは「植木鉢Aの個体番号1の個体」のような階層構造にしたほうがイメージしやすいと思うが，今回は場所差と個体差は独立ということなので，どちらにせよ結果は変わらないはず．</p>

<h3>おまけ</h3>

<p>カフェでsyou6162にグラフィカルモデルについて教えを乞う図．ケーキを食べながら必死にお絵かきしてました．</p>

<p><img src="http://dl.dropbox.com/u/142306/b/20121202.jpg" alt="" /></p>

<h3>参考</h3>

<ul>
<li>(pdf) <a href="http://www.kecl.ntt.co.jp/as/members/ueda/pdf/CVIM-ueda.pdf">http://www.kecl.ntt.co.jp/as/members/ueda/pdf/CVIM-ueda.pdf</a></li>
</ul>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4621061224" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4621061240" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「系統樹曼荼羅―チェイン・ツリー・ネットワーク」読了]]></title>
    <link href="http://yagays.github.com/blog/2012/12/04/review-phylogeny-mandala/"/>
    <updated>2012-12-04T15:12:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/04/review-phylogeny-mandala</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4757142633" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>久々に，眺めるだけで楽しく好奇心を刺激される本に出会った．まさに大人の図鑑といった趣で，とにかく見ているだけで楽しい．もちろん系統樹の歴史であったり掲載されている図版の説明もしっかりと書かれているので，文章を読んで楽しい本でもある．しかしながら，次々と目に飛び込んでくる古今東西ありとあらゆる種類の系統樹たるや，早く色んな絵を見たいと文字を追うのを忘れてページをめくりたいと思わせるほどである．</p>

<p>本書は「<a href="http://www.amazon.co.jp/gp/product/4061498495/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=4061498495&linkCode=as2&tag=yagays-22">系統樹思考の世界 (講談社現代新書)</a><img src="http://www.assoc-amazon.jp/e/ir?t=yagays-22&l=as2&o=9&a=4061498495" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />」や「<a href="http://www.amazon.co.jp/gp/product/4062880148/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=4062880148&linkCode=as2&tag=yagays-22">分類思考の世界 (講談社現代新書)</a><img src="http://www.assoc-amazon.jp/e/ir?t=yagays-22&l=as2&o=9&a=4062880148" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />」などの著作で知られる三中信宏氏の著作である．図版に関しては杉山久仁彦氏が別にクレジットされているが，「<a href="http://www.amazon.co.jp/gp/product/4532511852/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=4532511852&linkCode=as2&tag=yagays-22">進化が語る 現在・過去・未来(別冊日経サイエンス185) (別冊日経サイエンス 185)</a><img src="http://www.assoc-amazon.jp/e/ir?t=yagays-22&l=as2&o=9&a=4532511852" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />」にある茂木健一郎氏との対談を読む限りでは，三中氏本人も相当のコレクターであると思われる．本書では，三中氏の専門に深いつながりがある系統樹のみならず，人間がこれまで生み出してきた分類にまつわるありとあらゆる図形に焦点をあてることによって，人間がオブジェクトを分類するという行為について体系化しようといった内容となっている．この中で紹介される図版は，大昔にかかれた家系図から始まり，宗教画などのモチーフ，ヘッケルの分類体系以降の科学的な記述，そして現代の複雑ネットワークなどの可視化にまで及ぶ．これはまさに「図形言語」と呼ぶに相応しい自然言語と並ぶ人類の発明であり，人間がどのように考える道具として図形を扱ってきたのかといった歴史を辿るものでもある．そういった系統樹に代表される図形を通して，図形が何を示しているのかといった基本的な読み方から，様々な工夫が加えられていく図形の変移の過程，そして副題にもあるチェイン・ツリー・ネットワークという概念の構築が考察される．</p>

<p>本書はタイトルに系統樹とあって生物学としてのイメージが強いものの，ある程度知識があればどんな分野の人でも楽しく読める内容だと思われる．個人的には，特に統計や情報系の人間であればベン図の表記に慣れ親しんでいるし，デンドログラムはどの段階で見るかでクラスタリング結果が違ってくるといったことはよく知られているわけで，もしかしたら生物学の人間以上に楽しめるんじゃないかと思う．ノードとエッジを基本にしたグラフ理論に繋がる話題でもあるし，最近のインフォグラフィックとしても興味深く見ることができる．そういった意味でも，生物系と情報系の中間にいる私にとっては，非常に満足度の高い1冊だった．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[新しいことを始めるよりも日々の生活の手段を少し変える方が自分には向いている]]></title>
    <link href="http://yagays.github.com/blog/2012/12/03/misc-bicycle/"/>
    <updated>2012-12-03T10:56:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/03/misc-bicycle</id>
    <content type="html"><![CDATA[<h3>新しいオモチャへの期待</h3>

<p>2年くらい前に10万円ほどする自転車を買った．その自転車はロードバイクの中でもエントリーモデルで特に性能が良いわけでもないのだが，今までの僕の自転車に乗るという体験を全く別のものに変えてしまうほどの乗り心地だった．今でも当時の感覚は鮮明に残っているし，自転車に乗るのはとても楽しい．もっとハイクラスな自転車を欲しくなるし，自転車をもっと上手く乗り回したいという気持ちもある．</p>

<p>自転車を買った当初は，これで僕の生活はガラリと変わるだろうと思っていた．前々からやりたいと思っていたツーリングにも行けるし，あっちこっち遊びに行って写真を撮ったり新しい体験ができる，そして適度な運動もできて健康になるかもしれない．そんな希望とも目標ともつかないようなやんわりとしたイメージを自転車に抱きながら，新しく手に入ったオモチャで遊んでいた．</p>

<p>そのような時期から2年が経ち，改めて現在の自分の生活を振り返ってみると，達成できたものもあり達成できなかったものもある．</p>

<h3>ツーリングは続かなかった</h3>

<p>自転車を買って，まず荒川の河川敷に出かけるところから始めた．そこには葛西臨海公園近くの河口付近から上流に向かって川沿いに整備された道があり，サイクリングロードではないものの，平坦で長い距離をずっと走ることができる．当時は新しい自転車に慣れていなかったり，そもそも自転車に乗るための筋力が全くなかったこともあって，トレーニングとしてその道をよく自転車で走った．信号機などの障害がほとんど無い道なので，走ろうと思えば30分でも1時間でも走っていられる．また，天気のいい日の荒川河川敷から見る日の出は本当に美しく，東京であることを忘れるくらいの清々しい気分にさせてくれる．このように，自転車乗りとしてはとても良い場所であることには間違いないのだが，徐々に出かける回数が減り，最近ではめっきり足が遠のいてしまった．ある程度飽きてしまったからかもしれないし，時間を確保してその日の天気と体調を確認してといったように，意識して準備しなければいけないことが多いからかもしれない．</p>

<h3>都内の移動はもっぱら自転車になった</h3>

<p>一方で，都内の主な移動手段としての自転車が，僕の生活の中で非常に大きな位置を占めるようになった．電車での移動がほとんど無くなり，代わりに自転車であちこちに出かけるようになった．それまで電車で移動していた距離くらいなら，自転車を使ったほうが早く着くし交通費が掛からない．もちろん遠出は無理だし天気のいい日に限るが，それでも普段の移動の半分以上は自転車に置き換わったと言っていい．電車と自転車を使い分けるときの境界線は，移動時間がだいたい30分を超えるか超えないかくらいだと思う．それくらいの時間でも，僕の家からだと山手線の中はほとんど網羅できる．そうなると，もはや普段からよく行く場所は自然と自転車での移動となった．おまけに，自転車で移動するコストは非常に低いので，普段電車で行くほどでもないような場所にも気軽に足を運ぶことができる．神保町なんかは自転車に乗るようになってから頻繁に通うようになった場所の一つだ．特に欲しい物が無いときでも，ふらっと出かけては店の表に積まれている安売りの本を眺めたりしている．また，深夜に新宿に出掛けては，終電に乗れないくらいの時間帯の空いている映画館で一人映画を見ることも多くなった．といったように，移動手段の変化によって僕の生活の一部は自転車無しでは考えられないくらいにまでに色々な習慣が定着した．</p>

<h3>まとめ</h3>

<p>結局のところ自転車を買ったことで生活は色々な面で変わったものの，当初予想していたところからはだいぶ違うところに来てしまったしまった．それでも今の自転車のある生活にはかなり満足しているし，僕の性格がよく表れているような気がする．</p>

<h3>私信</h3>

<p>ということで，たとえ僕が高級デジイチを買ったとしても途中で飽きそうなので，カメラは買いません．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Machine Learning Advent Calendar 2012でギブスサンプリングの記事を書きました]]></title>
    <link href="http://yagays.github.com/blog/2012/12/02/qiita-ml-advent-calendar-day2/"/>
    <updated>2012-12-02T21:58:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/02/qiita-ml-advent-calendar-day2</id>
    <content type="html"><![CDATA[<ul>
<li><a href="http://qiita.com/advent-calendar/2012/machinelearning">Machine Learning Advent Calendar 2012 - Qiita</a></li>
<li><a href="http://qiita.com/items/5bde6addf228b1fe24e6">PRML 11章 二変量正規分布からのギブスサンプリング #PRML #R - Qiita</a></li>
</ul>


<p>今年も残すところあと1ヶ月ということで，毎年恒例になりつつあるAdvent Calendarが各所で盛り上がっているようです．私もQiitaで開催されているMachine Learning Advent Calendar 2012の2日目で，ギブスサンプリングに関する記事を書きました．こんな動画を撮って遊んでいます．もしよければ本記事の方も御覧ください．</p>

<iframe width="480" height="360" src="http://www.youtube.com/embed/ZaKwpVgmKTY" frameborder="0" allowfullscreen></iframe>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「パターン認識と機械学習」1章 多項式曲線フィッティングをRで書いてみた]]></title>
    <link href="http://yagays.github.com/blog/2012/12/01/prml-1-takousiki/"/>
    <updated>2012-12-01T05:17:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/12/01/prml-1-takousiki</id>
    <content type="html"><![CDATA[<h3>事の発端</h3>

<blockquote class="twitter-tweet"><p>これこれ、これですよ / “PRML読書会第一回 - Seeking for my unique color.” <a href="http://t.co/qtGtiKuO" title="http://htn.to/w8bGen">htn.to/w8bGen</a></p>&mdash; Yokoyama T (@wakuteka) <a href="https://twitter.com/wakuteka/status/272995562582835201" data-datetime="2012-11-26T09:29:48+00:00">November 26, 2012</a></blockquote>


<script src="http://yagays.github.com//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>先日「<a href="http://d.hatena.ne.jp/syou6162/20080801/1217528370">PRML読書会第一回 - Seeking for my unique color.</a>」のソースコードが一部界隈で局地的に話題にあがり，やれ</p>

<ul>
<li>takousikiってなんだよロシア人かよ</li>
</ul>


<p>だとか</p>

<ul>
<li>evalが多すぎて引いた</li>
</ul>


<p>だのといった罵詈雑言が（主に僕の口から）飛び交っていたわけだけれども，さすがに言うだけではsyou6162先生に申し訳ないと感じ，改めて彼のコードをRで書きなおしてみることにした．</p>

<h3>多項式曲線フィッティングのコードを書き直す</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>f <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">){</span>sin<span class="p">(</span><span class="m">2</span><span class="o">*</span>pi<span class="o">*</span>x<span class="p">)}</span>
</span><span class='line'>
</span><span class='line'>takousiki <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>n<span class="p">){</span>
</span><span class='line'>  x <span class="o">&lt;-</span> numeric<span class="p">(</span><span class="m">0</span><span class="p">)</span>
</span><span class='line'>  z <span class="o">&lt;-</span> numeric<span class="p">(</span><span class="m">0</span><span class="p">)</span>
</span><span class='line'>  <span class="kr">for</span><span class="p">(</span>i in <span class="m">1</span>:n<span class="p">){</span>
</span><span class='line'>    x <span class="o">&lt;-</span> cbind<span class="p">(</span>x<span class="p">,</span> seq<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span>by<span class="o">=</span><span class="m">0.1</span><span class="p">)</span><span class="o">^</span>i<span class="p">)</span>
</span><span class='line'>    z <span class="o">&lt;-</span> cbind<span class="p">(</span>z<span class="p">,</span> seq<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span>by<span class="o">=</span><span class="m">0.01</span><span class="p">)</span><span class="o">^</span>i<span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  data <span class="o">&lt;-</span> data.frame<span class="p">(</span>f<span class="p">(</span>seq<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span>by<span class="o">=</span><span class="m">0.1</span><span class="p">))</span><span class="o">+</span>rnorm<span class="p">(</span><span class="m">11</span><span class="p">,</span> mean<span class="o">=</span><span class="m">0</span><span class="p">,</span> sd<span class="o">=</span><span class="m">0.5</span><span class="p">),</span> x<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  colnames<span class="p">(</span>data<span class="p">)</span> <span class="o">&lt;-</span> c<span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">,</span>paste<span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span>as.character<span class="p">(</span><span class="m">1</span>:n<span class="p">),</span>sep<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
</span><span class='line'>  colnames<span class="p">(</span>z<span class="p">)</span> <span class="o">&lt;-</span> paste<span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span>as.character<span class="p">(</span><span class="m">1</span>:n<span class="p">),</span>sep<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># predict</span>
</span><span class='line'>  fit <span class="o">&lt;-</span> lm<span class="p">(</span>y ~ <span class="m">.</span><span class="p">,</span> data<span class="o">=</span>data<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  plot<span class="p">(</span>data<span class="p">[,</span><span class="m">2</span><span class="p">],</span> data<span class="p">[,</span><span class="m">1</span><span class="p">],</span> ylab<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> ylim<span class="o">=</span>c<span class="p">(</span><span class="m">-1.5</span><span class="p">,</span><span class="m">1.5</span><span class="p">),</span> xlab<span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">,</span> main<span class="o">=</span>paste<span class="p">(</span><span class="s">&quot;M=&quot;</span><span class="p">,</span>n<span class="p">))</span>
</span><span class='line'>  curve<span class="p">(</span>f<span class="p">(</span>x<span class="p">),</span> add<span class="o">=</span><span class="k-Variable">T</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span>
</span><span class='line'>  lines<span class="p">(</span>seq<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span>by<span class="o">=</span><span class="m">0.01</span><span class="p">),</span> predict<span class="p">(</span>fit<span class="p">,</span>data.frame<span class="p">(</span>z<span class="p">)),</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>使い方としては，</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>takousiki<span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span><span class='line'>takousiki<span class="p">(</span><span class="m">3</span><span class="p">)</span>
</span><span class='line'>takousiki<span class="p">(</span><span class="m">8</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>とすると，多項式で曲線フィッティングした結果がプロットされる．ただし切片だけの0次は書けない．</p>

<p><img src="http://dl.dropbox.com/u/142306/b/prml_takousiki.png" alt="" /></p>

<p>サンプルデータの生成と推定した曲線の描写用のデータの生成を同時に行なっているため，コードがちょっと見にくいかもしれない．基本的に<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=x%5E2+" alt="x^2 " />や<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=x%5E3+" alt="x^3 " />などの多項式の各項の値をあらかじめデータフレームとして作っておいて，lm()関数で回帰するときのモデルを簡略化している．あと，関数名はオリジナルを踏襲しているので，あしからず．</p>

<h3>他の方法としては</h3>

<p>lm()関数などに渡すモデルは，as.formula()関数を使うことによって文字列から生成することができる．この方法もかなり簡単に使うことができるので，データフレームの列名を規則的に付けている場合などは使い勝手は良いと思われる．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="o">&gt;</span> n <span class="o">&lt;-</span> <span class="m">5</span>
</span><span class='line'><span class="o">&gt;</span> as.formula<span class="p">(</span>paste<span class="p">(</span><span class="s">&quot;y~&quot;</span><span class="p">,</span>paste<span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="m">1</span>:n<span class="p">,</span>sep<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>collapse<span class="o">=</span><span class="s">&quot;+&quot;</span><span class="p">)))</span>
</span><span class='line'>y ~ x1 <span class="o">+</span> x2 <span class="o">+</span> x3 <span class="o">+</span> x4 <span class="o">+</span> x5
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「Rによるモンテカルロ法入門」読書ノート：6章 メトロポリス・ヘイスティング・アルゴリズム その3]]></title>
    <link href="http://yagays.github.com/blog/2012/11/30/imcmr-6-5/"/>
    <updated>2012-11-30T05:04:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/11/30/imcmr-6-5</id>
    <content type="html"><![CDATA[<ul>
<li>読書ノート アーカイブ：<a href="http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/">http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/</a></li>
</ul>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4621065270" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<h3>練習問題 6.13</h3>

<p>この問題は<a href="http://yagays.github.com/blog/2012/11/25/imcmr-6-3/">例6.3</a>と同じく，線形回帰におけるパラメータの事後分布からメトロポリス・ヘイスティング・アルゴリズムを用いてサンプリングを行うことを目標とする．線形回帰の対象はmcsmパッケージに収められているchallengerデータセットで，過去に打ち上げられたスペースシャトルにおけるOリングの破損の有無と，その時の気温に関するものである．</p>

<h3>a. glm()関数を使ってロジスティック回帰を行う</h3>

<p>打ち上げられたスペースシャトルのOリングは破損しているかしていないかの2値で表されるため，今回はロジスティック回帰を用いた当てはめを行う．Oリングが破損している場合は1を，破損していない場合には0が割り当てられており，ある気温<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=x_i+" alt="x_i " />におけるOリングの破損確率は</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=P%28x_i%29+%3D+%5Cfrac%7B%5Cexp%28%5Calpha%2B%5Cbeta_i%29%7D%7B1%2B%5Cexp%28%5Calpha%2B%5Cbeta_i%29%7D+" alt="P(x_i) = \frac{\exp(\alpha+\beta_i)}{1+\exp(\alpha+\beta_i)} " /></p>

<p>で表される．今回はこの<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Calpha+" alt="\alpha " />と<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbeta+" alt="\beta " />をglm()関数を使って推定する．</p>

<p>なお，以下のコードではロジスティック関数を式変形して<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cfrac%7B1%7D%7B1%2B%5Cexp%28-%28%5Calpha%2B%5Cbeta_i%29%29%7D+" alt="\frac{1}{1+\exp(-(\alpha+\beta_i))} " />として計算している．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>library<span class="p">(</span>mcsm<span class="p">)</span>
</span><span class='line'>data<span class="p">(</span>challenger<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>fit <span class="o">&lt;-</span> glm<span class="p">(</span>oring ~ temp<span class="p">,</span> data<span class="o">=</span>challenger<span class="p">,</span> family<span class="o">=</span>binomial<span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span>challenger<span class="p">$</span>temp<span class="p">,</span> challenger<span class="p">$</span>oring<span class="p">,</span> pch<span class="o">=</span><span class="m">19</span><span class="p">)</span>
</span><span class='line'>curve<span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="p">(</span><span class="m">1</span><span class="o">+</span>exp<span class="p">(</span><span class="o">-</span><span class="p">(</span>fit<span class="p">$</span>coef<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span>fit<span class="p">$</span>coef<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span>x<span class="p">))),</span> from<span class="o">=</span><span class="m">53</span><span class="p">,</span> to<span class="o">=</span><span class="m">81</span><span class="p">,</span> add<span class="o">=</span><span class="k-Variable">T</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;orange&quot;</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">4</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-13_1.png" alt="" /></p>

<p>この図は，横軸に気温（華氏），縦軸にOリングの破損の有無をプロットしたものである．また，glm()関数で推定したロジスティック曲線をオレンジ色で示しており，任意の気温における破損する確率と対応している．この図を見ると，華氏65前後で破損確率が50%となり，気温が高い場合は破損確率が低く，逆に気温が低い時には破損確率が高いことがわかる．</p>

<p>glm()関数のパラメータ推定の詳細は以下の通り．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="o">&gt;</span> summary<span class="p">(</span>fit<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>Call:
</span><span class='line'>glm<span class="p">(</span>formula <span class="o">=</span> oring ~ temp<span class="p">,</span> family <span class="o">=</span> binomial<span class="p">,</span> data <span class="o">=</span> challenger<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>Deviance Residuals:
</span><span class='line'>    Min       <span class="m">1</span>Q   Median       <span class="m">3</span>Q      Max
</span><span class='line'><span class="m">-1.0611</span>  <span class="m">-0.7613</span>  <span class="m">-0.3783</span>   <span class="m">0.4524</span>   <span class="m">2.2175</span>
</span><span class='line'>
</span><span class='line'>Coefficients:
</span><span class='line'>            Estimate Std. Error z value Pr<span class="p">(</span><span class="o">&gt;|</span>z<span class="o">|</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span>Intercept<span class="p">)</span>  <span class="m">15.0429</span>     <span class="m">7.3786</span>   <span class="m">2.039</span>   <span class="m">0.0415</span> <span class="o">*</span>
</span><span class='line'>temp         <span class="m">-0.2322</span>     <span class="m">0.1082</span>  <span class="m">-2.145</span>   <span class="m">0.0320</span> <span class="o">*</span>
</span><span class='line'><span class="o">---</span>
</span><span class='line'>Signif. codes:  <span class="m">0</span> ‘<span class="o">***</span>’ <span class="m">0.001</span> ‘<span class="o">**</span>’ <span class="m">0.01</span> ‘<span class="o">*</span>’ <span class="m">0.05</span> ‘<span class="m">.</span>’ <span class="m">0.1</span> ‘ ’ <span class="m">1</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span>Dispersion parameter for binomial family taken to be <span class="m">1</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    Null deviance: <span class="m">28.267</span>  on <span class="m">22</span>  degrees of freedom
</span><span class='line'>Residual deviance: <span class="m">20.315</span>  on <span class="m">21</span>  degrees of freedom
</span><span class='line'>AIC: <span class="m">24.315</span>
</span><span class='line'>
</span><span class='line'>Number of Fisher Scoring iterations: <span class="m">5</span>
</span></code></pre></td></tr></table></div></figure>


<h4>b. ロジスティック回帰で推定したパラメータの値を用いて，メトロポリス・ヘイスティング・アルゴリズムでサンプリングを行う</h4>

<p>これは<a href="http://yagays.github.com/blog/2012/11/25/imcmr-6-3/">前回</a>と殆ど変わらず．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>y <span class="o">&lt;-</span> challenger<span class="p">$</span>oring
</span><span class='line'>x <span class="o">&lt;-</span> challenger<span class="p">$</span>temp
</span><span class='line'>
</span><span class='line'>loglik <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>a<span class="p">,</span>b<span class="p">){</span>sum<span class="p">(</span>y<span class="o">*</span><span class="p">(</span>a<span class="o">+</span>b<span class="o">*</span>x<span class="p">)</span> <span class="o">-</span> log<span class="p">(</span><span class="m">1</span><span class="o">+</span>exp<span class="p">(</span>a<span class="o">+</span>b<span class="o">*</span>x<span class="p">)))}</span>
</span><span class='line'>logq <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>a<span class="p">,</span>b<span class="p">){</span>
</span><span class='line'>  dnorm<span class="p">(</span>a<span class="p">,</span>mean<span class="o">=</span>a.est<span class="p">[</span><span class="m">1</span><span class="p">],</span>sd<span class="o">=</span>a.std<span class="p">,</span>log<span class="o">=</span><span class="k-Variable">T</span><span class="p">)</span>
</span><span class='line'>  <span class="o">+</span> dnorm<span class="p">(</span>b<span class="p">,</span>mean<span class="o">=</span>b.est<span class="p">[</span><span class="m">1</span><span class="p">],</span>sd<span class="o">=</span>b.std<span class="p">,</span>log<span class="o">=</span><span class="k-Variable">T</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>Niter <span class="o">&lt;-</span> <span class="m">5000</span>
</span><span class='line'>n <span class="o">&lt;-</span> length<span class="p">(</span>challenger<span class="p">$</span>temp<span class="p">)</span>
</span><span class='line'>fit.param <span class="o">&lt;-</span> summary<span class="p">(</span>fit<span class="p">)$</span>coef
</span><span class='line'>a.est <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>a.std <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">]</span>
</span><span class='line'>b.est <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>b.std <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kr">for</span><span class="p">(</span>i in <span class="m">2</span>:Niter<span class="p">){</span>
</span><span class='line'>  candidate <span class="o">&lt;-</span> c<span class="p">(</span>rnorm<span class="p">(</span><span class="m">1</span><span class="p">,</span> mean<span class="o">=</span>a.est<span class="p">[</span><span class="m">1</span><span class="p">],</span> sd<span class="o">=</span>a.std<span class="p">),</span> rnorm<span class="p">(</span><span class="m">1</span><span class="p">,</span> mean<span class="o">=</span>b.est<span class="p">[</span><span class="m">1</span><span class="p">],</span> sd<span class="o">=</span>b.std<span class="p">))</span>
</span><span class='line'>  fy <span class="o">&lt;-</span> loglik<span class="p">(</span>candidate<span class="p">[</span><span class="m">1</span><span class="p">],</span> candidate<span class="p">[</span><span class="m">2</span><span class="p">])</span>
</span><span class='line'>  fx <span class="o">&lt;-</span> loglik<span class="p">(</span>a.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">],</span> b.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">])</span>
</span><span class='line'>  qxy <span class="o">&lt;-</span> logq<span class="p">(</span>a.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">],</span> b.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">])</span>
</span><span class='line'>  qyx <span class="o">&lt;-</span> logq<span class="p">(</span>candidate<span class="p">[</span><span class="m">1</span><span class="p">],</span> candidate<span class="p">[</span><span class="m">2</span><span class="p">])</span>
</span><span class='line'>  rho <span class="o">&lt;-</span> min<span class="p">(</span><span class="m">1</span><span class="p">,</span> exp<span class="p">(</span>fy<span class="o">-</span>fx<span class="o">+</span>qxy<span class="o">-</span>qyx<span class="p">))</span>
</span><span class='line'>
</span><span class='line'>  <span class="kr">if</span> <span class="p">(</span>runif<span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">&lt;</span>rho<span class="p">){</span>
</span><span class='line'>    a.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> candidate<span class="p">[</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>    b.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> candidate<span class="p">[</span><span class="m">2</span><span class="p">]</span>
</span><span class='line'>  <span class="p">}</span>else<span class="p">{</span>
</span><span class='line'>    a.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> a.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>    b.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> b.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>plot<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;temp&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;oring&quot;</span><span class="p">,</span> type<span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</span><span class='line'><span class="kr">for</span><span class="p">(</span>i in <span class="p">(</span>Niter<span class="o">-</span><span class="m">500</span><span class="p">)</span>:Niter<span class="p">){</span>
</span><span class='line'>  lines<span class="p">(</span>x<span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="p">(</span><span class="m">1</span><span class="o">+</span>exp<span class="p">(</span><span class="o">-</span><span class="p">(</span>a.est<span class="p">[</span>i<span class="p">]</span><span class="o">+</span>b.est<span class="p">[</span>i<span class="p">]</span><span class="o">*</span>x<span class="p">))),</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;grey&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>curve<span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="p">(</span><span class="m">1</span><span class="o">+</span>exp<span class="p">(</span><span class="o">-</span><span class="p">(</span>fit<span class="p">$</span>coef<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">+</span>fit<span class="p">$</span>coef<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span>x<span class="p">))),</span> from<span class="o">=</span><span class="m">53</span><span class="p">,</span> to<span class="o">=</span><span class="m">81</span><span class="p">,</span> add<span class="o">=</span><span class="k-Variable">T</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;orange&quot;</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">4</span><span class="p">)</span>
</span><span class='line'>points<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> pch<span class="o">=</span><span class="m">19</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h4>c. 5000回のマルコフ連鎖によるサンプル列を生成し，サンプリングで得られた推定値を使ったロジスティック曲線を図示する</h4>

<p>実際に上で書いたコードを動かして，事後分布からのサンプリングを行い，得られたサンプルのうち4500回から5000回までの反復で生成した当てはめ曲線を灰色の曲線で表している．</p>

<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-13_2.png" alt="" /></p>

<p>また，パラメータ<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Calpha+" alt="\alpha " />と<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbeta+" alt="\beta " />の系列の変動，自己相関プロット，系列の分布を以下の図で示している．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>par<span class="p">(</span>mfrow<span class="o">=</span>c<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
</span><span class='line'>plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> a.est<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iterations&quot;</span><span class="p">,</span> main<span class="o">=</span>expression<span class="p">(</span>alpha<span class="p">))</span>
</span><span class='line'>acf<span class="p">(</span>a.est<span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span>density<span class="p">(</span>a.est<span class="p">))</span>
</span><span class='line'>plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> b.est<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iterations&quot;</span><span class="p">,</span> main<span class="o">=</span>expression<span class="p">(</span>beta<span class="p">))</span>
</span><span class='line'>acf<span class="p">(</span>b.est<span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span>density<span class="p">(</span>b.est<span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-13_3.png" alt="" /></p>

<p>そして最後に，サンプリング推定値差の変動を示したのが以下の図である．glm()関数で推定した値を赤線で表示しており，そこからどれだけ離れているかを見ることができる．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> apply<span class="p">(</span>cbind<span class="p">(</span>a.est<span class="p">,</span>b.est<span class="p">),</span><span class="m">1</span><span class="p">,</span><span class="kr">function</span><span class="p">(</span>x<span class="p">){</span>loglik<span class="p">(</span>x<span class="p">[</span><span class="m">1</span><span class="p">],</span>x<span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="o">+</span>logq<span class="p">(</span>x<span class="p">[</span><span class="m">1</span><span class="p">],</span>x<span class="p">[</span><span class="m">2</span><span class="p">])}),</span>
</span><span class='line'>     type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iteration&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>abline<span class="p">(</span>h<span class="o">=</span><span class="p">(</span>loglik<span class="p">(</span>fit.param<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">],</span>fit.param<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">])</span><span class="o">+</span>logq<span class="p">(</span>fit.param<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">],</span>fit.param<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">])),</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-13_4.png" alt="" /></p>

<h4>d. サンプリングで得られたパラメータの分布から，華氏60,50,40度のときの故障の確率と標準誤差を推定する</h4>

<p>サンプリングで得られた値を用いて，ある温度における故障の確率と標準誤差を求める．なお，今回はBurn-inによる推定値の切り捨てを行なっておらず，サンプリング回数5000回で得られた推定値を全て使っている．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="kr">for</span><span class="p">(</span>t in c<span class="p">(</span><span class="m">60</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">40</span><span class="p">)){</span>
</span><span class='line'>  p <span class="o">&lt;-</span> <span class="m">1</span><span class="o">/</span><span class="p">(</span><span class="m">1</span><span class="o">+</span>exp<span class="p">(</span><span class="o">-</span><span class="p">(</span>a.est<span class="o">+</span>b.est<span class="o">*</span>t<span class="p">)))</span>
</span><span class='line'>  print<span class="p">(</span>paste<span class="p">(</span><span class="s">&quot;temp:&quot;</span><span class="p">,</span> t<span class="p">,</span> <span class="s">&quot;=&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;mean=&quot;</span><span class="p">,</span> round<span class="p">(</span>mean<span class="p">(</span>p<span class="p">),</span>digit<span class="o">=</span><span class="m">4</span><span class="p">),</span> <span class="s">&quot;, S.D.=&quot;</span><span class="p">,</span> round<span class="p">(</span>sd<span class="p">(</span>p<span class="p">),</span>digit<span class="o">=</span><span class="m">4</span><span class="p">)</span> <span class="p">))</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;temp: 60 =&gt; mean= 0.7476 , S.D.= 0.1282&quot;</span>
</span><span class='line'><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;temp: 50 =&gt; mean= 0.9525 , S.D.= 0.0641&quot;</span>
</span><span class='line'><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;temp: 40 =&gt; mean= 0.9895 , S.D.= 0.0248&quot;</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「Rによる医療統計学」はRの使い方と統計解析の基礎が学べる良書（ただし入手困難）]]></title>
    <link href="http://yagays.github.com/blog/2012/11/29/review-introductory-statistics-with-r/"/>
    <updated>2012-11-29T06:18:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/11/29/review-introductory-statistics-with-r</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4621078119" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>一般化線形モデルやロジスティックモデルなどの基本的な線形回帰を復習するために，久しぶりに本書を引っ張りだしてきてひと通り読み返した．自分としては理論や基本的な部分はある程度抑えているつもりだったけれども，検定であったり上手く回帰をするためのデータの条件であったりといった細かな部分に関しては，まだまだ不勉強なところが多い．とにかくデータに対して回帰をかけてこれで良しみたいな部分があったので，そういった部分を補うという意味でも良い復習になった．最近はMCMCにもっぱら専念しているが，基礎であったり古典の部分もしっかり抑えておかなければ…．</p>

<p>タイトルに「医療統計学」と難しそうな名前が付いている本書だが，原書のタイトルが&#8221;Introductory statistics with R&#8221;であるように，実質的には統計解析ソフトRの入門書である．例題で扱う題材として医療統計のデータが使われているだけで，内容自体に医療分野の専門性は無い．本書前半では，基本的なRの使い方とともに統計解析の基礎が説明され，後半になると，線形回帰や重回帰分析，ロジスティック回帰，生存分析などの具体的な解析手法が紹介される．全体を通して，サンプルデータを用いた豊富な解析実例とRのコード例がセットになっているため，必要ならば解析を再現することも可能である．そのため，Rを勉強するのも良し，解析手法を勉強するも良しと，初心者から中級者にかけての読者向けの非常にバランスの取れた構成となっている．また，理論よりも実戦向きの内容となっており，検定方法やモデル選択の比重が大きいのが本書の特徴でもある．そういえば，私がRを触り始めた頃は「<a href="http://www.amazon.co.jp/gp/product/4274067831/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=4274067831&linkCode=as2&tag=yagays-22">The R Tips―データ解析環境Rの基本技・グラフィックス活用集</a><img src="http://www.assoc-amazon.jp/e/ir?t=yagays-22&l=as2&o=9&a=4274067831" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />」がまさにバイブルといった感じだったが，プログラミングとしてのRの解説がメインで統計解析の流れを説明した具体例は少なく，実用的な部分は本書をよく参照していた記憶がある．</p>

<p>ということで本書はR本の中でも結構オススメできる部類なのだが，どうやら<a href="http://www.amazon.co.jp/gp/product/4621078119/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=4621078119&linkCode=as2&tag=yagays-22">Amazon</a><img src="http://www.assoc-amazon.jp/e/ir?t=yagays-22&l=as2&o=9&a=4621078119" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />や<a href="http://pub.maruzen.co.jp/book_magazine/book_data/search/9784621078112.html">丸善の公式ページ</a>，<a href="http://www.junkudo.co.jp/detail.jsp?ISBN=9784621078112">丸善&amp;ジュンク堂のネットストア</a>などの主だったネット書店で品切れが相次いでいるようだ．ともなると，本書を手に入れるにはAmazonのマーケットプレイスで高い値段で買うか，大きな書店で売れ残っている本を見つけるかするしか無さそうだ．まあ今となってはRと統計に関する書籍は山ほど出版されているので，本書がこれから増刷などが掛かることは難しかもしれないが，このまま絶版になっていくには実に惜しい本だと思う．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「やっかいな放射線と向き合って暮らしていくための基礎知識 」読了]]></title>
    <link href="http://yagays.github.com/blog/2012/11/28/review-radbookbasic/"/>
    <updated>2012-11-28T00:12:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/11/28/review-radbookbasic</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4255006768" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>本書の元となった文章のことは前々から知っていたし，pdfファイルもPCにダウンロードしていたのだけれども，結局その文章を読むことはなかった．書店で本書が並んでいるのを見た時に「関心があるだけフリをしているだけではダメだ」と思って本書を購入し，まとまった時間を作って一気に読んだ．</p>

<p>本書はタイトルの通り，原発事故後の日本に暮らす私達が放射線とどう付き合っていけばよいかについて，科学的な知見を紹介する内容となっている．本の中で説明されるのは，放射線の基礎的な性質や放射線が生物にどのように影響を与えるのかといった仕組み，そして国際的に認められた機関が放射線と人間の関係においてどのような基準を作っているのかといった，あくまで判断材料としての基礎的な情報だ．そのため，今の生活が安心なのかそれとも危険なのかといった結論は，直接的には書かれていない．あくまで判断をするのは私達自身だという前提のもとで，できるだけ専門性は排除して初学者にも分かりやすい形で本書は構成されている．</p>

<p>本書を書かれた田崎晴明氏は，個人的には統計力学の先生というイメージが強い．分野が違うのに何故と最初は思っていたのだが，本書を読むにつれ，田崎氏の科学者として正しい情報を普及させたいという真摯な態度が伝わってきて，その理由が納得できた．非専門家でありながらも，放射線の説明は見事としか言いようがない．問題の本質をしっかりと捉え，噛み砕いた形でありながらも正確さを損なっていない．特に，放射線は化学反応とは別の次元の物理現象なのだという前提は，まさに放射線を取り巻く全ての問題のを理解する上で知っておくべき一番重要なことだろう．他にも，不正確な情報の中からいかに上限を見積もって判断材料にするかといったことも述べられており，科学的な考え方のエッセンスが詰まっている．そういった面でも非常に参考になる本であり，啓蒙書としての見本となるような文章だと感じた．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「Rによるモンテカルロ法入門」読書ノート：6章 ランダム・ウォーク・メトロポリス・ヘイスティング・アルゴリズム]]></title>
    <link href="http://yagays.github.com/blog/2012/11/27/imcmr-6-4/"/>
    <updated>2012-11-27T06:18:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/11/27/imcmr-6-4</id>
    <content type="html"><![CDATA[<ul>
<li>読書ノート アーカイブ：<a href="http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/">http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/</a></li>
</ul>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4621065270" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<h3>例 6.4 ランダム・ウォークのパラメータ設定によるサンプリングへの影響を，正規分布の乱数生成を例に確かめる</h3>

<p>摂動が<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cvarepsilon_t+%5Csim+%5Cmathcal%7BU%7D_%7B%5B-%5Cdelta%2C%5Cdelta%5D%7D+" alt="\varepsilon_t \sim \mathcal{U}_{[-\delta,\delta]} " />となるようなランダム・ウォークにおいて，正規分布<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BN%7D%280%2C1%29+" alt="\mathcal{N}(0,1) " />をサンプリングするときのメトロポリス・ヘイスティング・アルゴリズムの受理確率は</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho%28x%5E%7B%28t%29%7D%2Cy_t%29+%3D+%5Cmin+%5Cbig%5B1%2C+%5Cexp%5C%7B%5Cfrac%7Bx%5E%7B%28t%292%7D-y_t%5E2%7D%7B2%7D+%5C%7D+%5Cbig%5D+" alt="\rho(x^{(t)},y_t) = \min \big[1, \exp{\frac{x^{(t)2}-y_t^2}{2} } \big] " /></p>

<p>で表される．</p>

<p>今回は，一様候補のパラメータを<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cdelta+%3D+0.1%2C+1%2C+10+" alt="\delta = 0.1, 1, 10 " />と変更して，メトロポリス・ヘイスティング・アルゴリズムによるローカルな探索がどういう挙動を示すのかを調べる．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>par<span class="p">(</span>mfcol<span class="o">=</span>c<span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
</span><span class='line'><span class="kr">for</span><span class="p">(</span>d in c<span class="p">(</span><span class="m">0.1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">)){</span>
</span><span class='line'>  Niter <span class="o">&lt;-</span> <span class="m">2500</span>
</span><span class='line'>  x <span class="o">&lt;-</span> <span class="m">0</span>
</span><span class='line'>  <span class="kr">for</span><span class="p">(</span>i in <span class="m">2</span>:Niter<span class="p">){</span>
</span><span class='line'>    y <span class="o">&lt;-</span> x<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span> <span class="o">+</span> runif<span class="p">(</span><span class="m">1</span><span class="p">,</span> min<span class="o">=-</span>d<span class="p">,</span> max<span class="o">=</span>d<span class="p">)</span>
</span><span class='line'>    <span class="kr">if</span> <span class="p">(</span>runif<span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="o">&lt;</span> min<span class="p">(</span><span class="m">1</span><span class="p">,</span> exp<span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>y<span class="o">^</span><span class="m">2</span> <span class="o">-</span> x<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span><span class="o">^</span><span class="m">2</span><span class="p">))</span> <span class="p">)){</span>
</span><span class='line'>      x<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> y
</span><span class='line'>    <span class="p">}</span>else<span class="p">{</span>
</span><span class='line'>      x<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> x<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> x<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iterations&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>main<span class="o">=</span>paste<span class="p">(</span><span class="s">&quot;d = &quot;</span><span class="p">,</span>d<span class="p">))</span>
</span><span class='line'>  hist<span class="p">(</span>x<span class="p">,</span> nclass<span class="o">=</span><span class="m">150</span><span class="p">,</span> freq<span class="o">=</span><span class="k-Variable">F</span><span class="p">,</span> xlim<span class="o">=</span>c<span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> main<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>  curve<span class="p">(</span>dnorm<span class="p">(</span>x<span class="p">),</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span> add<span class="o">=</span><span class="k-Variable">T</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</span><span class='line'>  acf<span class="p">(</span>x<span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>それぞれのパラメータにおける系列の変動，分布，自己相関プロットを示したのが以下の図である．それぞれのサンプリング結果を見比べてみると，</p>

<ul>
<li>一様候補のパラメータが小さい場合（<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cdelta+%3D+0.1+" alt="\delta = 0.1 " />）

<ul>
<li>ランダム・ウォークで移動する幅が狭い</li>
<li>分布が偏っている</li>
<li>自己相関が高い（前の値からあまり変わらない）</li>
</ul>
</li>
<li>一様候補のパラメータが大きい場合（<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cdelta+%3D+10+" alt="\delta = 10 " />）

<ul>
<li>ランダム・ウォークで移動する幅が大きい</li>
<li>これも同様に分布が安定しない</li>
</ul>
</li>
</ul>


<p>という結果となり，ランダム・ウォーク・メトロポリス・ヘイスティング・アルゴリズムにおいては摂動（<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cvarepsilon_t+" alt="\varepsilon_t " />）のパラメータ設定が重要であることがわかる．</p>

<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-4.png" alt="" /></p>

<h3>例 6.10 ランダム・ウォーク・メトロポリス・ヘイスティング・アルゴリズムの受理率を調べる</h3>

<p>メトロポリス・ヘイスティング・アルゴリズムにおけるアルゴリズム効率化の調整は，本書の2章で扱った受理・棄却アルゴリズムの時の最大受理率に基づいた調整の場合とは異なる．まず，上の例 6.4で示した正規分布からのサンプリングにおける受理率を見てみる．パラメータごとの受理率は以下のようになった（Rのコードは省略）．</p>

<ul>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cdelta+%3D+0.1+" alt="\delta = 0.1 " />：<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=r+%3D+0.9792+" alt="r = 0.9792 " /></li>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cdelta+%3D+1+" alt="\delta = 1 " />：<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=r+%3D+0.8132+" alt="r = 0.8132 " /></li>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cdelta+%3D+10+" alt="\delta = 10 " />：<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=r+%3D+0.1716+" alt="r = 0.1716 " /></li>
</ul>


<p>この結果から，受理率が高ければサンプリングの結果も良くなるわけではないことがわかる．このことから，ランダム・ウォーク・メトロポリス・ヘイスティング・アルゴリズムにおいては，受理率を高めるようにアルゴリズムを調節してはいけないと判断できる．このアルゴリズムにおいて，どのような受理率を取ればよいかといった疑問に関しては，以下の練習問題6.14のc.で詳しく見ていく．</p>

<br />


<h3>練習問題 6.14 ランダム・ウォーク候補がサンプリング結果に与える影響について，複数の候補分布を用いてより詳細に調べる</h3>

<h4>a. P.205の図6.7を再現する</h4>

<p>図6.7の再現と<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cdelta+" alt="\delta " />の解釈は，上の例6.4の解答を参考．</p>

<h4>b. コーシー候補とラプラス候補を検討する</h4>

<p>今度は，一様分布の代わりにコーシー分布やラプラス分布を候補分布として使った場合の，ランダム・ウォーク・メトロポリス・ヘイスティング・アルゴリズムの挙動を調べる．</p>

<h4>コーシー候補</h4>

<p>ランダム・ウォーク候補は<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cvarepsilon_t+%5Csim+%5Cmathcal%7BC%7D%28x_0%2C%5Cgamma%29+" alt="\varepsilon_t \sim \mathcal{C}(x_0,\gamma) " />とし，コーシー分布のパラメータは<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=x_0+%3D+0+" alt="x_0 = 0 " />，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cgamma+%3D+0.01%2C%5C+1%2C%5C+10+" alt="\gamma = 0.01,\ 1,\ 10 " />を考える．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># Cauchy candidate</span>
</span><span class='line'>par<span class="p">(</span>mfcol<span class="o">=</span>c<span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
</span><span class='line'><span class="kr">for</span><span class="p">(</span>g in c<span class="p">(</span><span class="m">0.01</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">)){</span>
</span><span class='line'>  Niter <span class="o">&lt;-</span> <span class="m">2500</span>
</span><span class='line'>  x <span class="o">&lt;-</span> <span class="m">0</span>
</span><span class='line'>  <span class="kr">for</span><span class="p">(</span>i in <span class="m">2</span>:Niter<span class="p">){</span>
</span><span class='line'>    y <span class="o">&lt;-</span> x<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span> <span class="o">+</span> rcauchy<span class="p">(</span><span class="m">1</span><span class="p">,</span> location<span class="o">=</span><span class="m">0</span><span class="p">,</span> scale<span class="o">=</span>g<span class="p">)</span>
</span><span class='line'>    <span class="kr">if</span> <span class="p">(</span>runif<span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="o">&lt;</span> min<span class="p">(</span><span class="m">1</span><span class="p">,</span> exp<span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>y<span class="o">^</span><span class="m">2</span> <span class="o">-</span> x<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span><span class="o">^</span><span class="m">2</span><span class="p">))</span> <span class="p">)){</span>
</span><span class='line'>      x<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> y
</span><span class='line'>    <span class="p">}</span>else<span class="p">{</span>
</span><span class='line'>      x<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> x<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> x<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iterations&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>main<span class="o">=</span>paste<span class="p">(</span><span class="s">&quot;Cauchy candidate,&quot;</span><span class="p">,</span><span class="s">&quot;gamma=&quot;</span><span class="p">,</span>g<span class="p">))</span>
</span><span class='line'>  hist<span class="p">(</span>x<span class="p">,</span> nclass<span class="o">=</span><span class="m">150</span><span class="p">,</span> freq<span class="o">=</span><span class="k-Variable">F</span><span class="p">,</span> xlim<span class="o">=</span>c<span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> main<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>  curve<span class="p">(</span>dnorm<span class="p">(</span>x<span class="p">),</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span> add<span class="o">=</span><span class="k-Variable">T</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</span><span class='line'>  acf<span class="p">(</span>x<span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-14_1.png" alt="" /></p>

<h4>ラプラス候補</h4>

<p>ランダム・ウォーク候補は<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cvarepsilon_t+%5Csim+%5Cmathcal%7BL%7D%28%5Cmu%2Cb%29+" alt="\varepsilon_t \sim \mathcal{L}(\mu,b) " />とし，ラプラス分布のパラメータは<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmu%3D0+" alt="\mu=0 " />，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=b+%3D+0.1%2C%5C+1%2C%5C+10+" alt="b = 0.1,\ 1,\ 10 " />を考える．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># Laplace candidate</span>
</span><span class='line'>par<span class="p">(</span>mfcol<span class="o">=</span>c<span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
</span><span class='line'><span class="kr">for</span><span class="p">(</span>a in c<span class="p">(</span><span class="m">0.1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">10</span><span class="p">)){</span>
</span><span class='line'>  Niter <span class="o">&lt;-</span> <span class="m">2500</span>
</span><span class='line'>  x <span class="o">&lt;-</span> <span class="m">0</span>
</span><span class='line'>  <span class="kr">for</span><span class="p">(</span>i in <span class="m">2</span>:Niter<span class="p">){</span>
</span><span class='line'>    y <span class="o">&lt;-</span> x<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span> <span class="o">+</span> ifelse<span class="p">(</span>runif<span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">&gt;</span><span class="m">0.5</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">-1</span><span class="p">)</span><span class="o">*</span>rexp<span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">/</span>a
</span><span class='line'>    <span class="kr">if</span> <span class="p">(</span>runif<span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="o">&lt;</span> min<span class="p">(</span><span class="m">1</span><span class="p">,</span> exp<span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span>y<span class="o">^</span><span class="m">2</span> <span class="o">-</span> x<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span><span class="o">^</span><span class="m">2</span><span class="p">))</span> <span class="p">)){</span>
</span><span class='line'>      x<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> y
</span><span class='line'>    <span class="p">}</span>else<span class="p">{</span>
</span><span class='line'>      x<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> x<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> x<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iterations&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>main<span class="o">=</span>paste<span class="p">(</span><span class="s">&quot;Laplace candidate,&quot;</span><span class="p">,</span><span class="s">&quot;b=&quot;</span><span class="p">,</span>a<span class="p">))</span>
</span><span class='line'>  hist<span class="p">(</span>x<span class="p">,</span> nclass<span class="o">=</span><span class="m">150</span><span class="p">,</span> freq<span class="o">=</span><span class="k-Variable">F</span><span class="p">,</span> xlim<span class="o">=</span>c<span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> main<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>  curve<span class="p">(</span>dnorm<span class="p">(</span>x<span class="p">),</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span> add<span class="o">=</span><span class="k-Variable">T</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</span><span class='line'>  acf<span class="p">(</span>x<span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-14_2.png" alt="" /></p>

<p>以上の結果から，コーシー候補やラプラス候補においても，ランダム・ウォークの値の取り方によって適切なサンプリングができるかどうかが決まってくることがわかる．また，どちらも自己相関が低い値の時にサンプリング結果が一番良いことが見て取れる．これは例6.4の一様候補の場合とは違う結果となったが，恐らくコーシー分布やラプラス分布はともに一峰型の正規分布のような形であることが効いていて，ランダム・ウォークの移動が適度に調節されているからだろう．</p>

<h4>c. パラメータの調節により受理確率を0.25に近づける</h4>

<p>さて，例6.10で述べたように，ランダム・ウォークを使ったメトロポリス・ヘイスティング・アルゴリズムにおいては，受理率の最大化がアルゴリズムの効率化に繋がらないことがわかった．受理率はどれくらいを目安にすればよいかという疑問に関しては，本書では「高次元では0.25，低次元では0.5程度」というRoberts et al.(2007)の提案を引用している．そこで，先ほどの3つのランダム・ウォーク候補について受理率を0.25に近づけるために，パラメータの値を0から10まで0.1刻みで設定したときの，一様候補・コーシー候補・ラプラス候補を用いたアルゴリズムにおける受理率の変化を以下の図でプロットした．</p>

<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-14_3.png" alt="" /></p>

<p>赤の点線は受理率0.25を表している．この図を見ると，一様候補とコーシー候補はパラメータの値が大きくなるにつれて受理率も小さくなり，逆にラプラス候補の場合ではパラメータの値が大きくなるにつれて受理率は大きくなることがわかる．いずれの場合においても，受理率を0.25に近づけることは可能である．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mac OS XでJAGS＆rjagsパッケージを動かす]]></title>
    <link href="http://yagays.github.com/blog/2012/11/26/rjags-on-mac-os-x/"/>
    <updated>2012-11-26T07:18:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/11/26/rjags-on-mac-os-x</id>
    <content type="html"><![CDATA[<h3>MacPortsでJAGSを入れる場合はちょっと注意</h3>

<p>MacでJAGSをインストールする場合，</p>

<ul>
<li><a href="http://sourceforge.net/projects/mcmc-jags/">SourceForge</a>からパッケージをダウンロードしてインストールする方法</li>
<li><a href="https://trac.macports.org/browser/trunk/dports/science/jags/Portfile">MacPorts</a>を使ってインストールする方法</li>
</ul>


<p>の2通りがある．どちらで入れてもJAGS自体に違いはないのだが，Rのrjagsパッケージをインストールする際に少し注意しなければいけないポイントがある．1つ目の方法でパッケージからインストールした場合だと，いつも通りに</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># パッケージからインストールした場合</span>
</span><span class='line'><span class="o">&gt;</span> install.packages<span class="p">(</span><span class="s">&quot;rjags&quot;</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;</span> library<span class="p">(</span>rjags<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>とすれば良いのだが，MacPortsでインストールした場合では，</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># MacPortsからインストールした場合</span>
</span><span class='line'><span class="o">&gt;</span> install.packages<span class="p">(</span><span class="s">&quot;rjags&quot;</span><span class="p">,</span> type<span class="o">=</span><span class="s">&quot;source&quot;</span><span class="p">,</span> configure.args <span class="o">=</span> <span class="s">&#39;--with-jags-lib=/opt/local/lib --with-jags-include=/opt/local/include/JAGS --with-jags-modules=/opt/local/lib/JAGS/modules-3&#39;</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;</span> library<span class="p">(</span>rjags<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>のように，パッケージのインストールの際に色々とオプションを付ける必要がある．というのも，パッケージからインストールした場合では/usr/local/以下にインストールされるのに対し，MacPortsからインストールした場合では/opt/local/以下にインストールされるからだ．Rでrjagsパッケージをインストールする際には，どうやら/usr/local/以下のモジュールや共有ライブラリを参照するようなので，MacPortsで入れた場合にはそもそもディレクトリが違うためファイルが見つからないといったエラーが出る．</p>

<h3>他の解決方法</h3>

<p>ちなみに，/usr/local/lib以下にシンボリックリンクを貼って強引に解決する方法もある．自分は最初こちらで対処していたのだが，長期的に考えた場合にJAGSのバージョンアップによってdylibの名前が変わる可能性などもあるので，上のようにパッケージのインストールの段階で対処する方が良いだろう．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">cd</span> /usr/local/lib
</span><span class='line'><span class="nv">$ </span>sudo ln -s /opt/local/lib/libjags.3.dylib .
</span><span class='line'><span class="nv">$ </span>sudo ln -s /opt/local/lib/JAGS .
</span></code></pre></td></tr></table></div></figure>


<h3>参考：MacPortsの場合でinstall.package(&#8220;rjags&#8221;)で入れてしまったときのrjags読み込み時のエラー</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="o">&gt;</span> library<span class="p">(</span>rjags<span class="p">)</span>
</span><span class='line'> 要求されたパッケージ coda をロード中です
</span><span class='line'> 要求されたパッケージ lattice をロード中です
</span><span class='line'>Error :  <span class="m">.</span>onLoadはloadNamespace<span class="p">()</span>（rjagsに対する）の中で失敗しました、詳細は:
</span><span class='line'> call: dyn.load<span class="p">(</span>file<span class="p">,</span> DLLpath <span class="o">=</span> DLLpath<span class="p">,</span> <span class="m">...</span><span class="p">)</span>
</span><span class='line'> error:  共有ライブラリ <span class="s">&#39;/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rjags/libs/x86_64/rjags.so&#39;</span> を読み込めません：
</span><span class='line'>  dlopen<span class="p">(</span><span class="o">/</span>Library<span class="o">/</span>Frameworks<span class="o">/</span>R.framework<span class="o">/</span>Versions<span class="o">/</span><span class="m">2.15</span><span class="o">/</span>Resources<span class="o">/</span>library<span class="o">/</span>rjags<span class="o">/</span>libs<span class="o">/</span>x86_64<span class="o">/</span>rjags.so<span class="p">,</span> <span class="m">10</span><span class="p">)</span>: Library not loaded: <span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>lib<span class="o">/</span>libjags.3.dylib
</span><span class='line'>  Referenced from: <span class="o">/</span>Library<span class="o">/</span>Frameworks<span class="o">/</span>R.framework<span class="o">/</span>Versions<span class="o">/</span><span class="m">2.15</span><span class="o">/</span>Resources<span class="o">/</span>library<span class="o">/</span>rjags<span class="o">/</span>libs<span class="o">/</span>x86_64<span class="o">/</span>rjags.so
</span><span class='line'>  Reason: image not found
</span><span class='line'> エラー：  <span class="s">&#39;‘rjags’&#39;</span> に対するパッケージもしくは名前空間のロードが失敗しました
</span></code></pre></td></tr></table></div></figure>


<h3>実行環境</h3>

<ul>
<li>Mac OS X 10.8.2</li>
<li>R version 2.15.1</li>
<li>JAGS 3.3.0</li>
<li>rjags version 3-7</li>
</ul>


<h3>参考</h3>

<ul>
<li><a href="http://mcmc-jags.sourceforge.net/">JAGS - Just Another Gibbs Sampler</a></li>
<li><a href="http://cran.r-project.org/web/packages/rjags/index.html">CRAN - Package rjags</a></li>
<li><a href="http://eity.que.jp/pukiwiki/index.php?BUGS">Eity&#8217;s Web - BUGS</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「Rによるモンテカルロ法入門」読書ノート：6章 メトロポリス・ヘイスティング・アルゴリズム その2]]></title>
    <link href="http://yagays.github.com/blog/2012/11/25/imcmr-6-3/"/>
    <updated>2012-11-25T01:28:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/11/25/imcmr-6-3</id>
    <content type="html"><![CDATA[<ul>
<li>読書ノート アーカイブ：<a href="http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/">http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/</a></li>
</ul>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4621065270" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<h3>例 6.3 二次モデルの線形回帰におけるパラメータの事後分布から，メトロポリス・ヘイスティング・アルゴリズムを用いてサンプリングする</h3>

<p>この例題では，carsのデータセットにおいて線形回帰による二次曲線のあてはめをおこない，最尤法で推定したパラメータによる事後分布から複数のサンプリングを行うことを目標にする．今回使用するデータセットは車の速度とその時の制動距離に関するデータで，Rの入門書でよく例に使われるものである．carsのデータセットに関するHelpのExampleには，本問題と似たようなプロットを描写するコード例が載っている．</p>

<p>この問題では，車のスピード<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=x+" alt="x " />と制動距離<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=y+" alt="y " />の関係について，以下式で表される二次モデルで線形回帰をおこなう．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=y_%7Bij%7D%3Da%2Bbx_i%2Bcx_i%5E2%2B%5Cvarepsilon_%7Bij%7D+" alt="y_{ij}=a+bx_i+cx_i^2+\varepsilon_{ij} " /></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>data<span class="p">(</span>cars<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>y <span class="o">&lt;-</span> cars<span class="p">$</span>dist
</span><span class='line'>x <span class="o">&lt;-</span> cars<span class="p">$</span>speed
</span><span class='line'>x2 <span class="o">&lt;-</span> x<span class="o">^</span><span class="m">2</span>
</span><span class='line'>fit <span class="o">&lt;-</span> lm<span class="p">(</span>y ~ x <span class="o">+</span> x2<span class="p">)</span>
</span><span class='line'>s <span class="o">&lt;-</span> seq<span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">25</span><span class="p">,</span>by<span class="o">=</span><span class="m">0.1</span><span class="p">)</span>
</span><span class='line'>yhat <span class="o">&lt;-</span> fit<span class="p">$</span>coef<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">+</span> fit<span class="p">$</span>coef<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span>s <span class="o">+</span> fit<span class="p">$</span>coef<span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="o">*</span>s<span class="o">^</span><span class="m">2</span>
</span><span class='line'>
</span><span class='line'>plot<span class="p">(</span>x<span class="p">,</span>y<span class="p">,</span> ylim<span class="o">=</span>c<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">120</span><span class="p">),</span> xlab<span class="o">=</span><span class="s">&quot;speed&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;dist&quot;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;data(cars)&quot;</span><span class="p">)</span>
</span><span class='line'>lines<span class="p">(</span>s<span class="p">,</span> yhat<span class="p">,</span> lwd<span class="o">=</span><span class="m">4</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>以下の図は，車のスピードをx軸に，制動距離をy軸に取って，carsに含まれる50個のデータをプロットし，オレンジの線で回帰直線を表示している．また，この時の線形回帰で求められた各パラメータの推定値をsummary()関数を用いて表示している．この情報から，それぞれのパラメータの推定値は</p>

<ul>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=a+%3D+2.47014+" alt="a = 2.47014 " /></li>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=b+%3D+0.91329+" alt="b = 0.91329 " /></li>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=c+%3D+0.09996+" alt="c = 0.09996 " /></li>
</ul>


<p>ということがわかる．次の練習問題 6.11では，この推定値を元に，事後分布のサンプリングをメトロポリス・ヘイスティング・アルゴリズムで行う．</p>

<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-11_1.png" alt="" /></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="o">&gt;</span> summary<span class="p">(</span>fit<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>Call:
</span><span class='line'>lm<span class="p">(</span>formula <span class="o">=</span> y ~ x <span class="o">+</span> x2<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>Residuals:
</span><span class='line'>    Min      <span class="m">1</span>Q  Median      <span class="m">3</span>Q     Max
</span><span class='line'><span class="m">-28.720</span>  <span class="m">-9.184</span>  <span class="m">-3.188</span>   <span class="m">4.628</span>  <span class="m">45.152</span>
</span><span class='line'>
</span><span class='line'>Coefficients:
</span><span class='line'>            Estimate Std. Error t value Pr<span class="p">(</span><span class="o">&gt;|</span>t<span class="o">|</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span>Intercept<span class="p">)</span>  <span class="m">2.47014</span>   <span class="m">14.81716</span>   <span class="m">0.167</span>    <span class="m">0.868</span>
</span><span class='line'>x            <span class="m">0.91329</span>    <span class="m">2.03422</span>   <span class="m">0.449</span>    <span class="m">0.656</span>
</span><span class='line'>x2           <span class="m">0.09996</span>    <span class="m">0.06597</span>   <span class="m">1.515</span>    <span class="m">0.136</span>
</span><span class='line'>
</span><span class='line'>Residual standard error: <span class="m">15.18</span> on <span class="m">47</span> degrees of freedom
</span><span class='line'>Multiple R<span class="o">-</span>squared: <span class="m">0.6673</span><span class="p">,</span>  Adjusted R<span class="o">-</span>squared: <span class="m">0.6532</span>
</span><span class='line'><span class="k-Variable">F</span><span class="o">-</span>statistic: <span class="m">47.14</span> on <span class="m">2</span> and <span class="m">47</span> DF<span class="p">,</span>  p<span class="o">-</span>value: <span class="m">5.852</span>e<span class="o">-</span><span class="m">12</span>
</span></code></pre></td></tr></table></div></figure>


<h3>練習問題 6.11 メトロポリス・ヘイスティング・アルゴリズムを用いて事後分布からのサンプリングをする（例6.3の続き）</h3>

<h4>a. P.202の図6.6を描写する</h4>

<p>ここで<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cvarepsilon_%7Bij%7D+%5Csim+%5Cmathcal%7BN%7D%280%2C%5Csigma%5E2%29+" alt="\varepsilon_{ij} \sim \mathcal{N}(0,\sigma^2) " />とすると，この時の尤度関数は以下式のように表される．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=p%28y_%7Bij%7D%7Cx_i%2Ca%2Cb%2Cc%2C%5Csigma%5E2%29+%3D+%5Cprod_%7Bij%7D+%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%5Csigma%5E2%7D%7D%5Cexp%28-%5Cfrac%7B%28y_%7Bij%7D-a-bx_i-cx_i%5E2%29%5E2%7D%7B2%5Csigma%5E2%7D%29+" alt="p(y_{ij}|x_i,a,b,c,\sigma^2) = \prod_{ij} \frac{1}{\sqrt{2\pi\sigma^2}}\exp(-\frac{(y_{ij}-a-bx_i-cx_i^2)^2}{2\sigma^2}) " /></p>

<p>これを整理すると．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=p%28y_%7Bij%7D%7Cx_i%2Ca%2Cb%2Cc%2C%5Csigma%5E2%29+%5Csim+%5Cbigg%28+%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Csigma%5E2%7D%7D+%5Cbigg%29%5EN+%5Cexp%7B%28-%5Cfrac%7B-1%7D%7B2%5Csigma%5E2%7D+%5Csum_%7Bij%7D%28y_%7Bij%7D-a-bx_i-cx_%7Bij%7D%29%5E2+%29%7D+" alt="p(y_{ij}|x_i,a,b,c,\sigma^2) \sim \bigg( \frac{1}{\sqrt{\sigma^2}} \bigg)^N \exp{(-\frac{-1}{2\sigma^2} \sum_{ij}(y_{ij}-a-bx_i-cx_{ij})^2 )} " /></p>

<p>となる．この尤度関数を<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=x_i%2Ca%2Cb%2Cc%2C%5Csigma%5E2+" alt="x_i,a,b,c,\sigma^2 " />による事後分布とみなす．それぞれのパラメータの分布は，先ほどの線形回帰で求めた推定値と標準誤差を用いる．</p>

<ul>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=a+%5Csim+%5Cmathcal%7BN%7D%282.47%2C+%2814.8%29%5E2%29+" alt="a \sim \mathcal{N}(2.47, (14.8)^2) " /></li>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=b+%5Csim+%5Cmathcal%7BN%7D%280.913%2C+%282.03%29%5E2%29+" alt="b \sim \mathcal{N}(0.913, (2.03)^2) " /></li>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=c+%5Csim+%5Cmathcal%7BN%7D%280.100%2C+%281.52%29%5E2%29+" alt="c \sim \mathcal{N}(0.100, (1.52)^2) " /></li>
<li><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Csigma%5E%7B-2%7D+%5Csim+%5Cmathcal%7BG%7D%28n%2F2%2C+%28n-3%29%2815.18%29%5E2%29+" alt="\sigma^{-2} \sim \mathcal{G}(n/2, (n-3)(15.18)^2) " /></li>
</ul>


<p>なお，上の推定値や標準誤差は本書に例示されている値と若干異なっているが，今回は自分の計算環境で計算した推定値を用いることにした．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># 例6.3での線形回帰</span>
</span><span class='line'>data<span class="p">(</span>cars<span class="p">)</span>
</span><span class='line'>y <span class="o">&lt;-</span> cars<span class="p">$</span>dist
</span><span class='line'>x <span class="o">&lt;-</span> cars<span class="p">$</span>speed
</span><span class='line'>x2 <span class="o">&lt;-</span> x<span class="o">^</span><span class="m">2</span>
</span><span class='line'>fit <span class="o">&lt;-</span> lm<span class="p">(</span>y ~ x <span class="o">+</span> x2<span class="p">)</span>
</span><span class='line'>
</span><span class='line'>loglik <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>a<span class="p">,</span>b<span class="p">,</span>c<span class="p">,</span>sigma<span class="p">){</span><span class="o">-</span><span class="p">(</span>n<span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">*</span>log<span class="p">(</span>sigma<span class="p">)</span><span class="o">-</span>sum<span class="p">((</span>y<span class="o">-</span>a<span class="o">-</span>b<span class="o">*</span>x<span class="o">-</span>c<span class="o">*</span>x2<span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="m">2</span><span class="o">*</span>sigma<span class="p">)}</span>
</span><span class='line'>logq <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>a<span class="p">,</span>b<span class="p">,</span>c<span class="p">,</span>sigma<span class="p">){</span>
</span><span class='line'>  dnorm<span class="p">(</span>a<span class="p">,</span>mean<span class="o">=</span>a.est<span class="p">[</span><span class="m">1</span><span class="p">],</span>sd<span class="o">=</span>a.std<span class="p">,</span>log<span class="o">=</span><span class="k-Variable">T</span><span class="p">)</span>
</span><span class='line'>  <span class="o">+</span> dnorm<span class="p">(</span>b<span class="p">,</span>mean<span class="o">=</span>b.est<span class="p">[</span><span class="m">1</span><span class="p">],</span>sd<span class="o">=</span>b.std<span class="p">,</span>log<span class="o">=</span><span class="k-Variable">T</span><span class="p">)</span>
</span><span class='line'>  <span class="o">+</span> dnorm<span class="p">(</span>c<span class="p">,</span>mean<span class="o">=</span>c.est<span class="p">[</span><span class="m">1</span><span class="p">],</span>sd<span class="o">=</span>c.std<span class="p">,</span>log<span class="o">=</span><span class="k-Variable">T</span><span class="p">)</span>
</span><span class='line'>  <span class="o">-</span> <span class="p">(</span>n<span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">*</span>log<span class="p">(</span>sigma<span class="p">)</span> <span class="o">-</span> <span class="p">(</span>n<span class="o">-</span><span class="m">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">15.18</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="o">/</span><span class="p">(</span><span class="m">2</span><span class="o">*</span>sigma<span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>Niter <span class="o">&lt;-</span> <span class="m">4000</span>
</span><span class='line'>n <span class="o">&lt;-</span> length<span class="p">(</span>x<span class="p">)</span>
</span><span class='line'>fit.param <span class="o">&lt;-</span> summary<span class="p">(</span>fit<span class="p">)$</span>coef
</span><span class='line'>a.est <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>a.std <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">]</span>
</span><span class='line'>b.est <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>b.std <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]</span>
</span><span class='line'>c.est <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>c.std <span class="o">&lt;-</span> fit.param<span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">]</span>
</span><span class='line'>sig <span class="o">&lt;-</span> <span class="m">1</span><span class="o">/</span>rgamma<span class="p">(</span><span class="m">1</span><span class="p">,</span> n<span class="o">/</span><span class="m">2</span><span class="p">,</span> rate<span class="o">=</span><span class="p">(</span>n<span class="o">-</span><span class="m">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">15.18</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="o">/</span><span class="m">2</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="kr">for</span><span class="p">(</span>i in <span class="m">2</span>:Niter<span class="p">){</span>
</span><span class='line'>  candidate <span class="o">&lt;-</span> c<span class="p">(</span>rnorm<span class="p">(</span><span class="m">1</span><span class="p">,</span> mean<span class="o">=</span>a.est<span class="p">[</span><span class="m">1</span><span class="p">],</span> sd<span class="o">=</span>a.std<span class="p">),</span>
</span><span class='line'>                 rnorm<span class="p">(</span><span class="m">1</span><span class="p">,</span> mean<span class="o">=</span>b.est<span class="p">[</span><span class="m">1</span><span class="p">],</span> sd<span class="o">=</span>b.std<span class="p">),</span>
</span><span class='line'>                 rnorm<span class="p">(</span><span class="m">1</span><span class="p">,</span> mean<span class="o">=</span>c.est<span class="p">[</span><span class="m">1</span><span class="p">],</span> sd<span class="o">=</span>c.std<span class="p">),</span>
</span><span class='line'>                 <span class="m">1</span><span class="o">/</span>rgamma<span class="p">(</span><span class="m">1</span><span class="p">,</span> n<span class="o">/</span><span class="m">2</span><span class="p">,</span> rate<span class="o">=</span><span class="p">(</span>n<span class="o">-</span><span class="m">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="m">15.18</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="o">/</span><span class="m">2</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">)</span>
</span><span class='line'>  fy <span class="o">&lt;-</span> loglik<span class="p">(</span>candidate<span class="p">[</span><span class="m">1</span><span class="p">],</span> candidate<span class="p">[</span><span class="m">2</span><span class="p">],</span> candidate<span class="p">[</span><span class="m">3</span><span class="p">],</span> candidate<span class="p">[</span><span class="m">4</span><span class="p">])</span>
</span><span class='line'>  fx <span class="o">&lt;-</span> loglik<span class="p">(</span>a.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">],</span> b.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">],</span> c.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">],</span> sig<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">])</span>
</span><span class='line'>  qxy <span class="o">&lt;-</span> logq<span class="p">(</span>a.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">],</span> b.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">],</span> c.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">],</span> sig<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">])</span>
</span><span class='line'>  qyx <span class="o">&lt;-</span> logq<span class="p">(</span>candidate<span class="p">[</span><span class="m">1</span><span class="p">],</span> candidate<span class="p">[</span><span class="m">2</span><span class="p">],</span> candidate<span class="p">[</span><span class="m">3</span><span class="p">],</span> candidate<span class="p">[</span><span class="m">4</span><span class="p">])</span>
</span><span class='line'>  rho <span class="o">&lt;-</span> min<span class="p">(</span><span class="m">1</span><span class="p">,</span> exp<span class="p">(</span>fy<span class="o">-</span>fx<span class="o">+</span>qxy<span class="o">-</span>qyx<span class="p">))</span>
</span><span class='line'>
</span><span class='line'>  <span class="kr">if</span> <span class="p">(</span>runif<span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">&lt;</span>rho<span class="p">){</span>
</span><span class='line'>    a.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> candidate<span class="p">[</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>    b.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> candidate<span class="p">[</span><span class="m">2</span><span class="p">]</span>
</span><span class='line'>    c.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> candidate<span class="p">[</span><span class="m">3</span><span class="p">]</span>
</span><span class='line'>    sig<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> candidate<span class="p">[</span><span class="m">4</span><span class="p">]</span>
</span><span class='line'>  <span class="p">}</span>else<span class="p">{</span>
</span><span class='line'>    a.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> a.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>    b.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> b.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>    c.est<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> c.est<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>    sig<span class="p">[</span>i<span class="p">]</span> <span class="o">&lt;-</span> sig<span class="p">[</span>i<span class="o">-</span><span class="m">1</span><span class="p">]</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>s <span class="o">&lt;-</span> seq<span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">25</span><span class="p">,</span>by<span class="o">=</span><span class="m">0.1</span><span class="p">)</span>
</span><span class='line'>yhat <span class="o">&lt;-</span> fit<span class="p">$</span>coef<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">+</span> fit<span class="p">$</span>coef<span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span>s <span class="o">+</span> fit<span class="p">$</span>coef<span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="o">*</span>s<span class="o">^</span><span class="m">2</span>
</span><span class='line'>
</span><span class='line'>plot<span class="p">(</span>x<span class="p">,</span>y<span class="p">,</span> ylim<span class="o">=</span>c<span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">120</span><span class="p">),</span> xlab<span class="o">=</span><span class="s">&quot;speed&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;dist&quot;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;data(cars)&quot;</span><span class="p">,</span> type<span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</span><span class='line'><span class="kr">for</span><span class="p">(</span>i in <span class="p">(</span>Niter<span class="o">-</span><span class="m">500</span><span class="p">)</span>:Niter<span class="p">){</span>
</span><span class='line'>  lines<span class="p">(</span>x<span class="p">,</span> a.est<span class="p">[</span>i<span class="p">]</span><span class="o">+</span>b.est<span class="p">[</span>i<span class="p">]</span><span class="o">*</span>x<span class="o">+</span>c.est<span class="p">[</span>i<span class="p">]</span><span class="o">*</span>x2<span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;grey&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>lines<span class="p">(</span>s<span class="p">,</span> yhat<span class="p">,</span> lwd<span class="o">=</span><span class="m">4</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;orange&quot;</span><span class="p">)</span>
</span><span class='line'>points<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> pch<span class="o">=</span><span class="m">19</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>以下の図は，先ほどの線形回帰のプロットに加えて，サンプリングから得られた値を用いて回帰曲線を灰色の曲線として描写したものである．</p>

<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-11_3.png" alt="" /></p>

<h4>b. 各パラメータの収束をモニタリングする</h4>

<p>先ほどのサンプリング結果を，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=a%2Cb%2Cc%2C%5Csigma%5E2+" alt="a,b,c,\sigma^2 " />について，4000回のシミュレーションで生成された系列と，そのときの自己相関プロット，そして系列の分布をプロットした．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>par<span class="p">(</span>mfrow<span class="o">=</span>c<span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
</span><span class='line'>plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> a.est<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iterations&quot;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;a&quot;</span><span class="p">)</span>
</span><span class='line'>acf<span class="p">(</span>a.est<span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span>density<span class="p">(</span>a.est<span class="p">),</span> main<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> b.est<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iterations&quot;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;b&quot;</span><span class="p">)</span>
</span><span class='line'>acf<span class="p">(</span>b.est<span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span>density<span class="p">(</span>b.est<span class="p">),</span> main<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> c.est<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iterations&quot;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;c&quot;</span><span class="p">)</span>
</span><span class='line'>acf<span class="p">(</span>c.est<span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span>density<span class="p">(</span>c.est<span class="p">),</span> main<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span><span class="m">1</span>:Niter<span class="p">,</span> sig<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Iterations&quot;</span><span class="p">,</span> main<span class="o">=</span>expression<span class="p">(</span>sigma<span class="o">^</span><span class="m">2</span><span class="p">))</span>
</span><span class='line'>acf<span class="p">(</span>sig<span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span>density<span class="p">(</span>sig<span class="p">),</span> main<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6-11_2.png" alt="" /></p>

<h4>c. 95%信用区間を求める</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="o">&gt;</span> quantile<span class="p">(</span>a.est<span class="p">,</span> c<span class="p">(</span><span class="m">0.025</span><span class="p">,</span><span class="m">0.975</span><span class="p">))</span>
</span><span class='line'>     <span class="m">2.5</span><span class="o">%</span>     <span class="m">97.5</span><span class="o">%</span>
</span><span class='line'><span class="m">-14.90933</span>  <span class="m">18.98784</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「N次元の単位球の体積は5次元で最大になる」をRで試してみた]]></title>
    <link href="http://yagays.github.com/blog/2012/11/24/mcmc-n-dimentional-unit-ball/"/>
    <updated>2012-11-24T00:20:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/11/24/mcmc-n-dimentional-unit-ball</id>
    <content type="html"><![CDATA[<p>先日の<a href="http://live.nicovideo.jp/watch/lv115119412">伊庭さんのニコ生MCMC講義</a>の中で出てきた「N次元の単位球の体積は5次元で最大になる」というのをRで試してみた．</p>

<h3>体積</h3>

<p>N次元の単位球の体積は<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=V_n+%3D+%5Cfrac%7B%5Cpi%5E%7Bn%2F2%7D%7D%7B%5CGamma%281%2Bn%2F2%29%7D+" alt="V_n = \frac{\pi^{n/2}}{\Gamma(1+n/2)} " />で表される．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>plot<span class="p">(</span>apply<span class="p">(</span>matrix<span class="p">(</span>seq<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">15</span><span class="p">)),</span><span class="m">1</span><span class="p">,</span><span class="kr">function</span><span class="p">(</span>n<span class="p">){</span>pi<span class="o">^</span><span class="p">(</span>n<span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">/</span>gamma<span class="p">(</span>n<span class="o">/</span><span class="m">2</span><span class="o">+</span><span class="m">1</span><span class="p">)}),</span>type<span class="o">=</span><span class="s">&quot;b&quot;</span><span class="p">,</span>xlab<span class="o">=</span><span class="s">&quot;N dimension&quot;</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">&quot;V&quot;</span><span class="p">,</span>main<span class="o">=</span><span class="s">&quot;Volume of the unit ball in N dimensions&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/iba_1.png" alt="" /></p>

<p>たしかに5次元で最大になっている．もはや想像が出来無い…．</p>

<h3>表面積</h3>

<p>ちなみに，単位球の表面積は7次元で最大になる．（<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=A_n+%3D+nV_n+%3D+%5Cfrac%7B2%5Cpi%5E%7Bn%2F2%7D%7D%7B%5CGamma%28n%2F2%29%7D+" alt="A_n = nV_n = \frac{2\pi^{n/2}}{\Gamma(n/2)} " />）</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>plot<span class="p">(</span>apply<span class="p">(</span>matrix<span class="p">(</span>seq<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">15</span><span class="p">)),</span><span class="m">1</span><span class="p">,</span><span class="kr">function</span><span class="p">(</span>n<span class="p">){</span><span class="m">2</span><span class="o">*</span>pi<span class="o">^</span><span class="p">(</span>n<span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">/</span>gamma<span class="p">(</span>n<span class="o">/</span><span class="m">2</span><span class="p">)}),</span>type<span class="o">=</span><span class="s">&quot;b&quot;</span><span class="p">,</span>xlab<span class="o">=</span><span class="s">&quot;N dimension&quot;</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">&quot;A&quot;</span><span class="p">,</span>main<span class="o">=</span><span class="s">&quot;Surface area of the unit ball in N dimensions&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/iba_2.png" alt="" /></p>

<h3>参考</h3>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Unit_sphere">Unit sphere - Wikipedia, the free encyclopedia</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「Software Design 2012年 12月号」読了]]></title>
    <link href="http://yagays.github.com/blog/2012/11/23/review-softwaredesign-2012-12/"/>
    <updated>2012-11-23T02:32:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/11/23/review-softwaredesign-2012-12</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B009YK3U3Q" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>最近Blogで継続的に記事を書くようになって，自分の書く文章について特に意識するようになった．書評なり読書ノートを1つの記事をしてまとめるにあたり，とにかく文章を書いては読みを繰り返し，記事を公開したあとも電車の中で読み返すなどして誤字脱字を訂正したり推敲を重ねている．自分のBlogの一番の読者は，まぎれもなく自分だ．いったい誰のために/何のために書いているかという問題は自分の中でもハッキリしていないが，色んなことを差し置いても，結局まわりまわって自分のために書き貯めている部分は大きい．</p>

<p>文章の書き方は今でもよくわからない．ある程度まとまった記事を書くのに慣れてきた面もあり，逆にあまり代わり映えしない表現力に萎えることもある．色々と本を読んで参考にしたり，尊敬する人物の書いた文章を写経したこともあったけれども，結局血肉となったかはよくわからない．本来ならば人に添削してもらうのが一番良いのだが，特に独創性であったり主義主張があるわけではないただのBlog記事にそこまでできるはずもなく，今のところ自分でなんとか改善を繰り返している．</p>

<p>ということで，今月のSoftware Designの特集はエンジニアのための文章力養成講座だ．製品の紹介文やマニュアルなどの文章の書き方であったり，情報をいかに整理して文章を構成していくかといったテクニックが載っている．エンジニア出身のブロガーが文章力について書いているコラムでは，文章を書く人間が普段どういうことを思いながら書いているのかということが色々と書かれていて，なかなかに興味深かった．何かを主張したり情報を広めたり布教をしたりと，アウトプットの質を高めていくにはとにかく書き続けるしかないということで，これからも引き続きblogを続けていこうというモチベーションに繋がる記事だった．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「Rによるモンテカルロ法入門」読書ノート：6章 マルコフ連鎖とランダム・ウォーク]]></title>
    <link href="http://yagays.github.com/blog/2012/11/22/imcmr-6-2/"/>
    <updated>2012-11-22T12:14:00+09:00</updated>
    <id>http://yagays.github.com/blog/2012/11/22/imcmr-6-2</id>
    <content type="html"><![CDATA[<ul>
<li>読書ノート アーカイブ：<a href="http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/">http://yagays.github.com/blog/2012/10/20/archive-introducing-monte-carlo-methods-with-r/</a></li>
</ul>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4621065270" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<h3>練習問題 6.1 自己回帰モデルAR(1)が定常分布を持つことを実験的に示す</h3>

<p>この問題はいわゆるAR(1)というもので，本書の1章 P.34に同様のコードおよび作図が載っている．なお，本問題の詳細は<a href="http://www.stat.ufl.edu/~casella/ShortCourse/MCMC-UseR.pdf">MCMC-UseR.pdf</a>のP.130を参照．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X%5E%7B%28t%2B1%29%7D+%3D+%5Crho+X%5E%7B%28t%29%7D%2B%5Cvarepsilon_t+" alt="X^{(t+1)} = \rho X^{(t)}+\varepsilon_t " />，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cvarepsilon_t+%5Csim+%5Cmathcal%7BN%7D%280%2C1%29+" alt="\varepsilon_t \sim \mathcal{N}(0,1) " />で定義されるマルコフ連鎖において，系列<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5C%7BX%5E%7B%28t%29%7D%5C%7D+" alt="{X^{(t)}} " />の定常分布は<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BN%7D%280%2C+%5Cfrac%7B%5Csigma%5E2%7D%7B1-%5Crho%5E2%7D%29+" alt="\mathcal{N}(0, \frac{\sigma^2}{1-\rho^2}) " />で表される．今回は<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t%3D10%5E4+" alt="t=10^4 " />までのシミュレーション結果をヒストグラムとしてプロットし，定常分布を赤い曲線で示した．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>rho <span class="o">&lt;-</span> <span class="m">0.9</span>
</span><span class='line'>x <span class="o">&lt;-</span> rnorm<span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span><span class='line'><span class="kr">for</span><span class="p">(</span>t in <span class="m">2</span>:<span class="m">10</span><span class="o">^</span><span class="m">4</span><span class="p">){</span>
</span><span class='line'>  x<span class="p">[</span>t<span class="p">]</span> <span class="o">&lt;-</span> x<span class="p">[</span>t<span class="o">-</span><span class="m">1</span><span class="p">]</span><span class="o">*</span>rho <span class="o">+</span> rnorm<span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>hist<span class="p">(</span>x<span class="p">,</span> nclass<span class="o">=</span><span class="m">150</span><span class="p">,</span> freq<span class="o">=</span><span class="k-Variable">F</span><span class="p">)</span>
</span><span class='line'>curve<span class="p">(</span>dnorm<span class="p">(</span>x<span class="p">,</span> mean<span class="o">=</span><span class="m">0</span><span class="p">,</span> sd<span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="o">/</span>sqrt<span class="p">(</span><span class="m">1</span><span class="o">-</span>rho<span class="o">^</span><span class="m">2</span><span class="p">))),</span> add<span class="o">=</span><span class="k-Variable">T</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6_1.png" alt="" /></p>

<h3>練習問題 6.2 ランダム・ウォークが定常分布を持たないことを実験的に示す</h3>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X%5E%7B%28t%2B1%29%7D%3DX%5E%7B%28t%29%7D%2B%5Cvarepsilon_t+" alt="X^{(t+1)}=X^{(t)}+\varepsilon_t " />で表されるランダム・ウォークが，シミュレーション回数を増やしても定常分布に収束しないことを実験的に確かめる．今回は初期値<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X%5E%7B%280%29%7D%3D0+" alt="X^{(0)}=0 " />として，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t%3D10%5E4+" alt="t=10^4 " />と<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t%3D10%5E6+" alt="t=10^6 " />までマルコフ連鎖をシミュレートする．
この問題は練習問題6.1における<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho+%3D+1" alt="\rho = 1" />の場合と同じになるので，上で書いたコードのパラメータを変更するだけで再現できる．ただ，今回は別の書き方としてcumsum()関数を用いてランダム・ウォークの系列を計算している．</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>init <span class="o">&lt;-</span> <span class="m">0</span>
</span><span class='line'>x1 <span class="o">&lt;-</span> cumsum<span class="p">(</span>rnorm<span class="p">(</span><span class="m">10</span><span class="o">^</span><span class="m">4</span><span class="o">-</span><span class="m">1</span><span class="p">))</span>
</span><span class='line'>x2 <span class="o">&lt;-</span> cumsum<span class="p">(</span>rnorm<span class="p">(</span><span class="m">10</span><span class="o">^</span><span class="m">6</span><span class="o">-</span><span class="m">1</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>par<span class="p">(</span>mfrow<span class="o">=</span>c<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
</span><span class='line'>hist<span class="p">(</span>x1<span class="p">,</span> nclass<span class="o">=</span><span class="m">150</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;t=10^4&quot;</span><span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span><span class="m">1</span>:<span class="m">10</span><span class="o">^</span><span class="m">4</span><span class="p">,</span> c<span class="p">(</span>init<span class="p">,</span>x1<span class="p">),</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;t&quot;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;t=10^4&quot;</span><span class="p">)</span>
</span><span class='line'>hist<span class="p">(</span>x2<span class="p">,</span> nclass<span class="o">=</span><span class="m">150</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;t=10^6&quot;</span><span class="p">)</span>
</span><span class='line'>plot<span class="p">(</span><span class="m">1</span>:<span class="m">10</span><span class="o">^</span><span class="m">6</span><span class="p">,</span> c<span class="p">(</span>init<span class="p">,</span>x2<span class="p">),</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;t&quot;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;t=10^6&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6_2.png" alt="" /></p>

<p>シミュレーション回数を<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t%3D10%5E4+" alt="t=10^4 " />と<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t%3D10%5E6+" alt="t=10^6 " />としてランダム・ウォークを実行した結果が上図である．左図に系列のヒストグラム，右図に試行回数を横軸に取った系列をプロットしている．上のように図示すると，たとえ10<sup>6</sup> 回試行したとしても何らかの分布に収束しないことがわかる．</p>

<h3>雑感</h3>

<p>練習問題 6.1と練習問題6.2を比較すると，ランダム・ウォークにおいて先行する状態に<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=0+%5Cleq+%5Crho+%3C+1+" alt="0 \leq \rho &lt; 1 " />のような値を掛け合わせるだけで定常分布を取るというのは，なんとも面白い結果となっている．</p>

<h3>補足：<a href="http://www.stat.ufl.edu/~casella/ShortCourse/MCMC-UseR.pdf">MCMC-UseR.pdf</a>のP.132</h3>

<ul>
<li>練習問題の<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho+" alt="\rho " />と以下図の<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctheta+" alt="\theta " />は同じ</li>
<li>pdfにも書いてあるがスケール（x軸とy軸の描写範囲）に注意．いかに<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctheta+" alt="\theta " />が効いているかがわかる</li>
<li>左上はマルコフ連鎖ではない</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>par<span class="p">(</span>mfrow<span class="o">=</span>c<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
</span><span class='line'><span class="kr">for</span><span class="p">(</span>rho in c<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0.4</span><span class="p">,</span> <span class="m">0.8</span><span class="p">,</span> <span class="m">0.95</span><span class="p">)){</span>
</span><span class='line'>  x <span class="o">&lt;-</span> rnorm<span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span><span class='line'>  y <span class="o">&lt;-</span> rnorm<span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span><span class='line'>  <span class="kr">for</span><span class="p">(</span>t in <span class="m">2</span>:<span class="m">1000</span><span class="p">){</span>
</span><span class='line'>    x<span class="p">[</span>t<span class="p">]</span> <span class="o">&lt;-</span> x<span class="p">[</span>t<span class="o">-</span><span class="m">1</span><span class="p">]</span><span class="o">*</span>rho <span class="o">+</span> rnorm<span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span><span class='line'>    y<span class="p">[</span>t<span class="p">]</span> <span class="o">&lt;-</span> y<span class="p">[</span>t<span class="o">-</span><span class="m">1</span><span class="p">]</span><span class="o">*</span>rho <span class="o">+</span> rnorm<span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  plot<span class="p">(</span>x<span class="p">,</span>y<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> main<span class="o">=</span>paste<span class="p">(</span><span class="s">&quot;theta=&quot;</span><span class="p">,</span>rho<span class="p">))</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://dl.dropbox.com/u/142306/b/imcmr/chp6_6_extra.png" alt="" /></p>
]]></content>
  </entry>
  
</feed>
