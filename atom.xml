<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Wolfeyes Bioinformatics beta]]></title>
  <link href="http://yagays.github.io/atom.xml" rel="self"/>
  <link href="http://yagays.github.io/"/>
  <updated>2013-08-06T04:51:08+09:00</updated>
  <id>http://yagays.github.io/</id>
  <author>
    <name><![CDATA[yag_ays]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[「葬式は、要らない」読了]]></title>
    <link href="http://yagays.github.io/blog/2013/08/05/review-no-funeral-required/"/>
    <updated>2013-08-05T21:18:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/08/05/review-no-funeral-required</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4344981588" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>宗教学者の島田裕巳氏による葬式論．タイトルは少々誇張が含まれており，実際に本書の中で述べられている主張はもう少し穏やかな口調でいて同時に強烈なメッセージを含んでいる．それは，現代日本の葬式は贅沢だということである．ただし，贅沢という語感だけで判断してはいけない．贅沢とは本書冒頭で定義されている言葉を借りるならば，</p>

<blockquote><p>贅沢とは何か．それは，必要限度を超えて，金銭やものなどを惜しみなく消費することである．</p>

<p><a href="http://www.amazon.co.jp/gp/product/4344981588/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=4344981588&linkCode=as2&tag=yagays-22">葬式は、要らない (幻冬舎新書)</a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=yagays-22&l=as2&o=9&a=4344981588" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /> (P.15)</p></blockquote>

<p>ということだ．決して他人に対して羨望や僻みを含んだ意味ではないことを強調しておきたい．この定義から考えれば，葬式は必要限度以上に金銭やものを惜しみなく消費しており，だからそういった葬式は要らないということになる．ここで言う必要限度を超えているものは，葬式費用であり，檀家と僧侶との関係であり，戒名である．そして，これらの度を超えた豪華さを作り上げてきたのは，日本的な世間体と日本における仏教の変遷である．本書では以上のような主張を軸に，日本の葬式の現状や近年急速に変化しつつある業界基準を概観した上で，日本の葬式の歴史を紐解きつつ，これから向かう日本人と宗教の関係について論じている．</p>

<p>葬式論の具体的な内容は実際に本を読んでいただくとして，そこから本書の締めとして抽象化へと一気に駆け上がっていくところが個人的に非常に印象に残った．それは著者の死生観というべきものだ．本書の最後の章において，氏は「葬式の先にある理想的な死のあり方」というものを述べている．その冒頭で引き合いに出されるのはアメリカの有名私立大学であるスタンフォード大学の由来だ．スタンフォード大学は正式名称リーランド・スタンフォード・ジュニア大学と言い，一個人の名前を冠している．これはアメリカ大陸横断鉄道の生みの親であったリーランド・スタンフォード夫妻の子供の名だ．もうこの辺であらかた察しがつくだろう．夫妻の子供は若くで腸チフスで亡くなり，夫妻はその子供の名前を残すために，これまでに築き上げた資産を使い大学を創立した．それが今のスタンフォード大学である．つまりスタンフォードとは名前であり，ある一人の人間が生きた証なのだ．そして島田裕巳氏は言う．動物の中で人間だけが個人の死の後に何か残すことができる，それは個人の願望または遺族の希望である．本人と遺族に悔いの残らない死に方をすれば，それでいいじゃないか．それが目指すべき生き方であり死に方であるなら，葬式なんてどのようなものであってもいい．だから，葬式は要らない，と．</p>

<h4>参考</h4>

<ul>
<li><a href="http://ja.wikipedia.org/wiki/%E3%82%B9%E3%82%BF%E3%83%B3%E3%83%95%E3%82%A9%E3%83%BC%E3%83%89%E5%A4%A7%E5%AD%A6">スタンフォード大学 - Wikipedia</a></li>
<li><a href="http://www.iiwave.com/schooldata/2/overview_41204028.html">iiwave.com: Stanford University スタンフォード・ユニバーシティ</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「日本人の知らないワンランク上のビジネス英語術 エール大学厳選３０講」読了]]></title>
    <link href="http://yagays.github.io/blog/2013/08/04/review-english-communication-skills/"/>
    <updated>2013-08-04T00:40:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/08/04/review-english-communication-skills</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4484112078" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>文法が正しければそれでいい，意味が通じればそれでいい，謝罪や感謝の言葉さえ言っておけばそれでいい…，といったある種の割り切りのようなものは，完璧な英語を目指すあまりに何も話せないような日本人にとっては効果のある心がけなのかもしれないが，一方で適切でない言葉遣いや非礼な態度はコミュニケーションにおける誤解を招きかねない．とは言うものの，微妙なニュアンスや行間を読むようなことはネイティブスピーカーじゃないとできないと思うかもれない．まだ基礎もできていないのに高度なことは到底無理だと，始めから匙を投げがちだ．しかし，大人になった私たちには論理があり経験があり文化がある．礼儀や習慣の必要性を論理的に理解し，それが必要になる場を経験から感じ取り，文化的な振る舞いを心がけることができる．これは決してネイティブやバイリンガルが自然とできるようになることではない．大人になった今だからこそ，理論的に系統立てて学べる技術である．しかも，必要になるのはとても簡単な単語と文法だけとなれば，あとは身に付けるかどうかの違いだけだ．</p>

<p>本書は主に日本のビジネスマンや学生に向けて書かれた英語のコミュニケーション術の解説書である．英語を必要とする日常会話やメール，プレゼンテーションなどの場において，どういう決まり事があってどういう間違いをしがちかといった気をつけるべきポイントが多数収録されている．特に，どんな場合でも&#8221;I&#8217;m sorry&#8221;と言わないと気がすまなかったり，質問に&#8221;Yes, I do / No, I don&#8217;t&#8221;といった決まり文句で返事しがちであったり，質問の意味がわからずに適当に返事してしまったりと，誰しも一度は体験したことのあるようなケースが多数登場する．当然ながら，それらの巧い返し方にも決まったフレーズがあり，言葉の使い方をちょっと変えるだけでぐっとネイティブに近づくことができる．また，日米のメールの構成の違いや発音を改善する方法など，知っていて当然/知っておくべき知識も豊富に含まれている．個人的には，</p>

<ul>
<li>canとcan&#8217;tの発音方法の違い</li>
<li>相手の質問に不躾にNoと言わない方法</li>
<li>マジックナンバー3</li>
</ul>


<p>あたりが非常に参考になった．どのトピックも難しいことは何一つ要求されない．ただそのことを知っていて体に染み付いているかどうかの問題なのだ．この程度ならもしかしたら感覚的に理解して実践している人もいるかもしれない．しかし，今は頭でっかちになって理屈から理解しようとしているのだから，気後れすることなく1つずつ覚えていけばいい．そういった意味で本書は，英語の作法や技術をじっくり学んでいくための足がかりになる1冊である．</p>

<br/>


<p>それにしても英語は本当に難しい．なんでこんなに英語が喋れない/聞き取れない/書けない/読めないのかと，悔しくてたまらない時がある．もしバイリンガルだったならどれほど楽だったかと誰しも一度は思うはずだ．そういう時には決まってスヌーピーのこの言葉を思い出すようにしている．</p>

<blockquote><p>YOU PLAY WITH THE CARDS YOU&#8217;RE DEALT&#8230;WHATEVER THAT MEANS.</p></blockquote>

<p>いくら人を羨んだってしょうがない，だったらとことん理詰めで攻めてやろうじゃないかと，すこしばかり自分を奮いたたせることができる．そして，本書のような英語の技術書を読むと，少しばかり前に進んでいる実感が得られる．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA["de Bruijn"はどう発音する？]]></title>
    <link href="http://yagays.github.io/blog/2013/08/01/de-bruijn-pronounce/"/>
    <updated>2013-08-01T21:43:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/08/01/de-bruijn-pronounce</id>
    <content type="html"><![CDATA[<p>アセンブリ界隈ではすっかりスタンダートな手法になったde Bruijn graphによるアセンブルだが，正直言ってこの単語の発音はよく分からない！私自身も人が発音しているのを聞いて参考にしたり色々調べたりして確認してはいるものの，いまだに自信を持って口に出して言えないトコロがある．Blogに書くときもカタカナ表記を避けているのが現状だ．</p>

<p><a href="http://thegenomefactory.blogspot.jp/2013/08/how-to-pronounce-de-bruijn.html">The Genome Factory: How to pronounce &#8220;de Bruijn&#8221;</a></p>

<p>さて，この発音問題は英語圏でもかなり混乱があるようだ．上記のBlog記事によると，今年のISMB 2013という学会でも様々な発音の仕方を耳にしたという．例えば</p>

<blockquote><p>-broon</p>

<p>-broo-en, brewin&#8217;</p>

<p>-bra-jen, brar-djen</p>

<p>-brin</p>

<p>-brun</p>

<p>-bruggin, bruggen</p>

<p>-broin, broyn</p></blockquote>

<p>といった具合だ．要するに&#8221;ijn&#8221;付近がやっかいで，発音するのかしないのかがよくわからないといったところだろう．似たような単語が英語にほとんど無いというのも影響していると思われる．</p>

<p>さて，このBlog記事によるとBruijnの部分は&#8221;BROWN&#8221;と読むようだ．ということで，日本語表記するならば<strong>正しくはde Bruijnはデュブランと読む</strong>ということだろうか．ただし，Bruijnをブルーインと表記する日本語記事も見られるため，過去の翻訳との兼ね合いも悩ましいところ．昔の日本語読み的なカタカナ表記ではブルーインなのだろうが，本来の読みをそのままカタカナにする最近の表記方法ではデュブランだろう．</p>

<p>ということで，個人的にはデュブランの方がしっくりくる．今後もBlogに記事を書く際には英語表記のままde Bruijn graphとするが，書くとしたらデュブラングラフかな&#8230;．</p>

<h3>参考</h3>

<ul>
<li><a href="http://ejje.weblio.jp/content/Inge+de+Bruijn">Inge de Bruijnの意味 - 英和辞典 Weblio辞書</a>(de Bruijnでデブルーイン派)</li>
<li><a href="http://d.hatena.ne.jp/m-hiyama-memo/20110423/1303547574">de Bruijn - 檜山正幸のキマイラ飼育記 メモ編</a>(de Bruijnでデュブラン派)</li>
<li><a href="http://www.ccr.gunma-u.ac.jp/4u/Seeds/Pdf/2009/Gunma/Vol02_P049_050_G_Computer_Shibata_Itoh.pdf">http://www.ccr.gunma-u.ac.jp/4u/Seeds/Pdf/2009/Gunma/Vol02_P049_050_G_Computer_Shibata_Itoh.pdf</a>(de Brujinでド・ブルーイン派)</li>
<li><p><a href="http://staff.aist.go.jp/t-fukatsu/CATNewsVol1No5-8.pdf">http://staff.aist.go.jp/t-fukatsu/CATNewsVol1No5-8.pdf</a>(de Brujinでド・ブロイ派)</p></li>
<li><p><a href="http://ja.forvo.com/search/bruijn/">http://ja.forvo.com/search/bruijn/</a>(実際に発音している音声)</p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Life Technologiesによる研究者応援ソング （Ph.Diddyシリーズ）]]></title>
    <link href="http://yagays.github.io/blog/2013/07/26/ph-diddy/"/>
    <updated>2013-07-26T13:33:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/26/ph-diddy</id>
    <content type="html"><![CDATA[<p>研究者をネタにした音楽や動画などはいろいろとあるけれども，<a href="http://www.lifetechnologies.com/jp/ja/home.html">Life Technologies</a>社のPh.Diddyシリーズに関してあまり日本語で紹介されているウェブサイトがなかったので，ちょっとまとめてみた．このシリーズは珍しく日本語に翻訳されており，歌詞まで字幕で付けられているという充実っぷりだ．今までに3作が公開されており，Ph.Dを目指すPh.DiddyやPh.Divaがウェットのラボで奮闘する姿が描かれている．</p>

<h3>Ph.Diddy登場！ (Ph.Diddy is on the scene)</h3>

<iframe width="640" height="360" src="http://yagays.github.io//www.youtube.com/embed/9i5M3nLWW78" frameborder="0" allowfullscreen></iframe>


<blockquote><p>アーノルド・ヤングは、生物工学Ph.D候補です（別名Ph.Diddy）。</p>

<p>アーノルドはA+学生で、現在、サイエンス界の将来を背負って立つ準備中！
彼はすぐに発見します。意欲的、献身的な研究室生活で味わう、失敗、達成感、激務、夜­遅くまで度重なる実験、査読、そして、尊敬と信頼を勝ち取るための奮闘の日々を！
果たして、研究室生活での浮き沈みは、我々のPh.Diddyをどのように形成してい­くのか？</p>

<p>そして、彼の初めての論文が発表されるまでの旅路は？</p>

<p><a href="http://www.youtube.com/watch?v=9i5M3nLWW78">http://www.youtube.com/watch?v=9i5M3nLWW78</a></p></blockquote>

<h3>Ph.Diva と謎のバンド (Ph.Diva and the Mystery Band)</h3>

<iframe width="640" height="360" src="http://yagays.github.io//www.youtube.com/embed/5H6_-V5iFmI" frameborder="0" allowfullscreen></iframe>


<blockquote><p>エイプリル・ブライトは生物工学のポスドクです（別名 Ph.Diva）。抄録が口頭発表に選ばれて興奮気味。さっそくプレゼンテーションの­準備に取り掛かります。PCR が予想通りの結果にならず、失望と期待、興奮、決断を繰り返す日々が始まりました。果­たして、Ph.Divaは晴れて会議の日を迎えることができるのでしょうか？</p>

<p><a href="http://www.youtube.com/watch?v=5H6_-V5iFmI">http://www.youtube.com/watch?v=5H6_-V5iFmI</a></p></blockquote>

<h3>Ph.Diddy 学会へ行く (Ph.Diddy at the Conference)</h3>

<iframe width="640" height="360" src="http://yagays.github.io//www.youtube.com/embed/W-foZdGdyIM" frameborder="0" allowfullscreen></iframe>


<blockquote><p>アーノルド・ヤングは、生物工学 Ph.D 候補です（別名 Ph.Diddy）。変化の激しいサイエンス界の将来を背負って立つべく、日々奮闘し­ています。ポスターも準備万端、いよいよ初めての学会に向けて出発です。ラボから飛び­出て出張! 飛行機で! 学会に! ドキドキワクワク、テンション MAX! アーノルドは科学に魅せられた仲間に出会い、交流できることを楽しみにしてきました。­いろんなブースで貰えるノベルティにも期待しているようです。今回の学会には PI とエイプリル・ブライト（別名 Ph.Diva）も同行しています。アーノルドは隣のブースの女性が気になっています­。彼女はアーノルドに気が付いてくれるでしょうか。</p>

<p><a href="http://www.youtube.com/watch?v=W-foZdGdyIM">http://www.youtube.com/watch?v=W-foZdGdyIM</a></p></blockquote>

<h3>曲はiTunesで購入できる</h3>

<p>ちなみに，これらの曲はiTunesで購入することができる．</p>

<div class="sticky-itslink"><a href="https://itunes.apple.com/jp/album/ph.diddy-is-on-scene-single/id478987896?uo=4" rel="nofollow" target="_blank"><img src="http://a3.mzstatic.com/us/r30/Music/c2/bf/75/mzi.rhahmmsq.100x100-75.jpg" style="border-style:none;float:left;margin:5px;" alt="The Ph.Diddy Is On the Scene - Single" title="The Ph.Diddy Is On the Scene - Single" /></a><div class="sticky-itslinktext"><a href="https://itunes.apple.com/jp/album/ph.diddy-is-on-scene-single/id478987896?uo=4" rel="nofollow" target="_blank">The Ph.Diddy Is On the Scene - Single</a><br />Ph.Diddy<br />価格： 150円<br /> <a href="https://itunes.apple.com/jp/album/ph.diddy-is-on-scene-single/id478987896?uo=4" rel="nofollow" target="_blank"><img src="http://ax.phobos.apple.com.edgesuite.net/ja_jp/images/web/linkmaker/badge_itunes-sm.gif" alt ="iTunesで見る" style="border-style:none;" /></a><br style="clear:left;" /></div></div>


<div class="sticky-itslink"><a href="https://itunes.apple.com/jp/album/ph.-diva-mystery-band-single/id517060659?uo=4" rel="nofollow" target="_blank"><img src="http://a5.mzstatic.com/us/r30/Music/v4/9a/58/1d/9a581dd4-aab0-ffef-5c07-f2f9505ab7d8/885767463295.100x100-75.jpg" style="border-style:none;float:left;margin:5px;" alt="Ph. Diva and the Mystery Band - Single" title="Ph. Diva and the Mystery Band - Single" /></a><div class="sticky-itslinktext"><a href="https://itunes.apple.com/jp/album/ph.-diva-mystery-band-single/id517060659?uo=4" rel="nofollow" target="_blank">Ph. Diva and the Mystery Band - Single</a><br />Ph. Diva<br />価格： 200円<br /> <a href="https://itunes.apple.com/jp/album/ph.-diva-mystery-band-single/id517060659?uo=4" rel="nofollow" target="_blank"><img src="http://ax.phobos.apple.com.edgesuite.net/ja_jp/images/web/linkmaker/badge_itunes-sm.gif" alt ="iTunesで見る" style="border-style:none;" /></a><br /><span style="font-size:xx-small;">posted with <a href="http://sticky.linclip.com/linkmaker/" target="_blank">sticky</a> on 2013.7.26</span><br style="clear:left;" /></div></div>


<p></p>

<div class="sticky-itslink"><a href="https://itunes.apple.com/jp/album/conference-yeah-single/id555923275?uo=4" rel="nofollow" target="_blank"><img src="http://a2.mzstatic.com/us/r30/Music/v4/d3/c9/1b/d3c91b9f-bec7-7fa3-e576-077610c19adb/700261875149.100x100-75.jpg" style="border-style:none;float:left;margin:5px;" alt="Conference Yeah - Single" title="Conference Yeah - Single" /></a><div class="sticky-itslinktext"><a href="https://itunes.apple.com/jp/album/conference-yeah-single/id555923275?uo=4" rel="nofollow" target="_blank">Conference Yeah - Single</a><br />Ph.Diddy<br />価格： 200円<br /> <a href="https://itunes.apple.com/jp/album/conference-yeah-single/id555923275?uo=4" rel="nofollow" target="_blank"><img src="http://ax.phobos.apple.com.edgesuite.net/ja_jp/images/web/linkmaker/badge_itunes-sm.gif" alt ="iTunesで見る" style="border-style:none;" /></a><br /><span style="font-size:xx-small;">posted with <a href="http://sticky.linclip.com/linkmaker/" target="_blank">sticky</a> on 2013.7.26</span><br style="clear:left;" /></div></div>


<p></p>

<h4>追記</h4>

<p>有難いことにライフテクノロジーズジャパンの方に反応を頂いた．どうやら4部作だそうなので，次の作品にも期待！</p>

<blockquote class="twitter-tweet"><p><a href="https://twitter.com/yag_ays">@yag_ays</a> まとめていただきありがとうございます！！ 実はPh.Diddyシリーズは4部作らしいのですが、まだ4作目が完成しておりません…。その他にも動画を多数作成しておりますのでYoutubeをチェックしてみてください！ <a href="http://t.co/CDp9oZLjvQ">http://t.co/CDp9oZLjvQ</a></p>&mdash; ライフテクノロジーズジャパン株式会社 (@LifetechJPN) <a href="https://twitter.com/LifetechJPN/statuses/360656086560280580">July 26, 2013</a></blockquote>


<script async src="http://yagays.github.io//platform.twitter.com/widgets.js" charset="utf-8"></script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「研究留学術 第2版―研究者のためのアメリカ留学ガイド」読了]]></title>
    <link href="http://yagays.github.io/blog/2013/07/24/guide-for-japanese-researchers-in-us/"/>
    <updated>2013-07-24T21:37:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/24/guide-for-japanese-researchers-in-us</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=4263206738" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>特段留学する予定などはなく，単にアメリカの研究事情についての知識が欲しかったので図書館で借りて軽く読み通してみたのだが，かなり内容が濃くて実際に留学する上で必要な知識が詰まった1冊だった．もしアメリカ留学する機会があれば，この本は絶対に買って読み込むだろうと思う．また，ただの留学に必要な手続き紹介だけではなく，ポスドクとしての研究費獲得方法やアメリカと日本のラボの運営形態の違いなども紹介されており，通常の学生や研究者にとっても興味深い内容となっている．</p>

<p>本書はアメリカ合衆国への留学に必要なありとあらゆる情報が網羅された留学ガイド本である．元は「<a href="http://kenkyuu.net/">研究留学ネット</a>」という，著者個人がアメリカ留学を期に立ち上げたウェブサイトを書籍化したもので，2002年に第一版が出版され，2012年にビザなどの手続きの変更や特別鼎談などが加わった第二版が出版されている．内容としては著者の個人的な留学経験を元に一般的なアメリカ留学に関して，受け入れ研究室探しの方法から始まり，ビザの発行や保険の加入，銀行口座の開設などの渡航前後に必要となる手続きであったり，日常生活レベルで必要な知識が細かく紹介されている．著者自体が医者のポスドクとして渡航しているからか，主な対象として日本でPhDを取得しアメリカでポスドクをするという人向けの色合いが強い．そのため，配偶者や子供を連れて行く場合のビザの情報であったり，車の購入に関する情報もカバーされている．といっても，当然ながらアメリカ留学に関する基本的な枠組みにそれほど差があるわけではないので，非医学の生命科学系研究者にとっても有用な情報が詰め込まれている．また，本書後半ではアメリカ留学を経験した9人の体験談が収録されており，大学や専門がそれぞれ違う人たちのリアルな留学経験が語られる．そして最後に特別鼎談として，本書著者の門川氏，先ほどの体験談を起稿された方の一人である広田氏，そして「<a href="http://harvardmedblog.blog90.fc2.com/">ハーバード大学医学部留学・独立日記</a>」で有名の島岡氏による特別対談が収録されている．</p>

<p>こういった本を読んでいると，将来の選択肢として留学があること，そして国や文化を超えて研究を行うということに関して色々と考えてしまう．かなり個人的な話になってしまうが，今ちょうど同じ研究室にいる中国からの留学生の世話をしているのだけれども，やはり外国で生活をするというのは並々ならぬ労力が必要のようだ．たとえ言語の壁はなんとか突破できたとしても，公共サービスや役所への提出書類の作成であったり，住居などの暮らしに関する細かな違い，そして何より文化の違いは，非常に大きな負荷となるに違いない．これに関しては経験がモノを言う部分だと思うので，今回のような本を参考にして知識を詰め込んでおいたり，実際に留学された経験者が身近にいて相談できる状態というのは非常に大事だと感じた．</p>

<h3>参考</h3>

<ul>
<li><a href="http://kenkyuu.net/mybook.html">拙著『研究留学術』の紹介</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RNA-Seqの数理―生成モデルによる発現量推定（3）ペアエンドリードとフラグメント長の分布関数]]></title>
    <link href="http://yagays.github.io/blog/2013/07/22/mathematical-models-for-transcriptome-quantification-3/"/>
    <updated>2013-07-22T09:59:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/22/mathematical-models-for-transcriptome-quantification-3</id>
    <content type="html"><![CDATA[<ul>
<li>まとめ：<a href="http://yagays.github.io/blog/2013/07/14/mathematical-models-for-transcriptome-quantification-0/">RNA-Seqの数理―生成モデルによる発現量推定：アーカイブ - Wolfeyes Bioinformatics beta</a></li>
</ul>


<p>前回はCount Based Modelの基礎やRPKMとの関連を解説したが，これらはすべてシングルエンドを前提とした発現量推定の方法だった．そこで今回は，現在主流となっているペアエンドに対応できるようモデルの一部を拡張し，その際に必要になるフラグメント長の分布を考慮した有効配列長の考え方について紹介する．</p>

<h3>ペアエンドリード</h3>

<p>ペアエンドによるシーケンスは，illuminaなどで現在もっとも広く使われているNGSの手法だ．ペアエンドのショートリードは，ゲノムやmRNAを特定の長さのフラグメントに細かく分割したあと，その両端にアダプターを付けて左右同時にシーケンスすることによって得られる．この方法によって，単純にシーケンスのデータ量が2倍になるだけでなく，ある程度離れた距離の2つの配列の関係性も同時に得られる．つまり，元々ひとつの同じフラグメントからシーケンスされたのだから，そのフラグメントの長さの範囲内で2つのショートリードは必ず存在していたはずだという情報である．これらは発現量推定において転写物のアイソフォームを確認するために用いられるほか，主にゲノムアセンブリやトランスクリプトームアセンブリにおいて，コンティグと呼ばれるアセンブルされた断片をつなぎ合わせるスキャフォールディングにおいて有効な実験手法になっている．</p>

<h3>RPKMからFPKMへ</h3>

<p>シングルエンドではRPKMとして計算していた発現量の指標をペアエンドに拡張するのはとても簡単で，2本のマッピングされたショートリードのペアを1本のフラグメントの本数として見なし，転写物ごとにその本数数えるだけで良い．これをFPKM（Fragments per kilobase of exon per million mapped sequence reads）という．RPKMのReadsの部分をFragments，すなわちペアエンドの2つのショートリードに置き換えただけで，全体のデータ量と転写物の配列長で正規化する部分は変わっていない．ただし，マッピングする配列が実質2本になったということで，両方ともマッピングされるという以外にも，片方だけマッピングされたといった特殊な場合が出てくる．このような特殊なケースはマッピングするソフトウェアの設定やFPKMの計算方法に依存するものの，基本的には2本の配列がフラグメント長の間を置いてマッピングされるかどうかによってFPKMの値を求める．</p>

<h3>Count Based Modelにおける変更点</h3>

<p>ではCount Based Modelにペアエンドのショートリードを対応させよう．RPKMからFPKMに拡張したときと同様に発現量の導出部分に手を加える必要はないのだが，一つだけペアエンドを考慮する必要のある変数がある．それが転写物の有効配列長<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctilde%7Bl_t%7D+" alt="\tilde{l_t} " />だ．</p>

<p>転写物の有効配列長Effective length of a transcriptsは，ある転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l_t+" alt="l_t " />から長さ<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=m+" alt="m " />のショートリードが得られるときの開始点の場合の数であり，シングルエンドの場合は<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctilde%7Bl_t%7D+%3D+l_t+-+m+%2B+1+" alt="\tilde{l_t} = l_t - m + 1 " />で表される．これはショートリードに長さがあるぶんだけフラグメントが生じる開始点として考慮できる長さは短くなるということだ．</p>

<p>では，今回のペアエンドリードの場合はどう考えればいいだろうか．基本的にはシングルエンドの場合と同様に，長さぶんだけ差し引いた値が有効配列長となる．長さといっても，ペアエンドは元々一つのフラグメントからシーケンスされたショートリードなので，フラグメントの長さを用いる．</p>

<p>しかしここで一つ問題点が出てくる．それは，フラグメントの長さが実は一定ではないということだ．mRNAなどを断片化してある長さのフラグメントに選定する作業は実験的に行なわれるため，どうしてもフラグメントの長さに幅ができてしまう．そのため，ショートリードによって，ペアエンドの間の距離が短いものや長いものが出てくる．この現象は実際にゲノムにペアエンドリードを貼り付けて間の距離を測れば確認することができる．以下の図は，Cufflinksの論文中で実際に求められたフラグメント長の分布を表している（Supplementary Figure 1.）．この場合では，200bpを中心にしてフラグメント長にばらつきがあり，おおよそ正規分布の形をしていることがわかる．山の左側が途中で切断されているのは，ショートリードの長さが75bpのためである．</p>

<p><a href="http://www.nature.com/nbt/journal/v28/n5/full/nbt.1621.html" target="_blank"><img src="http://dl.dropboxusercontent.com/u/142306/b/generative-models_4.png" alt="CCC License Number:3192890152232"></a></p>

<p>この図からわかるように，フラグメント長はショートリードによってばらつきがあるため，有効配列長を求める際に一意に値を決めることができない．</p>

<h3>フラグメント長の分布関数を使って有効配列長を求める</h3>

<p>この問題を解消するための手段として，フラグメント長の分布関数を使うという方法がある．</p>

<p>転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />の長さを<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l_t+" alt="l_t " />とする．ショートリードのフラグメントの長さを<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=i+" alt="i " />としたときのフラグメント長の分布関数を<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=F%28i%29+" alt="F(i) " />とし，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Csum_%7Bi%3D1%7D%5E%7B%5Cinfty%7DF%28i%29%3D1+" alt="\sum_{i=1}^{\infty}F(i)=1 " />となるように確率分布に近似する．このときの転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />の有効配列長<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctilde%7Bl_t%7D+" alt="\tilde{l_t} " />は，以下のように表される．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctilde%7Bl_t%7D+%3D+%5Csum_%7Bi%3D1%7D%5E%7Bl_t%7DF%28i%29%28l_t-i%2B1%29+" alt="\tilde{l_t} = \sum_{i=1}^{l_t}F(i)(l_t-i+1) " /></p>

<p>この式の解釈としては，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%28l_t-i%2B1%29+" alt="(l_t-i+1) " />の部分はシングルエンドの有効配列長の求め方と同じ方法で，ショートリードの長さがフラグメントの長さに変わっただけである．そこに<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=F%28i%29+" alt="F(i) " />という分布関数を掛けあわせ，長さ<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=1+" alt="1 " />から転写物の長さ<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l_t+" alt="l_t " />まで足しあわせた値が，ペアエンドの有効配列長となる．つまり，分布の重み付きの配列長として表現しているということだ．</p>

<p>この考え方を模式的に表した図を，以下に示した．ここでは青色の直線で表した転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />に黒色の直線で表したショートリードをマッピングしている．太い部分が実際にシーケンスされたショートリード，細い部分がシーケンスされていないフラグメントの部分で，全体で一つのフラグメントを表している．フラグメント長<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=i+" alt="i " />を長さ<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=1+" alt="1 " />から<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l_t+" alt="l_t " />までずらしたときのそれぞれの分布は，右に示したような正規分布のような形をとり，これを<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=F%28i%29+" alt="F(i) " />としている（実際は離散的）．そして，それぞれのフラグメント長<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=i+" alt="i " />における有効配列長<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%28l_t-i%2B1%29+" alt="(l_t-i+1) " />に分布関数<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=F%28i%29+" alt="F(i) " />を掛けあわせたものを全て足し合わせることにより，長さ<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l_t+" alt="l_t " />の転写物における有効配列長<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l_t+" alt="l_t " />を求めることができる．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/generative-models_5.png" alt="" /></p>

<h3>Cufflinksとの関連</h3>

<p>さて，今回示した数式<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctilde%7Bl_t%7D+%3D+%5Csum_%7Bi%3D1%7D%5E%7Bl_t%7DF%28i%29%28l_t-i%2B1%29+" alt="\tilde{l_t} = \sum_{i=1}^{l_t}F(i)(l_t-i+1) " />は，<a href="http://www.nature.com/nbt/journal/v28/n5/full/nbt.1621.html">Cufflinksの論文</a>のOnline Methodsに出てくる数式だ．ただしそちらの方では<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l_t+" alt="l_t " />が<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l%28t%29+" alt="l(t) " />となっているが，表記を<a href="http://yagays.github.io/blog/2013/07/16/mathematical-models-for-transcriptome-quantification-2/">前回の記事</a>と統一しているだけで表していることは変わりない．</p>

<p>また，Cufflinksのソフトウェアの実行においても，このフラグメント長の分布の種類やパラメータを具体的に指定することができる．</p>

<p><a href="http://cufflinks.cbcb.umd.edu/manual.html">Cufflinks RNA-Seq analysis tools - User&#8217;s Manual</a></p>

<p>例えば，&#8211;frag-len-meanはフラグメント長の分布の平均，&#8211;frag-len-std-devではフラグメント長の分布の標準偏差を指定することができる．ただし，現在のバージョンでは，</p>

<blockquote><p>Note: Cufflinks now learns the fragment length mean for each SAM file, so using this option is no longer recommended with paired-end reads.</p>

<p><a href="http://cufflinks.cbcb.umd.edu/manual.html">http://cufflinks.cbcb.umd.edu/manual.html</a></p></blockquote>

<p>のように自動的に推定されるようになっており，ユーザが特に意識することなく実行できるようになっている．</p>

<h3>まとめ</h3>

<p>このように，ペアエンドにおいてはフラグメント長の分布を考慮することによって，有効配列長をより正確に記述した．今回のペアエンドリードの導入ではモデル自体は変更しなかったものの，きちんと実験環境やシーケンスの癖を数式としてモデルに反映することができている．</p>

<h3>参考</h3>

<ul>
<li><a href="http://www.nature.com/nbt/journal/v28/n5/full/nbt.1621.html">Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation : Nature Biotechnology : Nature Publishing Group</a></li>
<li><a href="http://www.stat115.org/lectures/stat115_rnaseq.pdf">http://www.stat115.org/lectures/stat115_rnaseq.pdf</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RNA-Seqの数理―生成モデルによる発現量推定（2）Count Based ModelとRPKM]]></title>
    <link href="http://yagays.github.io/blog/2013/07/16/mathematical-models-for-transcriptome-quantification-2/"/>
    <updated>2013-07-16T00:00:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/16/mathematical-models-for-transcriptome-quantification-2</id>
    <content type="html"><![CDATA[<ul>
<li>まとめ：<a href="http://yagays.github.io/blog/2013/07/14/mathematical-models-for-transcriptome-quantification-0/">RNA-Seqの数理―生成モデルによる発現量推定：アーカイブ - Wolfeyes Bioinformatics beta</a></li>
</ul>


<h3>Count Based Model</h3>

<p>今回はCount Based Modelと呼ばれる最も基本的な生成モデルを作って発現量推定を定式化し，それがRPKMの計算式と同じ意味を持つことを示してみよう．なお，以降の内容はPachter 2011をベースにしている．</p>

<blockquote><p>Models for transcript quantification from RNA-Seq. q-bio.GN, (2011).</p>

<p><a href="http://arxiv.org/abs/1104.3889v2">http://arxiv.org/abs/1104.3889v2</a></p></blockquote>

<h3>Count Based Modelにおける仮定</h3>

<p>Count based Modelは非常にシンプルな生成モデルだ．単純化のために3つの前提条件を置いて，RNA-Seqをモデル化している．</p>

<ul>
<li>NGSのシーケンスはシングルエンド</li>
<li>ショートリードはただ1箇所だけにマッピングされる</li>
<li>すべての転写物はただ1つのアイソフォームを持つ</li>
</ul>


<p>NGSのシーケンスに関しても，トランスクリプトームに関しても，かなり限定して考えていることがわかる．遺伝子の構造が単純な生物において初期のNGS解析をしていると思えばいいだろう．現実的にはこのような状態というのはあり得ないが，転写物からショートリードが生成されるという核の部分は残しつつ単純化をしている．</p>

<h3>Count Based Modelの生成過程</h3>

<p>生成モデルというものは，まず初めに観測データであるショートリードの生成過程を立てる．今回のCount Based Modelでは</p>

<blockquote><p><strong>トランスクリプトーム全体からある転写物が選ばれ，ある開始点からショートリードがシーケンスされた</strong></p></blockquote>

<p>と考える．<a href="http://yagays.github.io/blog/2013/07/15/mathematical-models-for-transcriptome-quantification-1/">前回の記事で概要を示した</a>ように，RNA-Seqの実験プロトコルは幾つかの複雑な段階を踏んでショートリードをシーケンスしていた．その多くの段階は偶然の連続によって，たまたま転写物がフラグメントとしてある部分から断片化され，たまたまシーケンスされてショートリードとして出力されたとみなすことができる．これらを確率的な事象として扱うことによって，確率的な視点からシーケンスデータが生じた背景にあるRNA-Seqの発現量というものを推定することができる．</p>

<br/>


<p>さて，長ったらしい文章の前置きはここまでにして，次からは実際に生成過程を数式に落としこんでいく．まず最初にこれまで言葉で説明してきたものを変数や集合として定義をし，事象の起こりやすさを尤度として表現する．概念と数式の対応関係が少し分かりにくいかもしれないが，もし要領が掴めないようならこの後に書いてある具体例の図も参照しつつ，どの変数が何を表しているかを丁寧に追ってほしい．</p>

<h3>尤度の定式化</h3>

<p>転写物の集合<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=T+" alt="T " />に含まれる転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />は，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctilde%7Bl_t%7D+" alt="\tilde{l_t} " />の有効配列長を持ち，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Csum_%7Bt%5Cin+T%7D+%5Crho_t+%3D+1+" alt="\sum_{t\in T} \rho_t = 1 " />となるような<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho_t+" alt="\rho_t " />という相対的な発現量を持つ．RNA-Seqによって得られたショートリードを<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=f+" alt="f " />，その全体を<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=F+" alt="F " />とし，転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />にマッピングされたショートリードの集合を<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=F_t+" alt="F_t " />とする．</p>

<p>このとき，ショートリード<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=f+" alt="f " />が転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />から生じる確率は，以下の式で表すことができる．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=p%28f%5Cin+t%29%3D+%5Cfrac%7B%5Crho_t+%5Ctilde%7Bl_t%7D%7D%7B%5Csum_%7Br%5Cin+T%7D%5Crho_r+%5Ctilde%7Bl_t%7D%7D+" alt="p(f\in t)= \frac{\rho_t \tilde{l_t}}{\sum_{r\in T}\rho_r \tilde{l_t}} " /></p>

<p>次に，選ばれた転写物のどの位置からショートリードがシーケンスされるかはランダムに選ばれるため，この確率<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=p%28f%5Cin+t%29+" alt="p(f\in t) " />に有効配列長の逆数<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cfrac%7B1%7D%7B%5Ctilde%7Bl_t%7D%7D+" alt="\frac{1}{\tilde{l_t}} " />を掛けあわせた値が，ショートリード<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=f+" alt="f " />が転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />のある開始点から生成される確率となる．</p>

<p>このとき，観測されたショートリード全体<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=F+" alt="F " />の尤度は，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho_t+" alt="\rho_t " />の関数として以下のように表される．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BL%7D%28%5Crho%29%3D+%5Cprod_%7Bt%5Cin+T%7D%5Cprod_%7Bf%5Cin+F_t%7D+%5Cbigg%28+%5Cfrac%7B%5Crho_t+%5Ctilde%7Bl_t%7D%7D%7B%5Csum_%7Br%5Cin+T%7D%5Crho_r+%5Ctilde%7Bl_r%7D%7D%5Ccdot%5Cfrac%7B1%7D%7B%5Ctilde%7Bl_t%7D%7D+%5Cbigg%29+" alt="\mathcal{L}(\rho)= \prod_{t\in T}\prod_{f\in F_t} \bigg( \frac{\rho_t \tilde{l_t}}{\sum_{r\in T}\rho_r \tilde{l_r}}\cdot\frac{1}{\tilde{l_t}} \bigg) " /></p>

<p>そして，転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />にマッピングされたショートリードの本数<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X_t+" alt="X_t " />を使って，以下のように書き換えられる．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BL%7D%28%5Crho%29%3D+%5Cprod_%7Bt%5Cin+T%7D+%5Cbigg%28+%5Cfrac%7B%5Crho_t+%5Ctilde%7Bl_t%7D%7D%7B%5Csum_%7Br%5Cin+T%7D%5Crho_r+%5Ctilde%7Bl_r%7D%7D%5Ccdot%5Cfrac%7B1%7D%7B%5Ctilde%7Bl_t%7D%7D+%5Cbigg%29%5E%7BX_t%7D+" alt="\mathcal{L}(\rho)= \prod_{t\in T} \bigg( \frac{\rho_t \tilde{l_t}}{\sum_{r\in T}\rho_r \tilde{l_r}}\cdot\frac{1}{\tilde{l_t}} \bigg)^{X_t} " /></p>

<p>これがCount Based Modelにおける尤度である．</p>

<h3>具体例を用いて尤度を導出する</h3>

<h4>確率の考え方</h4>

<p>といっても，これだけでは何のことか分からないので，具体例を使って詳しく解説していこう．単純化のために，以下の図のような3つの転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t_1%2C+t_2%2C+t_3+" alt="t_1, t_2, t_3 " />と6本のショートリード<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=f_1%2Cf_2%5Cdots%2Cf_6+" alt="f_1,f_2\dots,f_6 " />が次のようにマッピングされたという状態を想定する．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/generative-models_1.png" alt="" /></p>

<p>3つの転写物にはそれぞれ発現量を持っている．例えば，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t_1+" alt="t_1 " />は20，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t_2+" alt="t_2 " />は5，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t_3+" alt="t_3 " />は15という具合だ．今回は発現量を確率値として考えるため，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cfrac%7B20%7D%7B40%7D%2C%5Cfrac%7B5%7D%7B40%7D%2C%5Cfrac%7B15%7D%7B40%7D+" alt="\frac{20}{40},\frac{5}{40},\frac{15}{40} " />のように相対値として表す．これが<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho_t+" alt="\rho_t " />であり，総和が1になる理由だ．この<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho_t+" alt="\rho_t " />が今回の生成モデルで最終的に求めたい値である．</p>

<p>さて，ショートリード<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=f_1+" alt="f_1 " />が転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t_1+" alt="t_1 " />から生成される確率は，先ほどの定式化で<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=p%28f%5Cin+t%29%3D+%5Cfrac%7B%5Crho_t+%5Ctilde%7Bl_t%7D%7D%7B%5Csum_%7Br%5Cin+T%7D%5Crho_r+%5Ctilde%7Bl_t%7D%7D+" alt="p(f\in t)= \frac{\rho_t \tilde{l_t}}{\sum_{r\in T}\rho_r \tilde{l_t}} " />としていた．これはある転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />の長さと相対的な発現量を掛けあわせたものと，その全体との比率を求めており，ただの発現量の比率だけでなく転写物の長さも関係しているということを表している．ランダムに一つ選んでシーケンスするということを考えれば，多く転写されていてなおかつ長い転写物のほうが選ばれやすいのは明らかだろう．この式は，そういった意味を数式として厳密に表現しているだけなのだ．</p>

<p>次に，転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />が選ばれた後に，今度はその転写物のどの位置の配列が読まれたかということを考える．これは端っこの方の配列が読まれたのか真ん中の方の配列が読まれたのかといった情報だ．このときに出てくるのが有効配列長Effective lengthと呼ばれる値で，ショートリードの長さを<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=m+" alt="m " />としたときの<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctilde%7Bl_t%7D%3Dl_t+-+m+%2B+1+" alt="\tilde{l_t}=l_t - m + 1 " />で表される．これは単純に長さ<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l_t+" alt="l_t " />から長さ<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=m+" alt="m " />の配列を取ってくる時の場合の数である．今回のモデルでは，シーケンスされる場所は場所に依存せず一様なランダムで決まるとしているので，有効配列長で割り算をしている．</p>

<p>そして，これをすべてのショートリードである<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=f_1+" alt="f_1 " />から<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=f_6+" alt="f_6 " />まですべて掛けあわせることで，今回得られたショートリードが生成される確率というものを求めることができる．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BL%7D%28%5Crho%29%3D%5Cfrac%7Bp%28f_1%5Cin+t_1%29%7D%7B%5Ctilde%7Bl_1%7D%7D%5Ctimes%5Cfrac%7Bp%28f_2%5Cin+t_1%29%7D%7B%5Ctilde%7Bl_1%7D%7D%5Ctimes%5Cfrac%7Bp%28f_3%5Cin+t_1%29%7D%7B%5Ctilde%7Bl_1%7D%7D+" alt="\mathcal{L}(\rho)=\frac{p(f_1\in t_1)}{\tilde{l_1}}\times\frac{p(f_2\in t_1)}{\tilde{l_1}}\times\frac{p(f_3\in t_1)}{\tilde{l_1}} " /><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctimes%5Cfrac%7Bp%28f_4%5Cin+t_2%29%7D%7B%5Ctilde%7Bl_2%7D%7D%5Ctimes%5Cfrac%7Bp%28f_5%5Cin+t_2%29%7D%7B%5Ctilde%7Bl_2%7D%7D%5Ctimes%5Cfrac%7Bp%28f_6%5Cin+t_3%29%7D%7B%5Ctilde%7Bl_3%7D%7D+" alt="\times\frac{p(f_4\in t_2)}{\tilde{l_2}}\times\frac{p(f_5\in t_2)}{\tilde{l_2}}\times\frac{p(f_6\in t_3)}{\tilde{l_3}} " /></p>

<p>この確率<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BL%7D%28%5Crho%29+" alt="\mathcal{L}(\rho) " />が尤度と呼ばれる．尤度とは「もっともらしさ」という意味だ．上で仮定したような<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=f_1%2Cf_2%5Cdots%2Cf_6+" alt="f_1,f_2\dots,f_6 " />のショートリードのデータが実際に手元に得られたのだから，それが起こる確率が高かったに違いない，ということを尤度では考えている．</p>

<h4>尤度式の展開</h4>

<p>では次に，この式をもう少し綺麗にしていこう．まずは2行目で転写物ごとに式をまとめ，3行目ですべての転写物を一つの式で表している．そして最後に<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=p%28f%5Cin+t%29+" alt="p(f\in t) " />を置き換えると，先ほどの<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BL%7D%28%5Crho%29%3D+%5Cprod_%7Bt%5Cin+T%7D%5Cprod_%7Bf%5Cin+F_t%7D+%5Cbigg%28+%5Cfrac%7B%5Crho_t+%5Ctilde%7Bl_t%7D%7D%7B%5Csum_%7Br%5Cin+T%7D%5Crho_r+%5Ctilde%7Bl_r%7D%7D%5Ccdot%5Cfrac%7B1%7D%7B%5Ctilde%7Bl_t%7D%7D+%5Cbigg%29+" alt="\mathcal{L}(\rho)= \prod_{t\in T}\prod_{f\in F_t} \bigg( \frac{\rho_t \tilde{l_t}}{\sum_{r\in T}\rho_r \tilde{l_r}}\cdot\frac{1}{\tilde{l_t}} \bigg) " />まで導出することができる．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/generative-models_2.png" alt="" /></p>

<p>そして最後のまとめとして，転写物ごとにマッピングされたショートリードの生成確率というのは同じであることを利用して，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X_t+" alt="X_t " />でまとめる．
つまり，ショートリードの配列は生成確率に依存せず<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=p%28f_1%5Cin+t_1%29+%3D++p%28f_2%5Cin+t_1%29+%3D++p%28f_3%5Cin+t_1%29" alt="p(f_1\in t_1) =  p(f_2\in t_1) =  p(f_3\in t_1)" />なので，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=p%28f_1%5Cin+t_1%29+%5Ctimes+p%28f_2%5Cin+t_1%29+%5Ctimes+p%28f_3%5Cin+t_1%29+%3D+%28p%28f%5Cin+t_1%29%29%5E%7BX_1%7D+" alt="p(f_1\in t_1) \times p(f_2\in t_1) \times p(f_3\in t_1) = (p(f\in t_1))^{X_1} " />と変形している．こうすることにより，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BL%7D%28%5Crho%29%3D+%5Cprod_%7Bt%5Cin+T%7D+%5Cbigg%28+%5Cfrac%7B%5Crho_t+%5Ctilde%7Bl_t%7D%7D%7B%5Csum_%7Br%5Cin+T%7D%5Crho_r+%5Ctilde%7Bl_r%7D%7D%5Ccdot%5Cfrac%7B1%7D%7B%5Ctilde%7Bl_t%7D%7D+%5Cbigg%29%5E%7BX_t%7D+" alt="\mathcal{L}(\rho)= \prod_{t\in T} \bigg( \frac{\rho_t \tilde{l_t}}{\sum_{r\in T}\rho_r \tilde{l_r}}\cdot\frac{1}{\tilde{l_t}} \bigg)^{X_t} " />となる．</p>

<h3>尤度を最大にするパラメータを解析的に求める</h3>

<p>では，数式として表された尤度を最大化する値を求めよう．まずは上の式を少し整理するところから始める．<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Calpha_t+" alt="\alpha_t " />という新たな変数を用意して<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho_t+" alt="\rho_t " />を<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Calpha_t+" alt="\alpha_t " />に置き換える．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Calpha_t+%3D+p%28f%5Cin+t%29%3D+%5Cfrac%7B%5Crho_t+%5Ctilde%7Bl_t%7D%7D%7B%5Csum_%7Br%5Cin+T%7D%5Crho_r+%5Ctilde%7Bl_t%7D%7D+" alt="\alpha_t = p(f\in t)= \frac{\rho_t \tilde{l_t}}{\sum_{r\in T}\rho_r \tilde{l_t}} " /></p>

<p>この<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Calpha_t+" alt="\alpha_t " />を用いて，先ほどの尤度式を書き換えると</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BL%7D%28%5Calpha_t%29%3D%5Cprod_%7Bt%5Cin+T%7D%5Cbigg%28+%5Cfrac%7B%5Calpha_t%7D%7B%5Ctilde%7Bl_t%7D%7D%5Cbigg%29%5E%7BX_t%7D+%5Cpropto+%5Cprod_%7Bt%5Cin+T%7D+%7B%5Calpha_t%7D%5E%7BX_t%7D+" alt="\mathcal{L}(\alpha_t)=\prod_{t\in T}\bigg( \frac{\alpha_t}{\tilde{l_t}}\bigg)^{X_t} \propto \prod_{t\in T} {\alpha_t}^{X_t} " /></p>

<p>となる．ここで，尤度<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BL%7D+" alt="\mathcal{L} " />の変数が<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Calpha_t+" alt="\alpha_t " />になっていることに注意．最尤推定の目的としては尤度<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cmathcal%7BL%7D+" alt="\mathcal{L} " />を最大化する<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Calpha_t+" alt="\alpha_t " />を求めたいだけなので，関係ない<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Ctilde%7Bl_t%7D+" alt="\tilde{l_t} " />は消している．</p>

<p>そして，この尤度を最大にする<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Calpha_t+" alt="\alpha_t " />をラグランジュの未定乗数法を用いて求めると，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Chat%7B%5Calpha_t%7D+%3D+%5Cfrac%7BX_t%7D%7BN%7D+" alt="\hat{\alpha_t} = \frac{X_t}{N} " />となる．以下の図は，ラグランジュの未定乗数法の導出部分の詳細．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/generative-models_3.png" alt="" /></p>

<p>このときの<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho_t+" alt="\rho_t " />は<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho_t+%3D+%5Cfrac%7B%5Calpha_t+%2F+%5Ctilde%7Bl_t%7D%7D%7B%5Csum_%7Br%5Cin+T%7D+%5Calpha_t+%2F+%5Ctilde%7Bl_t%7D%7D+" alt="\rho_t = \frac{\alpha_t / \tilde{l_t}}{\sum_{r\in T} \alpha_t / \tilde{l_t}} " />で表されるので，先ほど求めた<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Chat%7B%5Calpha_t%7D+" alt="\hat{\alpha_t} " />を代入して，</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Chat%7B%5Crho_t%7D+%3D+%5Cfrac%7BX_t%7D%7BN%7D+%5Ccdot+%5Cfrac%7B1%7D%7B%5Ctilde%7Bl_t%7D%7D+%5Ccdot+%5Cbigg%28+%5Cfrac%7B1%7D%7B%5Csum_%7Br%5Cin+T%7D%5Cfrac%7BX_r%7D%7BN+l_r%7D%7D+%5Cbigg%29+" alt="\hat{\rho_t} = \frac{X_t}{N} \cdot \frac{1}{\tilde{l_t}} \cdot \bigg( \frac{1}{\sum_{r\in T}\frac{X_r}{N l_r}} \bigg) " /></p>

<p>と表すことができる．これが，Count Based Modelによって求められた発現量<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Crho_t+" alt="\rho_t " />の推定値である．</p>

<h3>Count Based Modelの解析解とRPKMとの関係</h3>

<p>さて，ようやくRPKMとの関連の話に入ることができる．上で求めた<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Chat%7B%5Crho_t%7D+" alt="\hat{\rho_t} " />を，次のように式変形する．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Chat%7B%5Crho_t%7D+%3D+%5Cfrac%7BX_t%7D%7BN%7D+%5Ccdot+%5Cfrac%7B1%7D%7B%5Ctilde%7Bl_t%7D%7D+%5Ccdot+%5Cbigg%28+%5Cfrac%7B1%7D%7B%5Csum_%7Br%5Cin+T%7D%5Cfrac%7BX_r%7D%7BN+l_r%7D%7D+%5Cbigg%29+" alt="\hat{\rho_t} = \frac{X_t}{N} \cdot \frac{1}{\tilde{l_t}} \cdot \bigg( \frac{1}{\sum_{r\in T}\frac{X_r}{N l_r}} \bigg) " /></p>

<p>この式をよく見ると，後半の<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Cbigg%28+%5Cfrac%7B1%7D%7B%5Csum_%7Br%5Cin+T%7D%5Cfrac%7BX_r%7D%7BN+l_r%7D%7D+%5Cbigg%29+" alt="\bigg( \frac{1}{\sum_{r\in T}\frac{X_r}{N l_r}} \bigg) " />は全ての転写物に関して計算しているだけなので，ただの定数である．ということで，特定の転写物の発現量<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Chat%7B%5Crho_t%7D+" alt="\hat{\rho_t} " />に関係してくる変数だけを抜き出すと，</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=%5Chat%7B%5Crho_t%7D+%5Cpropto+%5Cfrac%7BX_t%7D%7B%5Ctilde%7Bl_t%7D+N%7D+" alt="\hat{\rho_t} \propto \frac{X_t}{\tilde{l_t} N} " /></p>

<p>ここに<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=10%5E9+" alt="10^9 " />を掛ければ，<strong>生成モデルにおける発現量の推定式はRPKMの式<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=RPKM+%5C++for+%5C++transcript+%5C+t+%3D+10%5E9+%5Ctimes%5Cfrac%7BX_t%7D%7Bl_t+N%7D" alt="RPKM \  for \  transcript \ t = 10^9 \times\frac{X_t}{l_t N}" />と全く同じ式になることがわかる！！！</strong></p>

<p>ということで，Count Based Modelにおける最尤推定によって推定される発現量と，マッピングされたショートリードの数だけで計算されたRPKMの発現量は，基本的には同じ計算式によって求めることができることがわかった．</p>

<h3>まとめ</h3>

<p>後半はだいぶ駆け足になってしまったが，Count Based Modelの導出とRPKMとの関係を解説してみた．生成モデルというややこしい数式を立てておいて結局RPKMと同じかよと思うかもしれないが，生成モデルはここから様々な仮定をモデルに組み込むことによって，より複雑かつ現実に則した一般的なモデルへと改良していくことができる．今回のCount Based Modelはその枠組みとして，非常に基本的な考え方である．しかしながら，実際にはこの方法だけを使ってソフトウェアが作られたり論文として出ているわけでもなく，あまり詳しい解説が無い部分だと思われる．今回はLior Pachter氏のレビューをもとに具体例をはさみながらモデルを読み解いていったが，次回以降はもう少しCufflinksで使われているような技術も導入しつつ，より複雑なモデルへと進んでいきたい．</p>

<h3>参考</h3>

<ul>
<li><a href="http://arxiv.org/abs/1104.3889v2">[1104.3889v2] Models for transcript quantification from RNA-Seq</a></li>
<li><a href="http://fgcz-intranet.uzh.ch/publish/BiostatLecture/RNA-seq-quantification.pdf">http://fgcz-intranet.uzh.ch/publish/BiostatLecture/RNA-seq-quantification.pdf</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RNA-Seqの数理―生成モデルによる発現量推定（1）RNA-Seqの発現量推定とRPKM]]></title>
    <link href="http://yagays.github.io/blog/2013/07/15/mathematical-models-for-transcriptome-quantification-1/"/>
    <updated>2013-07-15T00:06:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/15/mathematical-models-for-transcriptome-quantification-1</id>
    <content type="html"><![CDATA[<ul>
<li>まとめ：<a href="http://yagays.github.io/blog/2013/07/14/mathematical-models-for-transcriptome-quantification-0/">RNA-Seqの数理―生成モデルによる発現量推定：アーカイブ - Wolfeyes Bioinformatics beta</a></li>
</ul>


<p>生成モデルの話を始める前に，まずはRNA-Seqの発現量としてよく知られているRPKMという指標からスタートし，生成モデルの話へと繋げていこう．</p>

<h3>RNA-Seqの発現量推定の基本</h3>

<p>RNA-Seqで得られるデータは，ある長さの配列（ショートリード）とクオリティスコアのセットして表現される．それをリファレンスとなるゲノム配列の中から探しだして，読まれた配列が何の転写物由来かを見つける作業をマッピングという．このマッピングをNGSから出力された数千万本/数億本のショートリードに対して行い，ある遺伝子の部位にどのくらい貼り付いたかをカウントすることで特定の転写物がどれくらい発現していたかを推定するという方法が，RNA-Seqの発現量推定では基本となる．</p>

<p><a href="http://www.nature.com/nrg/journal/v10/n1/fig_tab/nrg2484_F1.html" target="_blank"><img src="http://dl.dropboxusercontent.com/u/142306/b/nrg2484-f1.jpg" alt="CCC License Number: 3187871036736 "></a></p>

<p>この図はRNA-Seqの実験の流れを模式的に表している．まず対象となるトランスクリプトームであるmRNAを取り出し，断片化やアダプターの付与を経てシーケンスライブラリを作成する．次にNGSによって断片が大量にシーケンスされ，いわゆるATCGからなる文字列で構成されたショートリードが得られる．そしてゲノム配列にマッピングすることによって，RNAの発現量が推定される．この図では，ゲノム配列の各塩基ごとにどれくらいの本数のショートリードが貼り付いたかをカウントすることによって，RNA expression levelを図示している．Nucleotide positionによって特定の領域の発現量が欠損していたり遺伝子の末端で発現量が少なくなっているのには，マッピングの際に生じる幾つかの理由がある．まず，図中のJunction readsで示されている点線の箇所は，イントロンのスプライシングが起きた領域であり，mRNAの配列をゲノム配列にマッピングするために起こる現象である．そのため，イントロンの領域だけ発現量が無いように見える．また，Poly-A tailが配列の一部として混入することでショートリード自体がゲノム配列にマッピングできない場合もあり，末端の発現量が落ちる原因の一つになっている．</p>

<p>では，このようにして求められた値を転写物ごとの発現量として一つの値で表現するには，どうすれば良いのか．ここで，RPKMという考え方が登場する．</p>

<h3>RPKMの考え方</h3>

<p>RNA-Seqの発現量の値として最初に考えられ今でも広く使われているRPKMという指標は，配列の本数を数えるという方法で転写物ごとの発現量を求めている．RPKMはreads per kilobase of exon per million mapped sequence readsの略称で，マッピングされたショートリードの数をエキソンの長さとシーケンサで読まれた配列の総数で正規化した値である．RPKMの計算方法を式で表すと以下のようになる．</p>

<p><img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=RPKM+%5C++for+%5C++transcript+%5C+t+%3D+10%5E9+%5Ctimes%5Cfrac%7BX_t%7D%7Bl_t+N%7D" alt="RPKM \  for \  transcript \ t = 10^9 \times\frac{X_t}{l_t N}" /></p>

<p>ここで，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=X_t+" alt="X_t " />は転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />にマッピングされたショートリードの本数，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=l_t+" alt="l_t " />は転写物<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=t+" alt="t " />の長さ(bp)，<img src="http://chart.apis.google.com/chart?cht=tx&amp;chl=N+" alt="N " />はマッピングされたショートリードの総数を表している．</p>

<p>さて，このRPKMという発現量の考え方の裏には以下のような仮定がある．</p>

<ul>
<li>配列数が長い転写物からはショートリードが多く読まれる</li>
<li>全体で読まれるショートリードの数が多いと，マッピングされるショートリードも多くなる</li>
</ul>


<p>NGSによるRNA-Seqでは，特定の量のサンプルの中に含まれるトランスクリプトームをランダムにシーケンスするため，出てくるデータというのはあくまでも相対的な量となってしまう．そのため，このような仮定を置くことで転写物の発現や実験サンプルなどの違いを補正している．RPKMはある遺伝子の領域内に含まれるショートリードの本数を数え，転写物の長さと全体のデータ数で割って10<sup>9</sup> を掛けることによって簡単に求められるため，計算のしやすさと直感的な分かりやすさがある．</p>

<h3>RPKMと生成モデルとの関係</h3>

<p>このように，RPKMはマッピングされた配列の本数を数えるという単純な方法で発現量を推定している．一方で，これから考えていくことになる生成モデルによる発現量推定は，データが観測される事象を確率的に推定することでデータが与えられたときのトランスクリプトームの発現量というものを求める．これらは一見して全く違うもののように見えるのだが，<strong>実際には最も単純な生成モデルはRPKMと基本的な考え方が同じになる</strong>．つまり，RPKMも単純な生成モデルによる推定方法も，発現量はマッピングされたショートリードの本数と，転写物の長さおよびマッピングされたショートリードの総数の逆数によって決まるということだ．</p>

<p>それを確かめるために，次回はCount Based Modelと呼ばれる生成モデルを作って発現量推定を定式化し，それがRPKMの計算式と同じ意味を持つということを示してみよう．</p>

<ul>
<li>次：<a href="http://yagays.github.io/blog/2013/07/16/mathematical-models-for-transcriptome-quantification-2/">RNA-Seqの数理―生成モデルによる発現量推定（2）Count Based ModelとRPKM - Wolfeyes Bioinformatics beta</a></li>
</ul>


<h3>参考</h3>

<ul>
<li><a href="http://www.nature.com/nmeth/journal/v5/n7/full/nmeth.1226.html">Mapping and quantifying mammalian transcriptomes by RNA-Seq - Nature Methods</a></li>
<li><a href="http://www.nature.com/nrg/journal/v10/n1/full/nrg2484.html">RNA-Seq: a revolutionary tool for transcriptomics : Article : Nature Reviews Genetics</a></li>
<li><a href="http://arxiv.org/abs/1104.3889v2">[1104.3889v2] Models for transcript quantification from RNA-Seq</a></li>
<li><a href="http://fgcz-intranet.uzh.ch/publish/BiostatLecture/RNA-seq-quantification.pdf">http://fgcz-intranet.uzh.ch/publish/BiostatLecture/RNA-seq-quantification.pdf</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[RNA-Seqの数理―生成モデルによる発現量推定：アーカイブ]]></title>
    <link href="http://yagays.github.io/blog/2013/07/14/mathematical-models-for-transcriptome-quantification-0/"/>
    <updated>2013-07-14T10:43:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/14/mathematical-models-for-transcriptome-quantification-0</id>
    <content type="html"><![CDATA[<p>この「RNA-Seqの数理」シリーズでは，次世代シーケンサを用いたRNA-Seqにおける発現量推定の数理モデルを理解することを目的とする．</p>

<p>副題にある「生成モデル」とは，観測データの生成過程を確率的にモデル化し，データが与えられたときの事後確率を用いて分類したいクラスや予測したい値を推定する方法のことを指す．今回のRNA-Seqにおける生成モデルでは，次世代シーケンサで読み取られた配列が，どのようにして細胞内のトランスクリプトームから実験によって読み取られて観測されたかという一連の流れを，生成モデルとして表現する．そして確率的なもっともらしさやパラメータの推定をおこない，トランスクリプトームの発現量を求める．</p>

<h3>このシリーズについて</h3>

<p>次世代シーケンサによるRNA-Seqの発現量推定といっても，実験対象は大腸菌レベルから人に至るまでゲノムサイズや遺伝子数は多種多様であり，実験機器も各メーカーごとに独自に改良が加えられてきた．しかしながら，RNA-Seqはトランスクリプトームの配列を超並列に大量に解読するという点で，基本的な原理は生物種やプラットフォームに依存しない．まずはこの共通部分に関して単純なモデルを作成し，そこから個別の生物の特性や実験方法に合わせた複雑なモデルを構築していく．</p>

<p>今回のシリーズは前提条件として，発現量推定の対象とする種をゲノム既知なモデル生物に限定する．つまり，ヒトやマウス，シロイヌナズナ，線虫など，すでにゲノム配列が解読されていて，なおかつ遺伝子の配列や機能がよく研究されている種を対象にするということだ．この仮定をおかないと，そもそもデータ処理の時点でショートリードのマッピングができなかったり，モデルが立てられないということになりかねない．とはいうものの，仮定を立てたからといってマッピングの曖昧さは解消されないし，アイソフォームの存在や選択的スプライシングなど複雑な転写メカニズムはいくらでも考えられるので，それらは追々モデルに組み込んでいく．</p>

<h3>注意</h3>

<p>このシリーズの記事で書かれていることはすべて個人的な勉強記録であって，数理的な解釈や導出の厳密性を保証するものではない．勘違いや間違いなどが多分に含まれている可能性があるので，参考にされる際には十分に注意していただきたい．もし間違いや誤字脱字等見つけられた方は，コメント欄などで指摘していただければ幸い．</p>

<h3>このシリーズの目標</h3>

<p>このシリーズの目標（そして個人的な勉強の目標）としては，</p>

<ul>
<li>CufflinksやRSEMなどのスタンダードとなっている発現量推定の数理的背景を理解する</li>
<li>発現差異解析(DE)などの複数サンプルにまたがる発現量比較の手法の理解につなげる</li>
</ul>


<p>ことを考えている．基本的には論文に記載されている内容をベースに進めていくので，論文のmethodの理解が最終的な目標となるだろう．</p>

<h3>記事まとめ</h3>

<ul>
<li><a href="http://yagays.github.io/blog/2013/07/15/mathematical-models-for-transcriptome-quantification-1/">RNA-Seqの数理―生成モデルによる発現量推定（1）RNA-Seqの発現量推定とRPKM - Wolfeyes Bioinformatics beta</a></li>
<li><a href="http://yagays.github.io/blog/2013/07/16/mathematical-models-for-transcriptome-quantification-2/">RNA-Seqの数理―生成モデルによる発現量推定（2）Count Based ModelとRPKM - Wolfeyes Bioinformatics beta</a></li>
<li><a href="http://yagays.github.io/blog/2013/07/22/mathematical-models-for-transcriptome-quantification-3/">RNA-Seqの数理―生成モデルによる発現量推定（3）ペアエンドリードとフラグメント長の分布関数 - Wolfeyes Bioinformatics beta</a></li>
</ul>


<h3>参考</h3>

<ul>
<li>(Cufflinksの論文)<a href="http://www.nature.com/nbt/journal/v28/n5/full/nbt.1621.html">Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation : Nature Biotechnology : Nature Publishing Group</a></li>
<li>(RSEMの論文)<a href="http://www.biomedcentral.com/1471-2105/12/323">BMC Bioinformatics | Full text | RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ディレクトリの書き込み権限が無いとファイルの消去ができない]]></title>
    <link href="http://yagays.github.io/blog/2013/07/13/directory-permission/"/>
    <updated>2013-07-13T15:40:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/13/directory-permission</id>
    <content type="html"><![CDATA[<p>久しぶりに初歩的なところでハマったのでメモ．多人数が使用するサーバ上で，何故かrmすることのできないファイルがあった．パーミッションも所有者もグループも特に変なところは見当たらず，ファイルが壊れているわけでもGUIで他のプログラムが使用中というわけでもない．なのに，rmしようとすると以下のようなエラーが出てしまう（例示しているコマンドラインは手元で再現した状況）．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rm hehehe
</span><span class='line'>remove hehehe? y
</span><span class='line'>rm: hehehe: Permission denied</span></code></pre></td></tr></table></div></figure>


<p>sudo権限を持っていないのでなんともしがたいなーと思いつつ，適当にディレクトリ名を&#8221;fuga_broken&#8221;に変更して放置していたのだけれども，たまたま機会があって人に相談したら「ディレクトリの書き込み権限が無いんじゃない？」と言われて，そこでようやく気がついた．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ls -l
</span><span class='line'>合計 0
</span><span class='line'>dr-xr-xr-x 3 yag_ays staff 102  7 13 15:27 fuga/</span></code></pre></td></tr></table></div></figure>


<p>というわけで，ディレクトリの書き込み権限がなかったせいで，そのディレクトリ内のファイルの消去ができなかっただけだったというオチ．なぜ書き込み権限が無くなっていたのかはいまだに不明だ．対象となるディレクトリをchmodで書き込み権限を付加したら，あっさりファイルを削除することができた．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ chmod +w fuga
</span><span class='line'>$ rm fuga/hehehe
</span><span class='line'>remove fuga/hehehe? y
</span><span class='line'>$ </span></code></pre></td></tr></table></div></figure>


<p>なんともまあ呆気なく解決してしまった．普段からディレクトリのパーミッションはまったく変えないので，問題解決の際にディレクトリにまで考えが及ばなく，久々に自分の経験の浅さを実感した．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tophat/Cufflinksなどの開発者であるCole TrapnellによるRNA-Seqの遺伝子発現解析に関する講義動画]]></title>
    <link href="http://yagays.github.io/blog/2013/07/12/stat115-cole-trapnell/"/>
    <updated>2013-07-12T03:49:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/12/stat115-cole-trapnell</id>
    <content type="html"><![CDATA[<p>非常に良い講義資料およびその講義ビデオを見つけたので紹介する．これはハーバードの大学院およびハーバード公衆衛生大学院のComputational Biologyの講義で，マイクロアレイ/次世代シーケンサの発現解析に始まり，ChIP-Seqやモチーフ検索，GWAやSNP解析に至るまで，Computational Biologyにおける様々な研究対象に関する講義が行われている．</p>

<p><a href="http://www.stat115.org/index.html">STAT115 Introduction to Computational Biology</a></p>

<blockquote><p>This course is an introduction to state-of-the-arts concepts, methodologies and practices in computational biology. After taking this course, you should be able to:</p>

<ul>
<li><p>Use appropriate commands or write your own scripts to manipulate your own genomic data</p></li>
<li><p>Exploit appropriate pipeline or software to analyze your own high-throughput gene expression microarray and/or RNA-Seq data and high-throughput sequencing transcriptional regulation data</p></li>
<li><p>Apply statistical or mathematical models to your own population/human genetics data</p></li>
<li><p>Criticize and/or extend the computational analysis or statistical models in the literature</p></li>
<li><p>Use R, Python, and/or Shell scripts and basic concepts in genomics and genetics to perform your own bioinformatics and computational biology research</p></li>
</ul>


<p><a href="http://www.stat115.org/syllabus.html">http://www.stat115.org/syllabus.html</a></p></blockquote>

<p>このなかで，Cole TrapnellがRNA-Seqの遺伝子発現解析に関してレクチャーしている．Cole Trapnellといえば，<a href="http://tophat.cbcb.umd.edu/">TopHat</a>や<a href="http://cufflinks.cbcb.umd.edu/">Cufflinks</a>の開発者の中心人物のひとりだ．これらのツールに関する論文の第一著者でもある．その彼が，RNA-Seqの定量化や発現量推定などの一連の流れを，自身が開発に参加した&#8221;Tuxedo Tools&#8221;（Bowtie, Tophat, Cufflinks, CummeRbundの総称）を例に紹介しているのがこの動画だ．主にマッピング後の発現量推定に関して，基本的なFPKMの求め方であったり，Cufflinksのisoformの取り扱いであったりを，少し数式も交えながら詳しく解説している．</p>

<p>講義資料：<a href="http://www.stat115.org/lectures/stat115_rnaseq.pdf">http://www.stat115.org/lectures/stat115_rnaseq.pdf</a></p>

<iframe src="http://player.vimeo.com/video/60609764" width="500" height="281" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>


<p> <p><a href="http://vimeo.com/60609764">lecture9-I</a> from <a href="http://vimeo.com/stat115">stat115</a> on <a href="https://vimeo.com">Vimeo</a>.</p></p>

<iframe src="http://player.vimeo.com/video/60609783" width="500" height="281" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>


<p> <p><a href="http://vimeo.com/60609783">lecture9-II</a> from <a href="http://vimeo.com/stat115">stat115</a> on <a href="https://vimeo.com">Vimeo</a>.</p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[TimeTreeで生物種間の分岐年代を調べる]]></title>
    <link href="http://yagays.github.io/blog/2013/07/10/timetree/"/>
    <updated>2013-07-10T14:03:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/10/timetree</id>
    <content type="html"><![CDATA[<p>2種類の生物がどれくらい系統的に近いか遠いかといった情報は，生物の分類をWikipediaで確認したり系統樹を眺めたりと色々と確認する方法があるが，ではどれくらい前に2種類の生物が分岐したかという情報は意外と確認するのが難しい．そういった分岐年代を簡単に確認，比較することができるのがTimeTreeというサイトだ．</p>

<p><a href="http://www.timetree.org/">TimeTree :: The Timescale of Life</a></p>

<h3>生物種を入力する</h3>

<p>TimeTreeウェブサイトの左上にある検索ボックスに，分岐年代を辿りたい生物種を入力する．通常は<em>Canis lupus</em>と<em>Felis catus</em>のような学名を入力するのだけれども，一般的な名称であるdogやcatも自動で変換してくれるようだ．もし学名がハッキリ分かっているのなら，そちらを入力したほうが確実だろう．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/timetree1.png" alt="" /></p>

<h3>結果</h3>

<p>今回のような検索クエリを入力した結果，イヌ(<em>Canis lupus familiaris</em>)とネコ(<em>Felis catus</em>)の分岐年代は55.1 Million Years Agoと推定された．ただしこの値というのは，様々な分岐年代の研究に関してイヌとネコが当てはまるものを複数集めてきて，最終的に平均を取った値となっている．個別の研究の推定結果というのは，図の左側の時系列の箇所に黒の点で表示されているように，実際には42Myaから67Myaまで幅があるようだ．このように複数のソースから分岐年代を確認できるのもTimeTreeの大きな特徴となっている．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/timetree2.png" alt="" /></p>

<p>上図の黒の点で示した個別の研究というのは，下のリストからそれぞれ確認することができる．Taxon Aがイヌ，Taxon Bがネコの検索クエリにそれぞれ対応しており，研究によってはイヌ亜目Caniformiaやネコ亜目Feliformiaのような目レベルで確認されているものや，クマ科Ursidaeやアザラシ科Phocidaeといった少し系統的に離れた分類群との比較も列挙されている（クマやアザラシはどちらもネコ目）．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/timetree4.png" alt="" /></p>

<p>このように，ウェブページに表示されているリストから詳細なページに飛ぶことができるほか，「Molecular Time Estimates」にある「Download as CSV」をクリックすると，根拠となる論文や出版年のリストをコンマ区切りテキストとしてダウンロードすることができる．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/timetree3.png" alt="" /></p>

<h3>参考</h3>

<ul>
<li><a href="http://www.timetree.org/">TimeTree :: The Timescale of Life</a></li>
<li>(TimeTreeプロジェクトに関して)<a href="http://www.evolutionsbiologie.uni-konstanz.de/genombaum/Kuraku-ElasmoReview-Japanese.pdf">http://www.evolutionsbiologie.uni-konstanz.de/genombaum/Kuraku-ElasmoReview-Japanese.pdf</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ゲノムアセンブリにおいて最適なk-merを推定するKmerGenieを試してみた]]></title>
    <link href="http://yagays.github.io/blog/2013/07/07/genome-assembly-kmergenie/"/>
    <updated>2013-07-07T15:17:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/07/genome-assembly-kmergenie</id>
    <content type="html"><![CDATA[<p>KmerGenieという，シーケンスデータのみを用いてアセンブラに依存しない形でアセンブルに指定する最適なk-merの値を求めることができるソフトウェアが最近出てきたので，ちょっと使ってみた．</p>

<p><a href="http://kmergenie.bx.psu.edu/">KmerGenie</a></p>

<p>そういえば以前<a href="http://yagays.github.io/blog/2012/06/06/velvetk/">VelvetK</a>という，これも同じようにk-merパラメータをデータセットから推定するツールについて書いたが，これは名前の通りVelvetに特化したソフトウェアだった．2007年くらいに公開され使われ始めたVelvetは，NGSの普及と相まってかなり長い間ゲノムアセンブラとして広く使われてきた印象がある．その後ABySSやMIRA，ALLPATHS-LG，Rayなどの様々なゲノムアセンブラが出てきたが，それらに対してVelvetKのようなk-mer最適化のようなツールは無かったようで，そのあたりアセンブラに非依存というのがKmerGenieの売りのようだ．</p>

<h3>KmerGenieの仕組み</h3>

<p>KmerGenieがどういう仕組みで最適なk-merを推定しているかは，以下のスライドやarXiv.orgで公開されている論文に詳しく書かれている．</p>

<ul>
<li><a href="http://ged.msu.edu/angus/tutorials-2013/files/rayan-2013-june-18-msu.pdf">http://ged.msu.edu/angus/tutorials-2013/files/rayan-2013-june-18-msu.pdf</a></li>
<li><a href="http://arxiv.org/abs/1304.5665">[1304.5665] Informed and Automated k-Mer Size Selection for Genome Assembly</a></li>
<li><a href="http://perso.eleves.bretagne.ens-cachan.fr/~chikhi/2013-july-20-hitseq.pdf">http://perso.eleves.bretagne.ens-cachan.fr/~chikhi/2013-july-20-hitseq.pdf</a> (追記:2013/07/23)</li>
</ul>


<p>これによると，単純に言ってしまえば最適なk-merの出現頻度というものはきれいな正規分布に従うと仮定した上で，k-merの値を色々変えて出現頻度のヒストグラムを作成し，生成モデルを立ててフィッティングをして最適なk-merの値を推定しているようだ．実際には，正規分布を仮定したゲノム配列の分布とパレート分布を仮定したエラーの配列の分布が混ざった混合分布を考えて，その混合の重みなども考慮したパラメータ最適化をしているらしい．</p>

<h3>KmerGenieのインストール</h3>

<p>まずはKmerGenieをインストールする．ダウンロードしたファイルを展開すると既にディレクトリにkmergenieという実行ファイルがあるが，makeをしないと利用することができないので注意．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget http://kmergenie.bx.psu.edu/kmergenie-1.5397.tar.gz
</span><span class='line'>$ cd kmergenie-1.5397
</span><span class='line'>$ make</span></code></pre></td></tr></table></div></figure>


<h3>KmerGenieの実行</h3>

<p>それでは実際にfastqファイルに対してKmerGenieを実行してみる．</p>

<h4>1. ゲノムアセンブリのチュートリアルで使用されたE. coliのゲノムシーケンス</h4>

<p>まずは2013年の6月に行われた<a href="http://bioinformatics.msu.edu/ngs-summer-course-2013">MSU NGS Summer Course 2013</a>のチュートリアルで使用されたサンプルデータを使ってみる．これはE. coliのゲノムシーケンスで，元は<a href="http://www.ncbi.nlm.nih.gov/pubmed/21926975">Chitsaz et al.</a>が出したデータの一部のようだ．中身は約4.7Mの70bpのシングルリード．</p>

<p><a href="http://ged.msu.edu/angus/tutorials-2013/assembling-ecoli-with-velvet.html">Assembling E. coli sequences with Velvet — ANGUS 2.0 documentation</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -O https://s3.amazonaws.com/public.ged.msu.edu/ecoli_ref-5m-trim.fastq.gz
</span><span class='line'>$ gunzip ecoli_ref-5m-trim.fastq.gz</span></code></pre></td></tr></table></div></figure>


<p>それではecoli_ref-5m-trim.fastqに対してKmerGenieを実行する．実行後に作られる各k-merでのカウントデータや分布をプロットしたpdfはカレントディレクトリにそのまま出力されるので，もし必要ならディレクトリを別途作ってそこで実行したほうが良いだろう．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ kmergenie ecoli_ref-5m-trim.fastq
</span><span class='line'>running histogram estimation
</span><span class='line'>Linear estimation: ~130 M distinct 41-mers are in the reads
</span><span class='line'>K-mer sampling: 1/100
</span><span class='line'>| processing                                                                                         |
</span><span class='line'>[going to estimate histograms for values of k: 61 51 41 31 21 
</span><span class='line'>-----------------------------------------------------------------------------------------------------------------------------Total time Wallclock  77.7066 s
</span><span class='line'>fitting model to histograms to estimate best k
</span><span class='line'>fitting histogram for k = 21
</span><span class='line'>fitting histogram for k = 31
</span><span class='line'>fitting histogram for k = 41
</span><span class='line'>fitting histogram for k = 51
</span><span class='line'>fitting histogram for k = 61
</span><span class='line'>estimation of the best k so far: 51
</span><span class='line'>refining estimation around [45; 57], with a step of 2
</span><span class='line'>running histogram estimation
</span><span class='line'>Linear estimation: ~139 M distinct 39-mers are in the reads
</span><span class='line'>K-mer sampling: 1/100
</span><span class='line'>| processing                                                                                         |
</span><span class='line'>[going to estimate histograms for values of k: 57 55 53 51 49 47 45 
</span><span class='line'>-----------------------------------------------------------------------------------------------------------------------------Total time Wallclock  56.4315 s
</span><span class='line'>fitting model to histograms to estimate best k
</span><span class='line'>fitting histogram for k = 21
</span><span class='line'>fitting histogram for k = 31
</span><span class='line'>fitting histogram for k = 41
</span><span class='line'>fitting histogram for k = 45
</span><span class='line'>fitting histogram for k = 47
</span><span class='line'>fitting histogram for k = 49
</span><span class='line'>fitting histogram for k = 51
</span><span class='line'>fitting histogram for k = 53
</span><span class='line'>fitting histogram for k = 55
</span><span class='line'>fitting histogram for k = 57
</span><span class='line'>fitting histogram for k = 61
</span><span class='line'>table of predicted num. of genomic k-mers: histograms.dat
</span><span class='line'>best k: 55</span></code></pre></td></tr></table></div></figure>


<p>今回の場合，KmerGenieによる最適なk-merの値は55となった．出力結果で示されるk-mer頻度のプロットを並べて見ると，確かにkが小さいときは少しいびつになっており，k=55あたりで一番正規分布っぽくなっている…??ことがわかる．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/kmergenie1.png" alt="" /></p>

<p>ただ，このサンプルーデータを解析しているチュートリアルではk-merを31〜35にしてvelvetでアセンブルしていることから，今回の55という推定値は少し大きめのような気がする．</p>

<h3>2. Assemblathon2で使用されたセキセイインコのゲノムシーケンス</h3>

<p>次はもう少し大きいデータで試してみよう．Assemblathon2というアセンブリツールの性能を競うコンペで使用されたセキセイインコのゲノムシーケンスの中からDuke Illumina GAIIx runsというデータを使ってみる．中身は76bpのペアエンドで合計で126M readsある．</p>

<p><a href="http://bioshare.bioinformatics.ucdavis.edu/Data/hcbxz0i7kg/Parrot/illumina_duke_runs/">Index of /Data/hcbxz0i7kg/Parrot/illumina_duke_runs</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ lftp -e "mirror" http://bioshare.bioinformatics.ucdavis.edu/Data/hcbxz0i7kg/Parrot/illumina_duke_runs/ 
</span><span class='line'>$ cat *.fastq &gt; budgie.fastq</span></code></pre></td></tr></table></div></figure>


<p>Assemblathonのサイトによるとセキセイインコのゲノムは二倍体らしいので，今回はKmerGenieの「&#8211;diploid」のパラメータを付けて実行する．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ kmergenie --diploid budgie.fastq
</span><span class='line'>running histogram estimation
</span><span class='line'>Linear estimation: ~3721 M distinct 46-mers are in the reads
</span><span class='line'>K-mer sampling: 1/1000
</span><span class='line'>| processing                                                                                         |
</span><span class='line'>[going to estimate histograms for values of k: 71 61 51 41 31 21
</span><span class='line'>---------------------------------------------------------------------------------------------------------------------------Total time Wallclock  3035.49 s
</span><span class='line'>fitting model to histograms to estimate best k
</span><span class='line'>fitting histogram for k = 21
</span><span class='line'>fitting histogram for k = 31
</span><span class='line'>fitting histogram for k = 41
</span><span class='line'>fitting histogram for k = 51
</span><span class='line'>fitting histogram for k = 61
</span><span class='line'>fitting histogram for k = 71
</span><span class='line'>estimation of the best k so far: 21
</span><span class='line'>refining estimation around [15; 27], with a step of 2
</span><span class='line'>running histogram estimation
</span><span class='line'>Linear estimation: ~6335 M distinct 24-mers are in the reads
</span><span class='line'>K-mer sampling: 1/1000
</span><span class='line'>| processing                                                                                         |
</span><span class='line'>[going to estimate histograms for values of k: 27 25 23 21 19 17 15
</span><span class='line'>---------------------------------------------------------------------------------------------------------------------------Total time Wallclock  2305.61 s
</span><span class='line'>fitting model to histograms to estimate best k
</span><span class='line'>fitting histogram for k = 15
</span><span class='line'>fitting histogram for k = 17
</span><span class='line'>fitting histogram for k = 19
</span><span class='line'>fitting histogram for k = 21
</span><span class='line'>fitting histogram for k = 23
</span><span class='line'>fitting histogram for k = 25
</span><span class='line'>fitting histogram for k = 27
</span><span class='line'>fitting histogram for k = 31
</span><span class='line'>fitting histogram for k = 41
</span><span class='line'>fitting histogram for k = 51
</span><span class='line'>fitting histogram for k = 61
</span><span class='line'>fitting histogram for k = 71
</span><span class='line'>table of predicted num. of genomic k-mers: histograms.dat
</span><span class='line'>best k: 21</span></code></pre></td></tr></table></div></figure>


<p>データ量が多いと計算時間もかなり大きくなるようで，出力にも少し書かれている通り，今回は1時間半くらいかかった．</p>

<p>さて，今回の場合はKmerGenieによる最適なk-merの値は21となった．出力結果で示されるk-mer頻度のプロットを並べて見てみると，kが大きい値の時には確かに正規分布として近似できないくらいなだらかな曲線になっているものの，K=21の最適値付近でもその様子はあまり変わっていないような感じがする．そもそも可視化の都合もあって横幅が揃えられていなかったりと色々と問題はあるが，とりあえずは今回のデータから推定された最適値は21だった．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/kmergenie2.png" alt="" /></p>

<h3>KmerGenieで使用できるパラメータ</h3>

<p>以上のように，KmerGenieは幾つかのk-merの値で実行して最適と思われる値を自動で出力するが，他にも手動でパラメータを指定することでk-merの範囲や刻みを変更することができる．</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ kmergenie
</span><span class='line'>KmerGenie
</span><span class='line'>
</span><span class='line'>Usage:
</span><span class='line'>    kmergenie &lt;read_file&gt; [options]
</span><span class='line'>
</span><span class='line'>Options:
</span><span class='line'>    --diploid    use the diploid model
</span><span class='line'>    --one-pass   skip the second pass
</span><span class='line'>    -k &lt;value&gt;   largest k-mer size to consider (default: 121)
</span><span class='line'>    -l &lt;value&gt;   smallest k-mer size to consider (default: 15)
</span><span class='line'>    -s &lt;value&gt;   interval between consecurive kmer sizes (default: 10)
</span><span class='line'>    -e &lt;value&gt;   k-mer sampling (default: auto-detected power of 10)"
</span><span class='line'>    -o &lt;prefix&gt;  prefix of the output files (default: histograms)"</span></code></pre></td></tr></table></div></figure>


<h3>まとめ</h3>

<p>このように，KmerGenieはシーケンスデータのみを用いてアセンブラに依存しない形で，アセンブルに指定する最適なk-merの値を求めることができる．推定された値が最良のアセンブルに繋がるかは実際に確認してみないと判断できないが，大まかな目安であったりk-mer決定プロセスの理由付けなどに力を発揮するだろう．今回は結果に対してそれほど詳細な評価を行わなかったが，<a href="http://arxiv.org/abs/1304.5665">arXiv.orgで公開されている論文</a>の方では<a href="http://gage.cbcb.umd.edu/index.html">GAGE</a>のデータセットに対してアセンブル結果を含めた性能比較をしているので，そちらも参考にしていただきたい．</p>

<h3>参考</h3>

<ul>
<li><a href="http://kmergenie.bx.psu.edu/">KmerGenie</a></li>
<li><a href="http://ged.msu.edu/angus/tutorials-2013/files/rayan-2013-june-18-msu.pdf">http://ged.msu.edu/angus/tutorials-2013/files/rayan-2013-june-18-msu.pdf</a></li>
<li><a href="http://arxiv.org/abs/1304.5665">[1304.5665] Informed and Automated k-Mer Size Selection for Genome Assembly</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[だれかicanhazpdfできる？？？]]></title>
    <link href="http://yagays.github.io/blog/2013/07/06/icanhazpdf/"/>
    <updated>2013-07-06T17:02:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/06/icanhazpdf</id>
    <content type="html"><![CDATA[<p>#icanhazpdfというTwitterのハッシュタグがある．これが何を意味しているかは，実際に使われている例を見てもらったほうが早いだろう．</p>

<p><a href="https://twitter.com/search/%23icanhazpdf">Twitter / Search - #icanhazpdf</a></p>

<p>つまり，読みたい論文があるのに所属している大学/研究所/企業がライセンスを契約していないからpdfが取れない！という時に，</p>

<ul>
<li><p>&#8220;<strong>この論文のPDF取れる人いますか？ &#8220;hoge et al. piyopiyo&#8221; http://xxxxxx… #icanhazpdf</strong>&#8221;</p></li>
<li><p>&#8220;<strong>だれか#icanhazpdf できる？ http://xxxxx…</strong>&#8221;</p></li>
</ul>


<p>といった感じでTwitterに投稿するというわけだ．これを見た知り合いか誰かがpdfをメールで送ってさえくれれば，気になる論文がチェックできる！</p>

<p>とまあ，これはヤバいだろというのは誰が見ても明らかで，Twitterで検索した結果を見ても，実際にこのハッシュタグに疑問を投げかけている人も多数存在する．ここでは法やモラルの問題に踏み込みたくないので判断は各自に任せるとして，近年の論文誌の購読価格の上昇であったりオープンアクセスの流れなどが影響しているのは確かだろう．まあ，Twitterの登場によって今まで内輪で行われてきた行為が表面化してきているだけというのが一番大きいのだろうけれども．</p>

<h3>icanhaz&#8230;の元ネタ</h3>

<p>icanhazという意味不明な英文法の元ネタは以下の猫の画像．tumblrによく流れてくるようないわゆる画像に文字を付ける遊びの一種で，本来は&#8221;I Can Has Cheezburger?&#8221;だったようだ．このタイトルを冠したネタサイトがあるほか，Wikipediaにも個別記事が作られている．</p>

<p><a href="http://www.sodahead.com/fun/lolcats-do-you-have-a-favorite-lol-cat-or-other-lol-picture/blog-326585/?link=ibaf&imgurl=http://images.sodahead.com/slideshows/000000783/icanhascheeseburger-14422465099_xlarge.jpeg&q="><img src="http://images.sodahead.com/slideshows/000000783/icanhascheeseburger-14422465099_xlarge.jpeg"><br> pics on Sodahead</a></p>

<ul>
<li><a href="https://en.wikipedia.org/wiki/I_Can_Has_Cheezburger%3F">I Can Has Cheezburger? - Wikipedia, the free encyclopedia</a></li>
<li><a href="http://news.cnet.com/8301-13772_3-10023722-52.html">The history of I Can Has Cheezburger | Geek Gestalt - CNET News</a></li>
</ul>


<h3>その他icanhazpdfの参考サイト</h3>

<ul>
<li><a href="http://eurekajournals.org/eureka/index.php?title=Icanhazpdf">Icanhazpdf - Eureka Journal Watch</a></li>
<li><a href="http://www.samuelpean.com/icanhazpdf-reddit-scholar-pirateuniversity-org-aaaaarg-org-how-scientist-community-bypasses-journals-paywalls/">#ICanHazPDF, Reddit Scholar, PirateUniversity.org &amp; AAAAARG.org: How scientific community bypasses journals paywalls | Samuel PÉAN</a></li>
<li><a href="http://neuroconscience.com/2013/01/16/join-papester-collective-1-0-how-to-reply-to-icanhazpdf-in-3-seconds/">How to reply to #icanhazpdf in 3 seconds | Neuroconscience</a></li>
<li><a href="http://current.ndl.go.jp/node/20709">ハーバード大学、価格高騰する学術雑誌の購読中止を視野に入れた対策案を教員等に提示 | カレントアウェアネス・ポータル</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Zenithのホッチキスを買った]]></title>
    <link href="http://yagays.github.io/blog/2013/07/03/zenith-stapler/"/>
    <updated>2013-07-03T19:52:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/03/zenith-stapler</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B007RIHVOG" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>Zenithのホッチキスを買った．前々から一目惚れしていたものの値段のせいあって買うのをためらっていたのだが，いつも使っているホッチキスで上手く綴ることができなくなってきたので買い替えとばかりに思い切って購入．最近ご無沙汰だった文房具熱が再発しそうで少し怖い．</p>

<ul>
<li><a href="http://freedesign.jp/stationery/ktzsp001.php">BALMA ZENITH STAPLER 591 - バルマ ゼニス ステープラー</a></li>
</ul>


<p>第一印象としては，とにかく使い心地が良い．見た目からはデカくてゴツくて荒っぽい印象なのだけれども，やはり通常のホッチキスと比べてそもそも構造が違うのが，使用感に大きく影響してくる．とにかく力を入れなくても簡単に紙を綴ることができるので，だからといって楽とは少し違うのだけれども，普通に使う分には全く問題がない．正確には計っていないが10枚くらいなら余裕で綴ることができるし，頑張れば20枚程度はいけそうな感じがする．あと個人的に気に入っているのが綴るときの音で，鉄の擦れる音やバネの軋む音が心地良い．</p>

<p>まだあまり使っていないので，これからが楽しみだ．Zenithのホッチキスで綴た論文を，頑張って読もう…．</p>

<p><img src="http://dl.dropboxusercontent.com/u/142306/b/zenith.jpg" alt="" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA["Zero Dark Thirty"のBlu-rayを買った]]></title>
    <link href="http://yagays.github.io/blog/2013/07/02/blu-ray-zero-dark-thirty/"/>
    <updated>2013-07-02T00:36:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/02/blu-ray-zero-dark-thirty</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B00B1E6FF8" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p>映画&#8221;Zero Dark Thirty&#8221;の北米版Blu-rayを買った．映画として完成度が高いというのは言うまでもないものの，個人的な思い入れが強い作品でもある．この映画で描かれるCIAの女性捜査官には，何かを追い求める執念であったり不屈の精神に強く惹かれるところがある．それをもう一度確かめたくて，9月の日本版の発売を待たず海外版を購入してしまったというわけだ．当然ながら日本語字幕は無い．</p>

<p>今回購入したBlu-ray/DVD Comboには，Blu-rayとDVDが1枚ずつ入っている．Blu-rayは日本と北米ともに同じリージョンなのでPS3などのプレイヤーで普通に観ることができる．DVDはリージョンが違うため日本のプレイヤーでは通常は見ることができないため，PCなどの環境を別途用意する必要がある．(<a href="http://www.amazon.com/gp/help/customer/display.html?ie=UTF8&amp;nodeId=3193231">参考</a>)</p>

<p>さて，今回初めて北米版のDVDを買って色々知ったのだが，映画の音声に通常の英語版に加えて，Descriptive Serviceというモードが付いている．これはどうやら視覚障害を持つ方向けのサービスのようだ．</p>

<p><a href="http://en.wikipedia.org/wiki/Descriptive_Video_Service">Descriptive Video Service - Wikipedia, the free encyclopedia</a></p>

<p>実際に聞いてみるとわかりやすいのだが，Descriptive Serviceはいわゆるオーディオブックのようなものだ．映画オリジナルのセリフの間に，情景の説明や誰が何をしたといったことがナレーションとして入っている．画面に表示される文字や暗転したといったことも含めて，セリフでカバーできない画面の内容が英語音声で説明されるので，画面を観ることができない人でも映画を楽しめるようになっている．本来はそのような用途で使用されるものなのだが，このナレーションは聞き取りやすい声で口調もそれほど速くないため，最近はこれを流しながら英語を聞く耳を鍛えている．Descriptive Serviceは当然ながら字幕に出すことができないので，英語学習に向いているとは言えないものの，好きな映画を見ながらセリフ以外のところで英語の学習ができるので，個人的に気に入っている．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[「世界基準で夢をかなえる私の勉強法」読了]]></title>
    <link href="http://yagays.github.io/blog/2013/07/01/review-kitagawa-be-yourself-and-carry-on/"/>
    <updated>2013-07-01T22:56:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/07/01/review-kitagawa-be-yourself-and-carry-on</id>
    <content type="html"><![CDATA[<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=yagays-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=434402334X" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="right"></iframe>


<p><a href="http://www.amazon.co.jp/gp/product/4106104695/ref=as_li_ss_tl?ie=UTF8&camp=247&creative=7399&creativeASIN=4106104695&linkCode=as2&tag=yagays-22">ハーバード白熱日本史教室 (新潮新書)</a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=yagays-22&l=as2&o=9&a=4106104695" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />で知られる北川智子氏の人生をなぞるようにして，彼女の勉強に対する姿勢や方法を書き起こした本．高校時代にカナダに留学した時から始まり，そのままカナダの大学へと進学，専攻を変えつつアメリカの大学院を渡り歩き，そしてハーバードでのカレッジ・フェローとイギリスのケンブリッジ大への挑戦という各段階において，どのように勉強をこなし成果を上げてきたかという経験が語られる．国を変え，専攻を変え，研究対象を変える．彼女はそのようにして興味を追いかけハードルを乗り越えながら勉強してきたという．その中で培われてきた独自の勉強法が，彼女の体験とともに紹介される．</p>

<p>本書では様々な勉強法が紹介されるが，全体に共通するのは恐ろしいほどの勉強量である．文章の端々に表れる異常なまでの勉強時間，勉強量，集中力，アウトプット，そのどれもが，字面だけでは到底推し量ることのできないほどの苦痛と困難に満ちていたであろうことを，どうしても感じとってしまう．例えば，1週間の日程表は午前7時から始まり27時まで書かれている．文字通り100杯以上のコーヒーを飲み，博論を書き続けて気付けば5日経っていたこともあったという．そのような過去の苦労に対して，どちらかというとリアルに表現することなくソフトなタッチで書かれているために，つい大げさだと受け流してしまうかもしれない．しかしながら，その経験談の裏にある彼女の人生が辿ってきた険しい道というものは，明らかに存在する．勉強法という小手先の技術というべきものが，巨大な努力量と綿密な下準備というものによって支えられているということを，ある意味気づかせないようにしているとも取れる．</p>

<p>みんな，誰もが効率というものに取り憑かれて，少ない労力で多くの成果を得たいと思っている．活躍する人の真似をすれば少しは自分もそこに追いつけるかもしれないと思っている．と同時に，成果に繋げるには生活すべてを勉強に注ぎ込む必要があるのだとも薄々気づいている．自分に何ができるかという答えなき問題に対する不安や諦観には，とやかく人に言われるよりも，試行錯誤を繰り返して自分で見つけ出すしかない．しかしながら，他人の人生と教訓を学ぶことは，決して悪い方法ではないと僕は思っている．他人が経験した他人の人生を自分の中で上手く反芻することができれば，それは何かしらの手がかりにはなる．そういった意味で，本書で語られる北川智子氏の人生は，多くの日本人よりはるかにかけ離れたものであり，現在の日本の価値観におけるロールモデルであり，実現不可能な人生ではないことを示してくれる実例となっている．</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA["RNA-Seq unleashed"によるTrinityのワークフローの解説]]></title>
    <link href="http://yagays.github.io/blog/2013/06/26/rna-seq-unleashed-trinity/"/>
    <updated>2013-06-26T13:14:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/06/26/rna-seq-unleashed-trinity</id>
    <content type="html"><![CDATA[<p><a href="http://evomics.org/learning/genomics/trinity/">Trinity | Evolution and Genomics</a>経由で知ったのだが，Trinityのワークフローに関してより分かりやすい図が2011年のNature BiotechnologyのNews and Viewsに掲載されていたので，ここで少し紹介する．この図はTrinityのアセンブリアルゴリズムの一連のワークフローを表しており，アセンブリ結果の解釈も含めて解説されているのが大きな特徴だ．Trinityが対象にしているトランスクリプトームのアセンブリは，アイソフォームや選択的スプライシングなどの影響を受けて良く似た配列が多数出てくるため，一意に決まらない場合が多い．そういったケースに対応するために，Trinityではアセンブルのグラフを作成して考えられる候補を幾つか出力するのだけれども，実はこの結果の解釈が一番難しい．多数の類似配列が出力で得られた時にそれがどういう可能性から出てきたものなのかを考える上で，この図の一番下の解説はとても参考になる．実際はこんなに上手くいかないだろうとは思うものの，個別のアイソフォームとして配列をクラスタリングしたり，そもそもTrinityが何を考慮してアセンブルしているかを確認する際には役立つだろう．</p>

<blockquote><p>Iyer, M. K. &amp; Chinnaiyan, A. M. RNA-Seq unleashed. <em>Nat. Biotechnol.</em> <strong>29</strong>, 599–600 (2011).</p>

<p><a href="http://www.nature.com/nbt/journal/v29/n7/full/nbt.1915.html">http://www.nature.com/nbt/journal/v29/n7/full/nbt.1915.html</a></p></blockquote>

<p><a href="http://www.nature.com/nbt/journal/v29/n7/full/nbt.1915.html" target="_blank"><img src="http://dl.dropboxusercontent.com/u/142306/b/rna-seq_unleashed.gif" alt="CCC License Number: 3172280756988"></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Biopythonで塩基配列をアミノ酸配列にする]]></title>
    <link href="http://yagays.github.io/blog/2013/06/25/biopython-translation/"/>
    <updated>2013-06-25T09:59:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/06/25/biopython-translation</id>
    <content type="html"><![CDATA[<ul>
<li><a href="http://insectcell.exblog.jp/20703555/">awkとsedで塩基配列をアミノ酸配列にする : したっぱ昆虫細胞研究者のメモ</a></li>
<li><a href="https://twitter.com/chalkless/status/349052297982132225">Twitter / chalkless: @n0rr $ perl -MBio::Seq -le &#8230;</a></li>
<li><a href="https://twitter.com/dritoshi/status/349056205160841216">Twitter / dritoshi: @chalkless @n0rr &#8230;</a></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="kn">import</span> <span class="n">Seq</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">mRNA</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="s">&quot;TATGAAAGT&quot;</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">mRNA</span><span class="o">.</span><span class="n">translate</span><span class="p">()</span>
</span><span class='line'><span class="n">Seq</span><span class="p">(</span><span class="s">&#39;YES&#39;</span><span class="p">,</span> <span class="n">ExtendedIUPACProtein</span><span class="p">())</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Why Biopython?</h3>

<p><a href="http://xkcd.com/353/">xkcd: Python</a></p>

<p><img src="http://imgs.xkcd.com/comics/python.png" alt="http://xkcd.com/353/" /></p>

<h3>Ref.</h3>

<ul>
<li><a href="http://biopython.org/DIST/docs/tutorial/Tutorial.html">Biopython Tutorial and Cookbook</a></li>
<li><a href="http://yagays.github.io/blog/2013/04/20/install-biopython/">Mac OS Xで手っ取り早くBiopythonをインストールして使えるようにする - Wolfeyes Bioinformatics beta</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[2013 Web Server issue]]></title>
    <link href="http://yagays.github.io/blog/2013/06/24/nar-web-server-issue-2013/"/>
    <updated>2013-06-24T14:20:00+09:00</updated>
    <id>http://yagays.github.io/blog/2013/06/24/nar-web-server-issue-2013</id>
    <content type="html"><![CDATA[<p><a href="http://nar.oxfordjournals.org/content/41/W1.toc" target="_blank"><img src="http://dl.dropboxusercontent.com/u/142306/b/W1.cover.gif" align="right" alt="http://nar.oxfordjournals.org/content/41/W1.cover-expansion"></a></p>

<p>今年のWeb Server issue 2013が既に閲覧できるようになっていた．</p>

<p><a href="http://nar.oxfordjournals.org/">Nucleic Acid Research誌</a>は少し特殊な特別号を毎年出していて，1月にはDatabase issueが，7月にはWeb Server issueが発刊されるのが定番になっている．これらの特集号は，他の論文誌では論文になりにくいようなデータベース構築やウェブサービス系を論文として発表する場として，バイオインフォ系にとっては重要な投稿先の一つといえる．特に，ウェブサービスのアップデートなども同様の投稿ができるようになっており，新規性としては少し弱いウェブサービスの保守管理や機能追加に関しても評価されるのが大きな特徴だ（ただし2年間のインターバルが必要）．</p>

<p><strong>今年のWeb Server issue：<a href="http://nar.oxfordjournals.org/content/41/W1.toc">Table of Contents — 1 July 2013, 41 (W1)</a></strong></p>

<p>今年は合計で95本のウェブサービスに関する論文が採択されたようだ．Editorialによると</p>

<blockquote><p>For the 2013 issue, 293 summaries were submitted and 129, or 44%, were approved for manuscript submission. Of those approved, 95, or 73%, were ultimately accepted for publication.</p>

<p><a href="http://nar.oxfordjournals.org/content/41/W1/W1.full">http://nar.oxfordjournals.org/content/41/W1/W1.full</a></p></blockquote>

<p>ということで，293本の投稿のうち最終的に95本が採択され，全体で見れば約32%の採択率となっている．</p>

<br/>


<p>来年のWeb Server Issue 2014の締め切りは今年いっぱいまで(31 Dec. 2013)となっている．それまでに完全に動くウェブサービスと1ページのproposalを書いて投稿し，そこで通れば1ヶ月でmanuscriptを書いて7月に掲載という流れのようだ．</p>
]]></content>
  </entry>
  
</feed>
